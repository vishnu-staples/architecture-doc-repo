{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"Overview","text":""},{"location":"index.html#overview","title":"Overview","text":""},{"location":"index.html#platform-archtecture","title":"Platform Archtecture","text":"<ul> <li><code>System Context</code></li> <li><code>Infrastructure</code></li> </ul>"},{"location":"index.html#governance","title":"Governance","text":"<p>This repository follows defined review and documentation standards to maintain a single source of truth and prevent drift.</p>"},{"location":"index.html#enterprise-standards","title":"Enterprise standards","text":"<ul> <li><code>Security baseline</code></li> <li><code>Operability baseline</code></li> <li><code>Logging and observability standards</code></li> <li><code>Data privacy and retention standards</code></li> <li><code>Integrations</code></li> </ul>"},{"location":"index.html#architecture-decision-records","title":"Architecture decision records","text":"<ul> <li><code>Decision records (ADR index)</code></li> </ul>"},{"location":"index.html#reference","title":"Reference","text":"<ul> <li><code>Glossary</code></li> </ul>"},{"location":"ecommerce/index.html","title":"System Context","text":""},{"location":"ecommerce/index.html#system-context","title":"System Context","text":""},{"location":"ecommerce/dot-ca/index.html","title":"Overview","text":""},{"location":"ecommerce/dot-ca/index.html#overview","title":"Overview","text":""},{"location":"ecommerce/dot-ca/context.html","title":"Context","text":""},{"location":"ecommerce/dot-ca/operablity.html","title":"Operablity","text":""},{"location":"ecommerce/dot-ca/security.html","title":"Security","text":""},{"location":"ecommerce/eway/index.html","title":"Index","text":""},{"location":"ecommerce/print/index.html","title":"Index","text":""},{"location":"enterprise-services/eai/index.html","title":"overview","text":""},{"location":"enterprise-services/eai/index.html#overview","title":"overview","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html","title":"Deployment Architecture","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#deployment-architecture","title":"Deployment Architecture","text":"<p>FTS components are deployed as containerized microservices on Azure Kubernetes Service (AKS) using Azure DevOps Pipelines for CI/CD.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#kubernetes-architecture","title":"Kubernetes Architecture","text":"<pre><code>graph TB\n    subgraph AKS Cluster\n        subgraph sftp-namespace\n            FEH[FileEventHandler Pod]\n            FJH[FileJobHandler Pod]\n            TMSR[FileJobHandler-TMSRoute Pod]\n            TMSS[FileJobHandler-TMSStatus Pod]\n            TMSC[FileJobHandler-TMSCarrierPOD Pod]\n            PP[FileJobHandler-PriceProposal Pod]\n        end\n\n        subgraph Persistent Volumes\n            PV_INT[sftp-internal-fs PVC]\n            PV_EXT[sftp-external-fs PVC]\n        end\n\n        subgraph Secrets\n            SEC[appsettings-secret]\n        end\n    end\n\n    subgraph Azure Storage\n        AFS_INT[Internal File Share]\n        AFS_EXT[External File Share]\n        AFS_JOB[Job Config File Share]\n    end\n\n    PV_INT --&gt; AFS_INT\n    PV_EXT --&gt; AFS_EXT\n\n    FEH --&gt; SEC\n    FJH --&gt; SEC\n    FJH --&gt; PV_INT\n    FJH --&gt; PV_EXT\n    TMSR --&gt; SEC\n    TMSR --&gt; PV_INT\n    TMSS --&gt; SEC\n    TMSC --&gt; SEC\n    PP --&gt; SEC\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#namespace-configuration","title":"Namespace Configuration","text":"Environment Namespace Description Development <code>sftp-dev</code> Development testing Staging <code>sftp-stg</code> Pre-production validation Production <code>sftp-prod</code> Production workloads"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#pod-configuration","title":"Pod Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#deployment-template-file-job-handler-templateyaml","title":"Deployment Template (file-job-handler-template.yaml)","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ${K8S_APP_NAME}\n  namespace: ${K8S_PROJECT}-${K8S_ENV}\n  labels:\n    app: ${K8S_APP_NAME}\n    project: ${K8S_PROJECT}\n    env: ${K8S_ENV}\n    version: ${K8S_VERSION}\nspec:\n  replicas: ${K8S_APP_REPLICAS}\n  selector:\n    matchLabels:\n      app: ${K8S_APP_NAME}\n  template:\n    metadata:\n      labels:\n        app: ${K8S_APP_NAME}\n    spec:\n      containers:\n        - name: ${K8S_APP_NAME}\n          image: ${K8S_IMAGE_URI}:${K8S_IMAGE_TAG}\n          volumeMounts:\n            - name: appsettings\n              mountPath: /app/appsettings.Production.json\n              subPath: appsettings.Production.json\n            - name: sftpintroot\n              mountPath: /mnt/sftpintroot\n            - name: sftpextroot\n              mountPath: /mnt/sftpextroot\n      volumes:\n        - name: appsettings\n          secret:\n            secretName: ${K8S_APP_SECRET}\n        - name: sftpintroot\n          persistentVolumeClaim:\n            claimName: ${K8S_APP_INT_VOLUME_CLAIM}\n        - name: sftpextroot\n          persistentVolumeClaim:\n            claimName: ${K8S_APP_EXT_VOLUME_CLAIM}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#environment-variables","title":"Environment Variables","text":"Variable Description Example <code>K8S_PROJECT</code> Project identifier <code>sftp</code> <code>K8S_ENV</code> Environment <code>dev</code>, <code>stg</code>, <code>prod</code> <code>K8S_VERSION</code> Application version <code>20240115.abc1234</code> <code>K8S_APP_NAME</code> Application name <code>file-job-handler</code> <code>K8S_APP_REPLICAS</code> Pod replicas <code>1</code> <code>K8S_IMAGE_URI</code> Container registry <code>enterprisenonpacr.azurecr.io/enterprise/file-job-handler</code> <code>K8S_IMAGE_TAG</code> Image tag <code>develop-abc1234</code>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#volume-mounts","title":"Volume Mounts","text":"Mount Path Purpose PVC Name <code>/mnt/sftpintroot</code> Internal SFTP files <code>sftp-internal-fs-{env}</code> <code>/mnt/sftpextroot</code> External SFTP files <code>sftp-external-fs-{env}</code> <code>/mnt/jobconfig</code> Job configuration files (part of internal mount)"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#secrets-management","title":"Secrets Management","text":"<p>Application settings are stored as Kubernetes secrets:</p> <pre><code># Create secret from file\nkubectl create secret -n sftp-dev generic \\\n  sftp-dev-file-job-handler-app-settings-secret \\\n  --from-file=./appsettings.Production.json\n</code></pre> <p>Secret names by environment: - Dev: <code>sftp-dev-file-job-handler-app-settings-secret</code> - Stg: <code>sftp-stg-file-job-handler-app-settings-secret</code> - Prod: <code>sftp-prod-file-job-handler-app-settings-secret</code></p>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#cicd-pipeline","title":"CI/CD Pipeline","text":"<pre><code>flowchart LR\n    subgraph Build Stage\n        A[Source Code] --&gt; B[Restore Packages]\n        B --&gt; C[Run Tests]\n        C --&gt; D[Build Docker Image]\n        D --&gt; E[Push to ACR]\n    end\n\n    subgraph Dev Deployment\n        E --&gt; F[Extract Templates]\n        F --&gt; G[Configure appsettings]\n        G --&gt; H[Create K8s Secret]\n        H --&gt; I[Apply Deployment]\n    end\n\n    subgraph Stg Deployment\n        I --&gt; J[Configure appsettings]\n        J --&gt; K[Create K8s Secret]\n        K --&gt; L[Apply Deployment]\n    end\n\n    subgraph Prod Deployment\n        L --&gt; M[Tag Image for Prod ACR]\n        M --&gt; N[Push to Prod ACR]\n        N --&gt; O[Configure appsettings]\n        O --&gt; P[Create K8s Secret]\n        P --&gt; Q[Apply Deployment]\n    end\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#pipeline-stages","title":"Pipeline Stages","text":"Stage Trigger Description Test All branches Run unit tests Build <code>develop</code> branch Build and push Docker image DeployToDevEnv After Build Deploy to development DeployToStgEnv After Dev Deploy to staging DeployToProdEnv After Stg Deploy to production"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#build-process","title":"Build Process","text":"<ol> <li> <p>Version Generation:    <code>bash    AppVersion=\"$(date +'%Y%m%d').$ShortVersion\"</code></p> </li> <li> <p>Docker Build:    <code>bash    docker build \\      --build-arg ARG_APM_VENDOR=datadog \\      --build-arg ARG_BUILD_VERSION=${branch}-${version} \\      -t ${acrRepo}:${branch}-${version} \\      -f FileJobHandler/Dockerfile .</code></p> </li> <li> <p>Image Tagging:</p> </li> <li>Dev/Stg: <code>enterprisenonpacr.azurecr.io/enterprise/file-job-handler:develop-abc1234</code></li> <li>Prod: <code>enterpriseprodacr.azurecr.io/enterprise/file-job-handler:develop-abc1234</code></li> </ol>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#deployment-process","title":"Deployment Process","text":"<ol> <li>Extract template files from build artifacts</li> <li>Substitute environment variables using <code>envsubst</code></li> <li>Delete existing secrets</li> <li>Create new secrets from configured appsettings</li> <li>Apply Kubernetes deployment</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#container-registry","title":"Container Registry","text":"Environment Registry URL Non-Production enterprisenonpacr <code>enterprisenonpacr.azurecr.io</code> Production enterpriseprodacr <code>enterpriseprodacr.azurecr.io</code>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#agent-pools","title":"Agent Pools","text":"Pool Environment Use <code>ubuntu-latest</code> Cloud Build, test, image operations <code>enterprise-nonp-aks-agents</code> Non-Prod Dev/Stg deployments <code>enterprise-prod-aks-agents</code> Prod Production deployments"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#health-monitoring","title":"Health Monitoring","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#datadog-integration","title":"Datadog Integration","text":"<ul> <li>APM tracing enabled via <code>ARG_APM_VENDOR=datadog</code></li> <li>Traces all service calls</li> <li>Custom metrics for job processing</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#application-logs","title":"Application Logs","text":"<ul> <li>NLog configured for structured logging</li> <li>Logs shipped to Datadog</li> <li>Log levels: Debug, Info, Warning, Error</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#scaling-configuration","title":"Scaling Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#horizontal-pod-autoscaler-hpa","title":"Horizontal Pod Autoscaler (HPA)","text":"<pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: file-job-handler-hpa\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: file-job-handler\n  minReplicas: 1\n  maxReplicas: 5\n  metrics:\n    - type: Resource\n      resource:\n        name: cpu\n        target:\n          type: Utilization\n          averageUtilization: 70\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#resource-limits","title":"Resource Limits","text":"<pre><code>resources:\n  requests:\n    memory: \"256Mi\"\n    cpu: \"250m\"\n  limits:\n    memory: \"1Gi\"\n    cpu: \"1000m\"\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/deployment-architecture.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Configuration Management</li> <li>Monitoring &amp; Logging</li> <li>Security &amp; Secrets</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html","title":"Event-Driven Architecture","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#event-driven-architecture","title":"Event-Driven Architecture","text":"<p>The FTS platform uses an event-driven architecture with Azure Event Hub as the central message broker and CloudEvents as the standard message format.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#cloudevents-standard","title":"CloudEvents Standard","text":"<p>FTS uses the CloudEvents specification (v1.0) for all event messages. This ensures interoperability and consistent message handling across the platform.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#event-structure","title":"Event Structure","text":"<pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"FTP.File.ExternalService\",\n  \"subject\": \"File Upload\",\n  \"id\": \"unique-event-id\",\n  \"time\": \"2024-01-15T10:30:00+0000\",\n  \"dataschema\": \"1.0\",\n  \"data\": {\n    \"correlationId\": \"correlation-123\",\n    \"instanceId\": \"instance-456\",\n    \"clientIpAddress\": \"10.0.0.1\",\n    \"accountId\": \"ACCOUNT001\",\n    \"fileName\": \"data/incoming/file.csv\",\n    \"targetFileName\": \"processed/file.csv\",\n    \"fileSize\": 1024,\n    \"sourceFileName\": \"original.csv\",\n    \"parameters\": [\"param1\", \"param2\"]\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#event-fields","title":"Event Fields","text":"Field Type Required Description <code>specversion</code> string Yes CloudEvents spec version (always \"1.0\") <code>type</code> string Yes Event type (e.g., \"Succeeded\", \"Error\") <code>source</code> string Yes Event source identifier <code>subject</code> string Yes Event subject/category <code>id</code> string Yes Unique event identifier <code>time</code> string Yes ISO 8601 timestamp <code>dataschema</code> string No Data schema version <code>data</code> object Yes Event payload"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#data-payload-fields","title":"Data Payload Fields","text":"Field Type Description <code>correlationId</code> string Correlation ID for tracing <code>instanceId</code> string Processing instance identifier <code>clientIpAddress</code> string Client IP address <code>accountId</code> string Account identifier for routing <code>fileName</code> string Source file path <code>targetFileName</code> string Destination file path <code>fileSize</code> long File size in bytes <code>sourceFileName</code> string Original source filename <code>parameters</code> string[] Additional parameters"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#event-processing-sequence","title":"Event Processing Sequence","text":"<pre><code>sequenceDiagram\n    participant ES as External System\n    participant EH as Event Hub\n    participant FEH as FileEventHandler\n    participant CT as Config Table\n    participant ST as Status Table\n    participant Q as Azure Queue\n    participant FJH as FileJobHandler\n\n    ES-&gt;&gt;EH: Publish CloudEvent\n    EH-&gt;&gt;FEH: Event received (partition)\n    FEH-&gt;&gt;FEH: Validate message format\n\n    alt Invalid Message\n        FEH-&gt;&gt;ST: Insert Invalid status\n        FEH--&gt;&gt;EH: Mark processed\n    else Valid Message\n        FEH-&gt;&gt;CT: Query routing config\n        CT--&gt;&gt;FEH: Return queue assignment\n\n        alt No Route Found\n            FEH-&gt;&gt;ST: Insert NoAssigned status\n        else Route Found\n            FEH-&gt;&gt;Q: Send to assigned queue\n            FEH-&gt;&gt;ST: Insert Assigned status\n            Q-&gt;&gt;FJH: Dequeue message\n            FJH-&gt;&gt;FJH: Process job\n            FJH-&gt;&gt;ST: Update status (Succeeded/Failed)\n        end\n    end\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#event-hub-configuration","title":"Event Hub Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#consumer-group","title":"Consumer Group","text":"<p>FileEventHandler uses a dedicated consumer group for reliable message processing.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#partition-processing","title":"Partition Processing","text":"<ul> <li>Events are distributed across partitions based on partition key</li> <li>Each partition is processed by a single consumer instance</li> <li>Offset tracking ensures exactly-once processing</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#connection-configuration-from-appsettings","title":"Connection Configuration (from appsettings)","text":"<pre><code>{\n  \"EventHub\": {\n    \"EnterpriseFTP\": {\n      \"ConnectionString\": \"Endpoint=sb://...\",\n      \"EventHubName\": \"enterprise-{env}-ftp-ehb\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#event-types","title":"Event Types","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#inbound-events","title":"Inbound Events","text":"<p>Events triggering file transfer jobs:</p> Type Source Subject Description <code>Succeeded</code> <code>FTP.File.ExternalService</code> <code>File Upload</code> File uploaded to SFTP <code>Succeeded</code> <code>BlobStore</code> <code>File Upload</code> File uploaded to Blob <code>Scheduled</code> <code>Scheduler</code> <code>Batch Process</code> Scheduled batch trigger"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#outbound-events-fireevent-action","title":"Outbound Events (FireEvent Action)","text":"<p>Events generated by job completion:</p> Type Source Subject Description <code>Succeeded</code> Configurable Configurable Job completed successfully <code>Error</code> Configurable Configurable Job failed"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#message-validation","title":"Message Validation","text":"<p>FileEventHandler validates all incoming messages:</p> <ol> <li>JSON Format: Message must be valid JSON</li> <li>Required Fields: <code>type</code>, <code>source</code>, <code>subject</code>, <code>data.accountId</code> must be present</li> <li>Non-Empty Values: Required fields cannot be empty strings</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#validation-flow","title":"Validation Flow","text":"<pre><code>// From MessageHandler.cs\nif (string.IsNullOrEmpty(Notify.type) ||\n    string.IsNullOrEmpty(Notify.subject) ||\n    string.IsNullOrEmpty(Notify.source) ||\n    string.IsNullOrEmpty(Notify.data.accountId))\n{\n    // Mark as garbage message\n    return null;\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#error-handling","title":"Error Handling","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#invalid-messages","title":"Invalid Messages","text":"<ul> <li>Logged with full message content</li> <li>Recorded in <code>jobstatus</code> table with <code>Invalid</code> status</li> <li>Include <code>InvalidReason</code> for debugging</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#processing-failures","title":"Processing Failures","text":"<ul> <li>Retry with exponential backoff (configurable)</li> <li>After max retries, marked as <code>Failed</code></li> <li>Detailed error in <code>Message</code> field</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#event-chaining","title":"Event Chaining","text":"<p>Jobs can fire new events upon completion using the <code>FireEvent</code> action:</p> <pre><code>{\n  \"type\": \"FireEvent\",\n  \"eventType\": \"FileProcessed\",\n  \"eventSource\": \"FTS.JobHandler\",\n  \"eventSubject\": \"File Ready\",\n  \"eventAccountId\": \"ACCOUNT001\",\n  \"eventFileName\": \"{@Message.fileName}\"\n}\n</code></pre> <p>This enables: - Multi-stage processing pipelines - Notification to downstream systems - Event-driven workflows</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#monitoring-events","title":"Monitoring Events","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#datadog-integration","title":"Datadog Integration","text":"<p>All event processing is traced via Datadog APM: - Event receipt timestamp - Processing duration - Success/failure status - Correlation IDs for tracing</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#logging","title":"Logging","text":"<p>NLog captures: - Full event payload (debug level) - Routing decisions - Error details</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/event-driven-architecture.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Queue Architecture</li> <li>Notification Model</li> <li>Action Types - FireEvent</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/logical-architecture.html","title":"Logical architecture","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/logical-architecture.html#logical-architecture-diagram","title":"Logical Architecture Diagram","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html","title":"Multi-Cloud Storage Architecture","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#multi-cloud-storage-architecture","title":"Multi-Cloud Storage Architecture","text":"<p>FTS supports file transfers across multiple cloud providers and protocols. This document describes the storage integration architecture.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#supported-storage-types","title":"Supported Storage Types","text":"Type Value Description Protocol <code>Internal-SFTP</code> Internal SFTP server (Azure File Share mounted) SFTP <code>External-SFTP</code> External SFTP server (Azure File Share mounted) SFTP <code>Vendor-SFTP</code> Third-party vendor SFTP servers SFTP <code>Vendor-FTP</code> Third-party vendor FTP/FTPS servers FTP/FTPS <code>BlobStore</code> Azure Blob Storage Azure SDK <code>GCP</code> Google Cloud Storage GCP SDK <code>AmazonS3</code> Amazon S3 AWS SDK <code>Internal-APIM</code> Azure API Management HTTPS <code>AzureFile-API</code> Azure File Share via API Azure SDK"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#server-class-hierarchy","title":"Server Class Hierarchy","text":"<pre><code>classDiagram\n    class IServersReadWrite {\n        &lt;&lt;interface&gt;&gt;\n        +ReadFile(action, invalidReason)\n        +WriteFile(action, destination, content, invalidReason)\n        +DeleteFile(action, invalidReason)\n        +RenameFile(action, destination, invalidReason)\n        +GetFileList(action, invalidReason)\n        +TryTimesRead: int\n        +TryTimesWrite: int\n        +TryTimesDelete: int\n        +TryTimesRename: int\n    }\n\n    class AccessToServers {\n        +CurrentMessageInfo currentMessageInfo\n        +ReplaceFileName(path, removeBackSlash)\n        +ReplaceDateTime(value)\n        #GetDestinationPath(action, destination)\n    }\n\n    class InternalSFTPServer {\n        +ReadFile()\n        +WriteFile()\n        +DeleteFile()\n    }\n\n    class ExternalSFTPServer {\n        +ReadFile()\n        +WriteFile()\n        +DeleteFile()\n    }\n\n    class VendorSFTPServer {\n        -SftpClient client\n        +ReadFile()\n        +WriteFile()\n        +Connect()\n        +Disconnect()\n    }\n\n    class VendorFTPServer {\n        -FtpClient client\n        +ReadFile()\n        +WriteFile()\n        +Connect()\n    }\n\n    class BlobStoreServer {\n        -BlobContainerClient container\n        +ReadFile()\n        +WriteFile()\n        +DeleteFile()\n    }\n\n    class GCPServer {\n        -StorageClient client\n        +ReadFile()\n        +WriteFile()\n        +DeleteFile()\n    }\n\n    class AmazonS3Server {\n        -AmazonS3Client client\n        +ReadFile()\n        +WriteFile()\n        +DeleteFile()\n    }\n\n    class Internal_APIM {\n        -HttpClient client\n        +ReadFile()\n        +WriteFile()\n    }\n\n    class AzureFile_API {\n        -ShareFileClient client\n        +ReadFile()\n        +WriteFile()\n    }\n\n    IServersReadWrite &lt;|.. AccessToServers\n    AccessToServers &lt;|-- InternalSFTPServer\n    AccessToServers &lt;|-- ExternalSFTPServer\n    AccessToServers &lt;|-- VendorSFTPServer\n    AccessToServers &lt;|-- VendorFTPServer\n    AccessToServers &lt;|-- BlobStoreServer\n    AccessToServers &lt;|-- GCPServer\n    AccessToServers &lt;|-- AmazonS3Server\n    AccessToServers &lt;|-- Internal_APIM\n    AccessToServers &lt;|-- AzureFile_API\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#azure-blob-storage-blobstore","title":"Azure Blob Storage (BlobStore)","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration","title":"Configuration","text":"<pre><code>{\n  \"source\": {\n    \"type\": \"BlobStore\",\n    \"endpoint\": \"https://{account}.blob.core.windows.net\",\n    \"credentials\": {\n      \"containerName\": \"files\",\n      \"connectionString\": \"{@JobSecrets.blobConnection}\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#features","title":"Features","text":"<ul> <li>SAS token or connection string authentication</li> <li>Container-level access</li> <li>Path-based file organization</li> <li>Supports large file transfers</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#required-fields","title":"Required Fields","text":"Field Description <code>endpoint</code> Blob storage endpoint URL <code>credentials.containerName</code> Container name <code>credentials.connectionString</code> Connection string or SAS token"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#google-cloud-storage-gcp","title":"Google Cloud Storage (GCP)","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration_1","title":"Configuration","text":"<pre><code>{\n  \"source\": {\n    \"type\": \"GCP\",\n    \"bucketName\": \"my-bucket\",\n    \"servicetype\": \"service_account\",\n    \"projectID\": \"my-project\",\n    \"privateKeyID\": \"{@JobSecrets.gcpKeyId}\",\n    \"clientEmail\": \"service@project.iam.gserviceaccount.com\",\n    \"clientID\": \"123456789\",\n    \"authUri\": \"https://accounts.google.com/o/oauth2/auth\",\n    \"tokenUri\": \"https://oauth2.googleapis.com/token\",\n    \"authProvider\": \"https://www.googleapis.com/oauth2/v1/certs\",\n    \"clientCertUrl\": \"https://www.googleapis.com/robot/v1/metadata/x509/...\",\n    \"universeDomain\": \"googleapis.com\",\n    \"credentials\": {\n      \"privateKey\": \"{@JobSecrets.gcpPrivateKey}\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#features_1","title":"Features","text":"<ul> <li>Service account authentication</li> <li>Bucket-level access</li> <li>Full GCP credential chain support</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#required-fields_1","title":"Required Fields","text":"Field Description <code>bucketName</code> GCS bucket name <code>servicetype</code> Authentication type <code>projectID</code> GCP project ID <code>clientEmail</code> Service account email <code>credentials.privateKey</code> Private key content"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#amazon-s3-amazons3","title":"Amazon S3 (AmazonS3)","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration_2","title":"Configuration","text":"<pre><code>{\n  \"source\": {\n    \"type\": \"AmazonS3\",\n    \"bucketName\": \"my-bucket\",\n    \"region\": \"us-east-1\",\n    \"credentials\": {\n      \"accessKey\": \"{@JobSecrets.s3AccessKey}\",\n      \"secretKey\": \"{@JobSecrets.s3SecretKey}\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#features_2","title":"Features","text":"<ul> <li>Access key / secret key authentication</li> <li>Region-specific endpoints</li> <li>Standard S3 operations</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#required-fields_2","title":"Required Fields","text":"Field Description <code>bucketName</code> S3 bucket name <code>region</code> AWS region <code>credentials.accessKey</code> AWS access key <code>credentials.secretKey</code> AWS secret key"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#vendor-sftp-vendor-sftp","title":"Vendor SFTP (Vendor-SFTP)","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration-with-password","title":"Configuration with Password","text":"<pre><code>{\n  \"source\": {\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.vendor.com\",\n    \"port\": \"22\",\n    \"path\": \"/incoming\",\n    \"credentials\": {\n      \"type\": \"BasicAuth\",\n      \"username\": \"{@JobSecrets.sftpUser}\",\n      \"password\": \"{@JobSecrets.sftpPass}\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration-with-ssh-key","title":"Configuration with SSH Key","text":"<pre><code>{\n  \"source\": {\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.vendor.com\",\n    \"port\": \"22\",\n    \"path\": \"/incoming\",\n    \"credentials\": {\n      \"type\": \"SSHKey\",\n      \"username\": \"{@JobSecrets.sftpUser}\",\n      \"sshkey\": \"{@AppSettings.jobsettingsfolder}/id_rsa\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#authentication-types","title":"Authentication Types","text":"Type Description <code>BasicAuth</code> Username and password <code>SSHKey</code> Username and SSH private key"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#required-fields_3","title":"Required Fields","text":"Field Description <code>host</code> SFTP server hostname <code>port</code> Port number (default: 22) <code>path</code> Base path on server <code>credentials.type</code> <code>BasicAuth</code> or <code>SSHKey</code>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#vendor-ftp-vendor-ftp","title":"Vendor FTP (Vendor-FTP)","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration_3","title":"Configuration","text":"<pre><code>{\n  \"source\": {\n    \"type\": \"Vendor-FTP\",\n    \"host\": \"ftp.vendor.com\",\n    \"port\": \"21\",\n    \"path\": \"/incoming\",\n    \"ssl\": true,\n    \"credentials\": {\n      \"username\": \"{@JobSecrets.ftpUser}\",\n      \"password\": \"{@JobSecrets.ftpPass}\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#features_3","title":"Features","text":"<ul> <li>FTP and FTPS (explicit TLS) support</li> <li>SSL/TLS toggle via <code>ssl</code> field</li> <li>Standard FTP operations</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#required-fields_4","title":"Required Fields","text":"Field Description <code>host</code> FTP server hostname <code>port</code> Port number (default: 21) <code>ssl</code> Enable FTPS (default: false) <code>credentials.username</code> FTP username <code>credentials.password</code> FTP password"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#internal-sftp-servers","title":"Internal SFTP Servers","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#internal-sftp","title":"Internal-SFTP","text":"<p>Mounted Azure File Share for internal file operations.</p> <pre><code>{\n  \"source\": {\n    \"type\": \"Internal-SFTP\",\n    \"path\": \"{@AppSettings.sftpintroot}/{@Message.accountID}\"\n  }\n}\n</code></pre> <p>Mount path: <code>/mnt/sftpintroot</code></p>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#external-sftp","title":"External-SFTP","text":"<p>Mounted Azure File Share for external-facing SFTP.</p> <pre><code>{\n  \"source\": {\n    \"type\": \"External-SFTP\",\n    \"path\": \"{@AppSettings.sftpextroot}/{@Message.accountID}\"\n  }\n}\n</code></pre> <p>Mount path: <code>/mnt/sftpextroot</code></p>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#azure-api-management-internal-apim","title":"Azure API Management (Internal-APIM)","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration_4","title":"Configuration","text":"<pre><code>{\n  \"destinations\": [{\n    \"id\": 1,\n    \"type\": \"Internal-APIM\",\n    \"TargetUrl\": \"https://api.example.com/endpoint\",\n    \"TimeoutMs\": \"30000\",\n    \"RepeatAPI\": \"3\",\n    \"credentials\": {\n      \"OAuthScope\": \"api://scope\"\n    }\n  }]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#features_4","title":"Features","text":"<ul> <li>OAuth 2.0 client credentials flow</li> <li>Configurable timeout and retry</li> <li>JSON payload support</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#required-fields_5","title":"Required Fields","text":"Field Description <code>TargetUrl</code> API endpoint URL <code>TimeoutMs</code> Request timeout (ms) <code>credentials.OAuthScope</code> OAuth scope"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#azure-file-share-api-azurefile-api","title":"Azure File Share API (AzureFile-API)","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#configuration_5","title":"Configuration","text":"<pre><code>{\n  \"destinations\": [{\n    \"id\": 1,\n    \"type\": \"AzureFile-API\",\n    \"path\": \"/share/folder\",\n    \"credentials\": {\n      \"connectionString\": \"{@JobSecrets.fileShareConnection}\",\n      \"shareName\": \"files\"\n    }\n  }]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#features_5","title":"Features","text":"<ul> <li>Direct Azure File Share access via SDK</li> <li>Connection string authentication</li> <li>SMB-style paths</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#server-selection-logic","title":"Server Selection Logic","text":"<p>From <code>ActionProcess.cs</code>, server instantiation:</p> <pre><code>if (source.type == \"Internal-SFTP\")\n    Server = new InternalSFTPServer(currentMessageInfo);\nelse if (source.type == \"External-SFTP\")\n    Server = new ExternalSFTPServer(currentMessageInfo);\nelse if (source.type == \"Vendor-SFTP\")\n    Server = new VendorSFTPServer(currentMessageInfo);\nelse if (source.type == \"Vendor-FTP\")\n    Server = new VendorFTPServer(currentMessageInfo);\nelse if (source.type == \"BlobStore\")\n    Server = new BlobStoreServer(currentMessageInfo);\nelse if (source.type == \"Internal-APIM\")\n    Server = new Internal_APIM(currentMessageInfo);\nelse if (source.type == \"AzureFile-API\")\n    Server = new AzureFile_API(currentMessageInfo);\nelse if (source.type == \"GCP\")\n    Server = new GCPServer(currentMessageInfo);\nelse if (source.type == \"AmazonS3\")\n    Server = new AmazonS3Server(currentMessageInfo);\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/multi-cloud-storage.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Source/Destination Types</li> <li>Credentials Model</li> <li>Security &amp; Secrets</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html","title":"System Architecture Overview","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#system-architecture-overview","title":"System Architecture Overview","text":"<p>The File Transfer System (FTS) is an enterprise-grade, event-driven microservices platform for orchestrating file transfers across multiple storage systems and cloud providers.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#system-context","title":"System Context","text":"<pre><code>graph TB\n    subgraph External Systems\n        VSFTP[Vendor SFTP Servers]\n        VFTP[Vendor FTP Servers]\n        S3[AWS S3]\n        GCS[Google Cloud Storage]\n    end\n\n    subgraph Azure Platform\n        EH[Azure Event Hub]\n        QS[Azure Queue Storage]\n        TS[Azure Table Storage]\n        BS[Azure Blob Storage]\n        AFS[Azure File Share]\n        APIM[Azure API Management]\n        KV[Azure Key Vault]\n    end\n\n    subgraph FTS Platform\n        FEH[FileEventHandler]\n        FJH[FileJobHandler]\n        FJHTMS[FileJobHandler-TMS*]\n        FJHPP[FileJobHandler-PriceProposal]\n    end\n\n    subgraph Internal SFTP\n        INT[Internal SFTP Server]\n        EXT[External SFTP Server]\n    end\n\n    subgraph Monitoring\n        DD[Datadog APM]\n        CLAM[ClamAV Scanner]\n    end\n\n    %% Event Flow\n    EH --&gt; FEH\n    FEH --&gt; QS\n    FEH --&gt; TS\n    QS --&gt; FJH\n    QS --&gt; FJHTMS\n    QS --&gt; FJHPP\n\n    %% Storage Connections\n    FJH --&gt; BS\n    FJH --&gt; AFS\n    FJH --&gt; INT\n    FJH --&gt; EXT\n    FJH --&gt; VSFTP\n    FJH --&gt; VFTP\n    FJH --&gt; S3\n    FJH --&gt; GCS\n    FJH --&gt; APIM\n\n    %% Security\n    FJH --&gt; KV\n    FJH --&gt; CLAM\n\n    %% Monitoring\n    FJH --&gt; DD\n    FEH --&gt; DD\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#component-relationships","title":"Component Relationships","text":"<pre><code>graph LR\n    subgraph Shared Library\n        FTC[FileTransferCommon]\n    end\n\n    subgraph Event Processing\n        FEH[FileEventHandler]\n    end\n\n    subgraph Job Handlers\n        FJH[FileJobHandler]\n        TMSR[FileJobHandler-TMSRoute]\n        TMSS[FileJobHandler-TMSStatus]\n        TMSC[FileJobHandler-TMSCarrierPOD]\n        PP[FileJobHandler-PriceProposal]\n    end\n\n    FTC --&gt; FEH\n    FTC --&gt; FJH\n    FTC --&gt; TMSR\n    FTC --&gt; TMSS\n    FTC --&gt; TMSC\n    FTC --&gt; PP\n\n    FEH -.-&gt;|Queue Messages| FJH\n    FEH -.-&gt;|Queue Messages| TMSR\n    FEH -.-&gt;|Queue Messages| TMSS\n    FEH -.-&gt;|Queue Messages| TMSC\n    FEH -.-&gt;|Queue Messages| PP\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#component-overview","title":"Component Overview","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#filetransfercommon","title":"FileTransferCommon","text":"<p>Shared library providing: - Common interfaces (<code>IServersReadWrite</code>, <code>IVirusScan</code>, <code>IActionProcess</code>) - Data models (<code>Notification</code>, <code>Credentials</code>) - Azure service helpers (Queue, Table, Blob operations) - PGP/RSA encryption utilities - Logging infrastructure</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#fileeventhandler","title":"FileEventHandler","text":"<p>Event ingestion service: - Listens to Azure Event Hub for CloudEvents notifications - Validates incoming messages - Routes messages to appropriate queues based on <code>jobconfig</code> table - Records job status to <code>jobstatus</code> table</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#filejobhandler","title":"FileJobHandler","text":"<p>Generic job processing handler: - Reads job configurations from mounted file share - Executes action sequences (read, transform, write) - Supports all source/destination types - Handles encryption, virus scanning, encoding</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#specialized-handlers","title":"Specialized Handlers","text":"<p>Domain-specific handlers with custom business logic: - TMSRoute: Transportation Management System routing files - TMSStatus: TMS status file processing - TMSCarrierPOD: Carrier Proof of Delivery processing - PriceProposal: Pricing proposal file handling</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#data-flow","title":"Data Flow","text":"<ol> <li>Event Ingestion: External systems or internal processes publish CloudEvents to Azure Event Hub</li> <li>Event Routing: FileEventHandler reads events, validates them, and routes to appropriate queue</li> <li>Job Pickup: Job handlers poll their assigned queue for messages</li> <li>Config Resolution: Handler loads <code>jobsettings.json</code> from mounted file share</li> <li>Action Execution: Handler executes configured actions in sequence</li> <li>Status Reporting: Handler updates job status and fires completion events</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#storage-architecture","title":"Storage Architecture","text":"Storage Type Purpose Access Pattern Azure Event Hub Event ingestion Pub/Sub streaming Azure Queue Storage Job distribution Queue-based polling Azure Table Storage Configuration and status Key-value lookup Azure Blob Storage File staging and storage Object storage Azure File Share Job configurations Mounted file system Azure Key Vault Secrets management Secret retrieval"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#security-layers","title":"Security Layers","text":"<ol> <li>Transport Security: TLS for all Azure services, SFTP/FTPS for file transfers</li> <li>Authentication: SAS tokens, managed identities, SSH keys</li> <li>Encryption: PGP encryption/decryption, RSA encryption</li> <li>Virus Scanning: ClamAV integration for uploaded files</li> <li>Secrets Management: Azure Key Vault for sensitive credentials</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#scalability-model","title":"Scalability Model","text":"<ul> <li>Horizontal Scaling: Multiple handler pod replicas via Kubernetes</li> <li>Queue Isolation: Separate queues for different workloads prevent contention</li> <li>Event Partitioning: Event Hub partitions for parallel processing</li> <li>Retry Mechanisms: Built-in retry with configurable delays</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/overview.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Event-Driven Architecture</li> <li>Queue Architecture</li> <li>Multi-Cloud Storage</li> <li>Deployment Architecture</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/physical-architecture.html","title":"Physical architecture","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/physical-architecture.html#physical-architecture-diagram","title":"Physical Architecture Diagram","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html","title":"Queue Architecture","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#queue-architecture","title":"Queue Architecture","text":"<p>The FTS platform uses Azure Queue Storage to distribute jobs to specialized handlers. A routing table determines which queue receives each event based on event attributes.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#queue-topology","title":"Queue Topology","text":"<pre><code>Azure Event Hub\n       \u2502\n       \u25bc\nFileEventHandler \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n       \u2502                                                            \u2502\n       \u251c\u2500\u2500 Query jobconfig table                                   \u2502\n       \u2502                                                            \u2502\n       \u25bc                                                            \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Azure Queue Storage                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 jobs            \u2502 jobstmsroute    \u2502 jobstmsstatus   \u2502 ...more      \u2502\n\u2502 (generic)       \u2502 (TMS Route)     \u2502 (TMS Status)    \u2502              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                 \u2502                 \u2502\n         \u25bc                 \u25bc                 \u25bc\n   FileJobHandler   FileJobHandler   FileJobHandler\n                      -TMSRoute        -TMSStatus\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#routing-configuration-table-jobconfig","title":"Routing Configuration Table (jobconfig)","text":"<p>The <code>jobconfig</code> Azure Table stores routing rules that map events to queues.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#table-schema","title":"Table Schema","text":"Property Type Description <code>PartitionKey</code> string Queue assignment identifier <code>RowKey</code> string Unique rule identifier <code>EventType</code> string Event type to match <code>EventSource</code> string Event source to match <code>EventSubject</code> string Event subject to match <code>EventAccountID</code> string Account ID to match"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#routing-decision-flow","title":"Routing Decision Flow","text":"<pre><code>flowchart TD\n    A[Incoming Event] --&gt; B{Parse Event}\n    B --&gt;|Invalid JSON| C[Mark Invalid]\n    B --&gt;|Valid| D{Required Fields?}\n    D --&gt;|Missing| E[Mark Garbage]\n    D --&gt;|Present| F[Query jobconfig Table]\n\n    F --&gt; G{Match Found?}\n    G --&gt;|No| H[Mark NoAssigned]\n    G --&gt;|Yes| I[Get PartitionKey]\n\n    I --&gt; J{Which Queue?}\n    J --&gt;|jobs| K[Send to jobs queue]\n    J --&gt;|jobstmsroute| L[Send to TMS Route queue]\n    J --&gt;|jobstmsstatus| M[Send to TMS Status queue]\n    J --&gt;|jobtmscarrierpod| N[Send to TMS POD queue]\n    J --&gt;|jobsbylcppricing| O[Send to Pricing queue]\n    J --&gt;|Other| P[Send to specialized queue]\n\n    K --&gt; Q[Update jobstatus: Assigned]\n    L --&gt; Q\n    M --&gt; Q\n    N --&gt; Q\n    O --&gt; Q\n    P --&gt; Q\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#routing-lookup","title":"Routing Lookup","text":"<p>The routing lookup matches on four attributes (from <code>MessageHandler.cs</code>):</p> <pre><code>PartitionKey = _tableHelper.SearchConfigTable(\n    Notify.data.accountId,  // EventAccountID\n    Notify.source,          // EventSource\n    Notify.type,            // EventType\n    Notify.subject,         // EventSubject\n    OriginalOffsetId\n);\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#example-routing-rules","title":"Example Routing Rules","text":"PartitionKey EventType EventSource EventSubject EventAccountID jobs Succeeded FTP.File.ExternalService File Upload ACCOUNT001 jobstmsroute Succeeded TMS.Route File Upload TMS001 jobstmsstatus Succeeded TMS.Status Status Update TMS001 jobsbylcppricing Succeeded Pricing.LCP Price Update PRICING001"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#queue-names","title":"Queue Names","text":"<p>The system supports multiple specialized queues:</p> Queue Name Handler Description <code>jobs</code> FileJobHandler Generic file transfer jobs <code>jobstmsroute</code> FileJobHandler-TMSRoute TMS routing files <code>jobstmsstatus</code> FileJobHandler-TMSStatus TMS status files <code>jobtmscarrierpod</code> FileJobHandler-TMSCarrierPOD Carrier POD files <code>jobsbylcppricing</code> FileJobHandler-PriceProposal LCP pricing files <code>jobsbellusermanagement</code> FileJobHandler Bell user management <code>jobsbellsrs</code> FileJobHandler Bell SRS files <code>jobsbellpricegrid</code> FileJobHandler Bell price grid <code>jobscalgary</code> FileJobHandler Calgary operations <code>jobsdigitalml</code> FileJobHandler Digital ML files <code>jobspunchcard</code> FileJobHandler Punchcard processing <code>jobtmsrateshop</code> FileJobHandler TMS rate shop <code>jobspostalmate</code> FileJobHandler Postalmate integration <code>jobhrvariancereport</code> FileJobHandler HR variance reports <code>jobmonerisupdater</code> FileJobHandler Moneris updates <code>jobstatfloklaviyo</code> FileJobHandler Statflo/Klaviyo <code>jobamazontax</code> FileJobHandler Amazon tax files <code>jobamzskulist</code> FileJobHandler Amazon SKU lists"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#job-processing-sequence","title":"Job Processing Sequence","text":"<pre><code>sequenceDiagram\n    participant Q as Azure Queue\n    participant FJH as FileJobHandler\n    participant FS as File Share\n    participant SRC as Source System\n    participant DST as Destination System\n    participant ST as Status Table\n\n    Q-&gt;&gt;FJH: Dequeue message\n    FJH-&gt;&gt;FJH: Parse CloudEvent\n    FJH-&gt;&gt;FS: Load jobsettings.json\n    FS--&gt;&gt;FJH: Job configuration\n\n    loop For each action\n        alt ReadFile\n            FJH-&gt;&gt;SRC: Read file\n            SRC--&gt;&gt;FJH: File content\n        else Transform (Encrypt/Decrypt/Scan)\n            FJH-&gt;&gt;FJH: Process in memory\n        else WriteFile\n            FJH-&gt;&gt;DST: Write file\n        else FireEvent\n            FJH-&gt;&gt;Q: Send new event\n        end\n    end\n\n    alt Success\n        FJH-&gt;&gt;ST: Update: Succeeded\n    else Failure\n        FJH-&gt;&gt;ST: Update: Failed\n    end\n\n    FJH-&gt;&gt;Q: Delete message\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#queue-configuration","title":"Queue Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#appsettingsjson","title":"appsettings.json","text":"<pre><code>{\n  \"Queues\": {\n    \"jobs\": {\n      \"Url\": \"https://{storage}.queue.core.windows.net/jobs\",\n      \"SASToken\": \"sv=2018-03-28&amp;si=...\"\n    },\n    \"NextCheck\": 1000,\n    \"NextWriteForLogs\": 60,\n    \"VisibilityTimeout\": 120\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#configuration-properties","title":"Configuration Properties","text":"Property Type Description <code>Url</code> string Queue endpoint URL <code>SASToken</code> string SAS token for authentication <code>NextCheck</code> int Polling interval in milliseconds <code>NextWriteForLogs</code> int Log write interval in seconds <code>VisibilityTimeout</code> int Message invisibility timeout (minutes)"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#message-visibility","title":"Message Visibility","text":"<p>When a handler dequeues a message: 1. Message becomes invisible for <code>VisibilityTimeout</code> minutes 2. Handler processes the job 3. On success: Handler deletes the message 4. On failure: Message becomes visible again for retry 5. After max retries: Message moves to poison queue</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#error-handling","title":"Error Handling","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#retry-configuration","title":"Retry Configuration","text":"<pre><code>{\n  \"Actions\": {\n    \"RetryFailureSource\": 3,\n    \"RetryFailureDestination\": 3,\n    \"RetryFailureSourceDelay\": 5,\n    \"RetryFailureDestinationDelay\": 5\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#retry-behavior","title":"Retry Behavior","text":"<ul> <li>Source operations retry <code>RetryFailureSource</code> times</li> <li>Destination operations retry <code>RetryFailureDestination</code> times</li> <li>Delay between retries (seconds) is configurable</li> <li>Exponential backoff not implemented (linear retry)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#jobstatus-table","title":"JobStatus Table","text":"<p>All job processing states are recorded in the <code>jobstatus</code> Azure Table.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#status-values","title":"Status Values","text":"Status Description <code>Invalid</code> Message validation failed <code>ReadMessage</code> Message being processed <code>Assigned</code> Routed to queue <code>NoAssigned</code> No routing rule matched <code>Succeeded</code> Job completed successfully <code>Failed</code> Job execution failed <p>See JobStatus Model for full schema.</p>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#scaling-considerations","title":"Scaling Considerations","text":""},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#queue-partitioning","title":"Queue Partitioning","text":"<ul> <li>Separate queues prevent workload contention</li> <li>Specialized handlers can scale independently</li> <li>High-volume accounts can have dedicated queues</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#handler-scaling","title":"Handler Scaling","text":"<ul> <li>Kubernetes HPA for pod scaling</li> <li>Multiple replicas compete for queue messages</li> <li>Message locking prevents duplicate processing</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/architecture/queue-architecture.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Event-Driven Architecture</li> <li>JobStatus Model</li> <li>Routing ConfigModel</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html","title":"FileEventHandler","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#fileeventhandler","title":"FileEventHandler","text":"<p>Event Hub listener service responsible for event ingestion, validation, and routing to processing queues.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#repository","title":"Repository","text":"<p><code>FileEventHandler/</code></p>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#purpose","title":"Purpose","text":"<p>FileEventHandler is the entry point for all FTS events: - Listens to Azure Event Hub for CloudEvents - Validates incoming messages - Routes events to appropriate processing queues - Records job status in Azure Table Storage</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#architecture","title":"Architecture","text":"<pre><code>Azure Event Hub\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   FileEventHandler      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 EventHubListener        \u2502 \u25c4\u2500\u2500 Consumes events\n\u2502 MessageHandler          \u2502 \u25c4\u2500\u2500 Validates &amp; routes\n\u2502 JobStatusManipulate     \u2502 \u25c4\u2500\u2500 Records status\n\u2502 TableHelper             \u2502 \u25c4\u2500\u2500 Config lookup\n\u2502 QueueHelper             \u2502 \u25c4\u2500\u2500 Queue operations\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\nAzure Queue Storage\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#core-components","title":"Core Components","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#eventhublistener","title":"EventHubListener","text":"<p>Manages Event Hub connection and event consumption.</p> <pre><code>public class EventHubListener\n{\n    public async Task StartListening();\n    public async Task ProcessEvent(EventData eventData);\n}\n</code></pre> <p>Responsibilities: - Establish Event Hub connection - Manage consumer group - Track partition offsets - Handle connection failures</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#messagehandler","title":"MessageHandler","text":"<p>Processes individual messages.</p> <pre><code>public class MessageHandler : IMessageHandler\n{\n    public async Task&lt;enumProcessDataResult&gt; Process(string data, string partitionId, long offsetId);\n    private Notification ValidateData(string data, string partitionId, long offsetId);\n    private async Task&lt;enumProcessDataResult&gt; SendMessageToQueue(Notification notify, string data, string partitionId, long offsetId);\n}\n</code></pre> <p>Responsibilities: - Parse CloudEvent JSON - Validate required fields - Query routing table - Send to appropriate queue</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#jobstatusmanipulate","title":"JobStatusManipulate","text":"<p>Manages job status records.</p> <pre><code>public class JobStatusManipulate\n{\n    public async Task&lt;bool&gt; InsertInvalid(string data, string partitionKey, string partitionId, long offsetId, string reason);\n    public async Task&lt;bool&gt; InsertAssigned(string data, Notification notify, string partitionId, long offsetId, string queue);\n    public async Task&lt;bool&gt; InsertNotAssigned(string data, Notification notify, string partitionId, long offsetId, string reason);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#message-flow","title":"Message Flow","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#input-contract","title":"Input Contract","text":"<p>CloudEvent (from Event Hub):</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"FTP.File.ExternalService\",\n  \"subject\": \"File Upload\",\n  \"id\": \"event-uuid\",\n  \"time\": \"2024-01-15T10:30:00+0000\",\n  \"data\": {\n    \"accountId\": \"ACCOUNT001\",\n    \"fileName\": \"incoming/file.csv\",\n    \"correlationId\": \"corr-123\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#output-contract","title":"Output Contract","text":"<p>Queue Message (same CloudEvent forwarded):</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"FTP.File.ExternalService\",\n  \"subject\": \"File Upload\",\n  \"id\": \"event-uuid\",\n  \"time\": \"2024-01-15T10:30:00+0000\",\n  \"data\": {\n    \"accountId\": \"ACCOUNT001\",\n    \"fileName\": \"incoming/file.csv\",\n    \"correlationId\": \"corr-123\"\n  }\n}\n</code></pre> <p>JobStatus Record:</p> <pre><code>{\n  \"PartitionKey\": \"FTP.File.ExternalService-ACCOUNT001-file.csv\",\n  \"RowKey\": \"unique-id\",\n  \"Status\": \"Assigned\",\n  \"Queue\": \"jobs\",\n  \"EventType\": \"Succeeded\",\n  \"EventSource\": \"FTP.File.ExternalService\",\n  \"EventSubject\": \"File Upload\",\n  \"AccountID\": \"ACCOUNT001\",\n  \"FileName\": \"incoming/file.csv\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#validation-logic","title":"Validation Logic","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#required-fields-check","title":"Required Fields Check","text":"<pre><code>if (string.IsNullOrEmpty(Notify.type) ||\n    string.IsNullOrEmpty(Notify.subject) ||\n    string.IsNullOrEmpty(Notify.source) ||\n    string.IsNullOrEmpty(Notify.data.accountId))\n{\n    return null; // Invalid message\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#process-results","title":"Process Results","text":"<pre><code>public enum enumProcessDataResult\n{\n    Processed,    // Successfully routed\n    GarbageMsg,   // Invalid or unroutable\n    AzureIssue    // Azure service error\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#routing-logic","title":"Routing Logic","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#config-table-query","title":"Config Table Query","text":"<p>The routing lookup uses the <code>jobconfig</code> Azure Table:</p> <pre><code>PartitionKey = _tableHelper.SearchConfigTable(\n    Notify.data.accountId,  // EventAccountID\n    Notify.source,          // EventSource\n    Notify.type,            // EventType\n    Notify.subject,         // EventSubject\n    OriginalOffsetId\n);\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#queue-selection","title":"Queue Selection","text":"<pre><code>if (PartitionKey == \"jobs\")\n    await _ProjectInitialize.queuejobs.SendMessage(Data);\nelse if (PartitionKey == \"jobstmsroute\")\n    await _ProjectInitialize.queueTmsRoute.SendMessage(Data);\nelse if (PartitionKey == \"jobstmsstatus\")\n    await _ProjectInitialize.queueTmsStatus.SendMessage(Data);\n// ... additional queue mappings\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#appsettingsjson","title":"appsettings.json","text":"<pre><code>{\n  \"EventHub\": {\n    \"EnterpriseFTP\": {\n      \"ConnectionString\": \"Endpoint=sb://...\",\n      \"EventHubName\": \"enterprise-{env}-ftp-ehb\"\n    }\n  },\n  \"Queues\": {\n    \"jobs\": {\n      \"Url\": \"https://{storage}.queue.core.windows.net/jobs\",\n      \"SASToken\": \"...\"\n    }\n  },\n  \"Tables\": {\n    \"jobstatus\": {\n      \"Url\": \"https://{storage}.table.core.windows.net/\",\n      \"SASToken\": \"...\",\n      \"TableName\": \"jobstatus\"\n    },\n    \"jobconfig\": {\n      \"Url\": \"https://{storage}.table.core.windows.net/\",\n      \"SASToken\": \"...\",\n      \"TableName\": \"jobconfig\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#error-handling","title":"Error Handling","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#invalid-messages","title":"Invalid Messages","text":"<ul> <li>Logged with full message content</li> <li>Recorded in <code>jobstatus</code> with <code>Invalid</code> status</li> <li>Event offset committed (no retry)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#no-route-found","title":"No Route Found","text":"<ul> <li>Logged as warning</li> <li>Recorded as <code>NoAssigned</code></li> <li>Event offset committed (no retry)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#azure-service-errors","title":"Azure Service Errors","text":"<ul> <li>Logged as error</li> <li>Returns <code>AzureIssue</code> result</li> <li>Event may be retried based on consumer group behavior</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#deployment","title":"Deployment","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#kubernetes","title":"Kubernetes","text":"<p>Single pod deployment listening to Event Hub.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#volumes","title":"Volumes","text":"<ul> <li>No persistent storage required</li> <li>Configuration via Kubernetes secrets</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#scaling","title":"Scaling","text":"<ul> <li>Single instance recommended (consumer group manages partitions)</li> <li>Multiple instances share partition load</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#dependencies","title":"Dependencies","text":"<ul> <li>FileTransferCommon (shared library)</li> <li>Azure.Messaging.EventHubs</li> <li>Microsoft.Azure.Cosmos.Table</li> <li>Azure.Storage.Queues</li> <li>NLog</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#monitoring","title":"Monitoring","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#key-metrics","title":"Key Metrics","text":"<ul> <li>Events processed per second</li> <li>Invalid message rate</li> <li>Routing success rate</li> <li>Azure service latency</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#datadog-integration","title":"Datadog Integration","text":"<pre><code>Logger.Info($\"Message processed: PartitionID={partitionId}, OffsetID={offsetId}\");\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-event-handler.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Event-Driven Architecture</li> <li>Queue Architecture</li> <li>Routing ConfigModel</li> <li>JobStatus Model</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html","title":"FileJobHandler-PriceProposal","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#filejobhandler-priceproposal","title":"FileJobHandler-PriceProposal","text":"<p>Specialized handler for pricing proposal files from LCP (Logistics Cost Platform) and related systems.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#repository","title":"Repository","text":"<p><code>FileJobHandler-PriceProposal/</code></p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#purpose","title":"Purpose","text":"<p>FileJobHandler-PriceProposal processes pricing files: - Handles price proposal uploads - Processes LCP pricing data - Manages pricing update workflows</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#architecture","title":"Architecture","text":"<pre><code>Azure Queue (jobsbylcppricing)\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FileJobHandler-PriceProposal      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 QueueListener                      \u2502\n\u2502 PriceProposalProcessor             \u2502\n\u2502 PriceValidation                    \u2502\n\u2502 ActionProcess                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u251c\u2500\u2500\u25b6 Pricing Sources\n       \u251c\u2500\u2500\u25b6 Pricing Storage\n       \u2514\u2500\u2500\u25b6 Pricing Systems\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#input-contract","title":"Input Contract","text":"<p>Queue Message:</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"Pricing.LCP\",\n  \"subject\": \"Price Update\",\n  \"data\": {\n    \"accountId\": \"PRICING001\",\n    \"fileName\": \"pricing/proposal_2024Q1.xlsx\",\n    \"correlationId\": \"price-corr-101\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#output-contract","title":"Output Contract","text":"<p>Processed Pricing File: - Price data validated - Format normalized - Delivered to pricing systems</p> <p>JobStatus Update:</p> <pre><code>{\n  \"Status\": \"Succeeded\",\n  \"Queue\": \"jobsbylcppricing\",\n  \"Action\": \"PriceProposalProcess\",\n  \"InvalidReason\": \"Price proposal processed successfully\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#business-logic","title":"Business Logic","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#price-validation","title":"Price Validation","text":"<ul> <li>Validates pricing file format</li> <li>Checks required pricing fields</li> <li>Verifies price ranges and units</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#price-processing","title":"Price Processing","text":"<ul> <li>Parses pricing data</li> <li>Normalizes price formats</li> <li>Applies business rules</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#routing-rule","title":"Routing Rule","text":"<pre><code>PartitionKey: jobsbylcppricing\nEventType: Succeeded\nEventSource: Pricing.LCP\nEventSubject: Price Update\nEventAccountID: PRICING001\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#job-configuration","title":"Job Configuration","text":"<pre><code>{\n  \"feedName\": \"price-proposal-processing\",\n  \"source\": {\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.lcpvendor.com\",\n    \"path\": \"/pricing/proposals\"\n  },\n  \"destinations\": [\n    {\n      \"id\": 1,\n      \"type\": \"BlobStore\",\n      \"path\": \"pricing/processed\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"Internal-APIM\",\n      \"TargetUrl\": \"https://api.example.com/v1/pricing/import\"\n    }\n  ],\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 2,\n      \"type\": \"Notification\",\n      \"sourceFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}\",\n      \"eventAccountId\": \"{@Message.accountID}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#deployment","title":"Deployment","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#queue-assignment","title":"Queue Assignment","text":"<p>Receives messages from <code>jobsbylcppricing</code> queue.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#kubernetes","title":"Kubernetes","text":"<pre><code>spec:\n  containers:\n    - name: file-job-handler-price-proposal\n      image: enterprisenonpacr.azurecr.io/enterprise/file-job-handler-price-proposal:tag\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#dependencies","title":"Dependencies","text":"<ul> <li>FileTransferCommon</li> <li>Pricing-specific libraries (if any)</li> <li>Excel processing libraries (if needed)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#monitoring","title":"Monitoring","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#key-metrics","title":"Key Metrics","text":"<ul> <li>Pricing files processed</li> <li>Price updates applied</li> <li>Processing latency</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#alerts","title":"Alerts","text":"<ul> <li>Price validation failures</li> <li>Invalid pricing format rate</li> <li>API notification failures</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-price-proposal.html#related-documentation","title":"Related Documentation","text":"<ul> <li>FileJobHandler</li> <li>Queue Architecture</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html","title":"FileJobHandler-TMSCarrierPOD","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#filejobhandler-tmscarrierpod","title":"FileJobHandler-TMSCarrierPOD","text":"<p>Specialized handler for Transportation Management System (TMS) Carrier Proof of Delivery files.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#repository","title":"Repository","text":"<p><code>FileJobHandler-TMSCarrierPOD/</code></p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#purpose","title":"Purpose","text":"<p>FileJobHandler-TMSCarrierPOD processes carrier POD (Proof of Delivery) files: - Handles delivery confirmation documents - Processes signature captures - Updates delivery status in TMS</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#architecture","title":"Architecture","text":"<pre><code>Azure Queue (jobtmscarrierpod)\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FileJobHandler-TMSCarrierPOD   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 QueueListener                   \u2502\n\u2502 PODProcessor                    \u2502\n\u2502 PODValidation                   \u2502\n\u2502 ActionProcess                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u251c\u2500\u2500\u25b6 Carrier Sources\n       \u251c\u2500\u2500\u25b6 POD Storage\n       \u2514\u2500\u2500\u25b6 TMS Systems\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#input-contract","title":"Input Contract","text":"<p>Queue Message:</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"TMS.CarrierPOD\",\n  \"subject\": \"POD Upload\",\n  \"data\": {\n    \"accountId\": \"CARRIER001\",\n    \"fileName\": \"pod/delivery_pod_SHP123456.pdf\",\n    \"correlationId\": \"pod-corr-789\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#output-contract","title":"Output Contract","text":"<p>Processed POD File: - POD document validated - Linked to shipment record - Stored in document management</p> <p>JobStatus Update:</p> <pre><code>{\n  \"Status\": \"Succeeded\",\n  \"Queue\": \"jobtmscarrierpod\",\n  \"Action\": \"PODProcess\",\n  \"InvalidReason\": \"POD processed successfully\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#business-logic","title":"Business Logic","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#pod-validation","title":"POD Validation","text":"<ul> <li>Validates POD document format (PDF, image)</li> <li>Extracts shipment reference</li> <li>Verifies carrier authentication</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#pod-processing","title":"POD Processing","text":"<ul> <li>Links POD to shipment</li> <li>Extracts delivery information</li> <li>Updates TMS delivery status</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#routing-rule","title":"Routing Rule","text":"<pre><code>PartitionKey: jobtmscarrierpod\nEventType: Succeeded\nEventSource: TMS.CarrierPOD\nEventSubject: POD Upload\nEventAccountID: CARRIER001\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#job-configuration","title":"Job Configuration","text":"<pre><code>{\n  \"feedName\": \"tms-carrier-pod-processing\",\n  \"source\": {\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.carrier.com\",\n    \"path\": \"/pod/uploads\"\n  },\n  \"destinations\": [\n    {\n      \"id\": 1,\n      \"type\": \"BlobStore\",\n      \"path\": \"tms/pod/documents\"\n    }\n  ],\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"Scan\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\"\n    },\n    {\n      \"id\": 2,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#deployment","title":"Deployment","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#queue-assignment","title":"Queue Assignment","text":"<p>Receives messages from <code>jobtmscarrierpod</code> queue.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#kubernetes","title":"Kubernetes","text":"<pre><code>spec:\n  containers:\n    - name: file-job-handler-tms-carrier-pod\n      image: enterprisenonpacr.azurecr.io/enterprise/file-job-handler-tms-carrier-pod:tag\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#dependencies","title":"Dependencies","text":"<ul> <li>FileTransferCommon</li> <li>TMS-specific libraries (if any)</li> <li>PDF processing libraries (if needed)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#monitoring","title":"Monitoring","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#key-metrics","title":"Key Metrics","text":"<ul> <li>POD files processed</li> <li>Shipments confirmed</li> <li>Processing latency</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#alerts","title":"Alerts","text":"<ul> <li>POD validation failures</li> <li>Unmatched shipment references</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-carrier-pod.html#related-documentation","title":"Related Documentation","text":"<ul> <li>FileJobHandler</li> <li>Queue Architecture</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html","title":"FileJobHandler-TMSRoute","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#filejobhandler-tmsroute","title":"FileJobHandler-TMSRoute","text":"<p>Specialized handler for Transportation Management System (TMS) routing files.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#repository","title":"Repository","text":"<p><code>FileJobHandler-TMSRoute/</code></p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#purpose","title":"Purpose","text":"<p>FileJobHandler-TMSRoute processes TMS routing files with domain-specific business logic: - Handles TMS route file formats - Applies routing-specific transformations - Integrates with TMS systems</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#architecture","title":"Architecture","text":"<pre><code>Azure Queue (jobstmsroute)\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FileJobHandler-TMSRoute    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 QueueListener               \u2502\n\u2502 TMSRouteProcessor           \u2502\n\u2502 RouteValidation             \u2502\n\u2502 ActionProcess               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u251c\u2500\u2500\u25b6 TMS Sources\n       \u251c\u2500\u2500\u25b6 Route Destinations\n       \u2514\u2500\u2500\u25b6 TMS Systems\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#input-contract","title":"Input Contract","text":"<p>Queue Message:</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"TMS.Route\",\n  \"subject\": \"File Upload\",\n  \"data\": {\n    \"accountId\": \"TRANSPORT001\",\n    \"fileName\": \"routes/daily/route_20240115.xml\",\n    \"correlationId\": \"route-corr-123\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#output-contract","title":"Output Contract","text":"<p>Processed Route File: - Route data validated and transformed - Delivered to configured destinations - TMS system notified</p> <p>JobStatus Update:</p> <pre><code>{\n  \"Status\": \"Succeeded\",\n  \"Queue\": \"jobstmsroute\",\n  \"Action\": \"TMSRouteProcess\",\n  \"InvalidReason\": \"Route processed successfully\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#business-logic","title":"Business Logic","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#route-validation","title":"Route Validation","text":"<ul> <li>Validates route file structure</li> <li>Checks required route fields</li> <li>Verifies carrier information</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#route-transformation","title":"Route Transformation","text":"<ul> <li>Normalizes route data format</li> <li>Applies business rules</li> <li>Enriches with reference data</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#routing-rule","title":"Routing Rule","text":"<pre><code>PartitionKey: jobstmsroute\nEventType: Succeeded\nEventSource: TMS.Route\nEventSubject: File Upload\nEventAccountID: TRANSPORT001\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#job-configuration","title":"Job Configuration","text":"<pre><code>{\n  \"feedName\": \"tms-route-processing\",\n  \"source\": {\n    \"type\": \"Internal-SFTP\",\n    \"path\": \"{@AppSettings.sftpintroot}/tms/{@Message.accountID}/routes\"\n  },\n  \"destinations\": [\n    {\n      \"id\": 1,\n      \"type\": \"BlobStore\",\n      \"path\": \"tms/processed/routes\"\n    }\n  ],\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#deployment","title":"Deployment","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#queue-assignment","title":"Queue Assignment","text":"<p>Receives messages from <code>jobstmsroute</code> queue.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#kubernetes","title":"Kubernetes","text":"<pre><code>spec:\n  containers:\n    - name: file-job-handler-tms-route\n      image: enterprisenonpacr.azurecr.io/enterprise/file-job-handler-tms-route:tag\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#dependencies","title":"Dependencies","text":"<ul> <li>FileTransferCommon</li> <li>TMS-specific libraries (if any)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#monitoring","title":"Monitoring","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#key-metrics","title":"Key Metrics","text":"<ul> <li>Routes processed per hour</li> <li>Route validation failures</li> <li>Processing latency</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#alerts","title":"Alerts","text":"<ul> <li>Route validation failure rate &gt; threshold</li> <li>Processing queue backlog</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-route.html#related-documentation","title":"Related Documentation","text":"<ul> <li>FileJobHandler</li> <li>Queue Architecture</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html","title":"FileJobHandler-TMSStatus","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#filejobhandler-tmsstatus","title":"FileJobHandler-TMSStatus","text":"<p>Specialized handler for Transportation Management System (TMS) status files.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#repository","title":"Repository","text":"<p><code>FileJobHandler-TMSStatus/</code></p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#purpose","title":"Purpose","text":"<p>FileJobHandler-TMSStatus processes TMS status update files: - Handles shipment status updates - Processes tracking information - Updates TMS systems with delivery status</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#architecture","title":"Architecture","text":"<pre><code>Azure Queue (jobstmsstatus)\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FileJobHandler-TMSStatus   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 QueueListener               \u2502\n\u2502 TMSStatusProcessor          \u2502\n\u2502 StatusValidation            \u2502\n\u2502 ActionProcess               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u251c\u2500\u2500\u25b6 Status Sources\n       \u251c\u2500\u2500\u25b6 Status Destinations\n       \u2514\u2500\u2500\u25b6 TMS Systems\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#input-contract","title":"Input Contract","text":"<p>Queue Message:</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"TMS.Status\",\n  \"subject\": \"Status Update\",\n  \"data\": {\n    \"accountId\": \"TRANSPORT001\",\n    \"fileName\": \"status/shipment_status_20240115.csv\",\n    \"correlationId\": \"status-corr-456\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#output-contract","title":"Output Contract","text":"<p>Processed Status File: - Status records validated - Tracking updates extracted - Delivered to TMS systems</p> <p>JobStatus Update:</p> <pre><code>{\n  \"Status\": \"Succeeded\",\n  \"Queue\": \"jobstmsstatus\",\n  \"Action\": \"TMSStatusProcess\",\n  \"InvalidReason\": \"Status processed successfully\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#business-logic","title":"Business Logic","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#status-validation","title":"Status Validation","text":"<ul> <li>Validates status file format</li> <li>Checks shipment references</li> <li>Verifies status codes</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#status-processing","title":"Status Processing","text":"<ul> <li>Parses status records</li> <li>Maps to standard status codes</li> <li>Prepares update payloads</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#routing-rule","title":"Routing Rule","text":"<pre><code>PartitionKey: jobstmsstatus\nEventType: Succeeded\nEventSource: TMS.Status\nEventSubject: Status Update\nEventAccountID: TRANSPORT001\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#job-configuration","title":"Job Configuration","text":"<pre><code>{\n  \"feedName\": \"tms-status-processing\",\n  \"source\": {\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.carrier.com\",\n    \"path\": \"/status/outbound\"\n  },\n  \"destinations\": [\n    {\n      \"id\": 1,\n      \"type\": \"BlobStore\",\n      \"path\": \"tms/status/processed\"\n    }\n  ],\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#deployment","title":"Deployment","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#queue-assignment","title":"Queue Assignment","text":"<p>Receives messages from <code>jobstmsstatus</code> queue.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#kubernetes","title":"Kubernetes","text":"<pre><code>spec:\n  containers:\n    - name: file-job-handler-tms-status\n      image: enterprisenonpacr.azurecr.io/enterprise/file-job-handler-tms-status:tag\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#dependencies","title":"Dependencies","text":"<ul> <li>FileTransferCommon</li> <li>TMS-specific libraries (if any)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#monitoring","title":"Monitoring","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#key-metrics","title":"Key Metrics","text":"<ul> <li>Status files processed</li> <li>Shipment updates applied</li> <li>Processing latency</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#alerts","title":"Alerts","text":"<ul> <li>Status processing failures</li> <li>Invalid status format rate</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler-tms-status.html#related-documentation","title":"Related Documentation","text":"<ul> <li>FileJobHandler</li> <li>Queue Architecture</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html","title":"FileJobHandler","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#filejobhandler","title":"FileJobHandler","text":"<p>Generic job processing handler that executes file transfer operations based on job configurations.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#repository","title":"Repository","text":"<p><code>FileJobHandler/</code></p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#purpose","title":"Purpose","text":"<p>FileJobHandler is the primary workhorse of FTS: - Polls Azure Queue for job messages - Loads job configurations from file share - Executes action sequences - Updates job status</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#architecture","title":"Architecture","text":"<pre><code>Azure Queue (jobs)\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    FileJobHandler       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 QueueListener           \u2502 \u25c4\u2500\u2500 Polls queue\n\u2502 JobProcessor            \u2502 \u25c4\u2500\u2500 Orchestrates job\n\u2502 SettingConfiguration    \u2502 \u25c4\u2500\u2500 Loads config\n\u2502 ActionProcess           \u2502 \u25c4\u2500\u2500 Executes actions\n\u2502 Server Implementations  \u2502 \u25c4\u2500\u2500 File operations\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u251c\u2500\u2500\u25b6 Sources (SFTP, Blob, S3, GCP, etc.)\n       \u251c\u2500\u2500\u25b6 Destinations (SFTP, Blob, FTP, etc.)\n       \u2514\u2500\u2500\u25b6 Azure Table (status updates)\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#core-components","title":"Core Components","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#queuelistener","title":"QueueListener","text":"<p>Polls the queue for new messages.</p> <pre><code>public class QueueListener\n{\n    public async Task StartListening();\n    public async Task&lt;QueueMessage&gt; GetNextMessage();\n    public async Task DeleteMessage(QueueMessage message);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#jobprocessor","title":"JobProcessor","text":"<p>Orchestrates job execution.</p> <pre><code>public class JobProcessor\n{\n    public async Task&lt;bool&gt; ProcessJob(Notification notification);\n    private ConfigModel LoadConfiguration(string source, string accountId, string fileName);\n    private bool ExecuteActions(ConfigModel config, CurrentMessageInfo context);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#settingconfiguration","title":"SettingConfiguration","text":"<p>Manages configuration loading and placeholder resolution.</p> <pre><code>public class SettingConfiguration\n{\n    public ConfigModel LoadJobSettings(string folderPath);\n    public Dictionary&lt;string, string&gt; LoadJobSecrets(string folderPath);\n    public string ResolvePlaceholders(string value, CurrentMessageInfo context);\n    public int FindNumberToDirect(string pattern, string regex, string messageId);\n    public string FindSecretValue(string placeholder, CurrentMessageInfo context);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#actionprocess","title":"ActionProcess","text":"<p>Executes individual actions.</p> <pre><code>public class ActionProcess : IActionProcess\n{\n    public bool Action(ConfigModel.Actions action, out string invalidReason);\n\n    private bool ReadFile(Actions action, out string invalidReason);\n    private bool WriteFile(Actions action, out string invalidReason);\n    private bool DeleteFile(Actions action, out string invalidReason);\n    private bool RenameFile(Actions action, out string invalidReason);\n    private bool GetFileList(Actions action, out string invalidReason);\n    private bool ZipFileList(Actions action, out string invalidReason);\n    private bool ConcatenateList(Actions action, out string invalidReason);\n    private bool DeleteFileList(Actions action, out string invalidReason);\n    private bool PGP_Decryption(Actions action, out string invalidReason);\n    private bool PGP_Encryption(Actions action, out string invalidReason);\n    private bool RSA_Encryption(Actions action, out string invalidReason);\n    private bool Scan(Actions action, out string invalidReason);\n    private bool Encoding(Actions action, out string invalidReason);\n    private bool FireEvent(Actions action, out string invalidReason);\n    private bool FireEventList(Actions action, out string invalidReason);\n    private bool NotifyServer(Actions action, out string invalidReason);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#message-flow","title":"Message Flow","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#input-contract","title":"Input Contract","text":"<p>Queue Message (CloudEvent):</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"FTP.File.ExternalService\",\n  \"subject\": \"File Upload\",\n  \"data\": {\n    \"accountId\": \"ACCOUNT001\",\n    \"fileName\": \"incoming/data.csv\",\n    \"correlationId\": \"corr-123\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#output-contract","title":"Output Contract","text":"<p>JobStatus Update:</p> <pre><code>{\n  \"Status\": \"Succeeded\",\n  \"InvalidReason\": \"File Successfully write to destination\",\n  \"Action\": \"WriteFile\"\n}\n</code></pre> <p>FireEvent Output (new CloudEvent):</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"FTS.JobHandler\",\n  \"subject\": \"File Ready\",\n  \"data\": {\n    \"accountId\": \"ACCOUNT001\",\n    \"fileName\": \"processed/data.csv\",\n    \"correlationId\": \"corr-123\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#job-processing-flow","title":"Job Processing Flow","text":"<pre><code>1. Dequeue Message\n       \u2502\n       \u25bc\n2. Parse CloudEvent\n       \u2502\n       \u25bc\n3. Build Configuration Path\n   /mnt/jobconfig/{source}/{accountID}/{subFolder}/\n       \u2502\n       \u25bc\n4. Load jobsettings.json\n       \u2502\n       \u25bc\n5. Load jobsecrets.json (if needed)\n       \u2502\n       \u25bc\n6. Resolve Placeholders\n       \u2502\n       \u25bc\n7. Execute Actions (sequentially)\n   \u250c\u2500\u25ba ReadFile\n   \u2502      \u2502\n   \u2502      \u25bc\n   \u2502   PGP-Decrypt\n   \u2502      \u2502\n   \u2502      \u25bc\n   \u2502   Scan\n   \u2502      \u2502\n   \u2502      \u25bc\n   \u2502   WriteFile\n   \u2502      \u2502\n   \u2502      \u25bc\n   \u2514\u2500\u2500 DeleteFile\n       \u2502\n       \u25bc\n8. Update JobStatus (Succeeded/Failed)\n       \u2502\n       \u25bc\n9. Delete Queue Message\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#server-selection","title":"Server Selection","text":"<p>The handler instantiates appropriate server class based on type:</p> <pre><code>if (source.type == \"Internal-SFTP\")\n    Server = new InternalSFTPServer(currentMessageInfo);\nelse if (source.type == \"External-SFTP\")\n    Server = new ExternalSFTPServer(currentMessageInfo);\nelse if (source.type == \"Vendor-SFTP\")\n    Server = new VendorSFTPServer(currentMessageInfo);\nelse if (source.type == \"Vendor-FTP\")\n    Server = new VendorFTPServer(currentMessageInfo);\nelse if (source.type == \"BlobStore\")\n    Server = new BlobStoreServer(currentMessageInfo);\nelse if (source.type == \"GCP\")\n    Server = new GCPServer(currentMessageInfo);\nelse if (source.type == \"AmazonS3\")\n    Server = new AmazonS3Server(currentMessageInfo);\nelse if (source.type == \"Internal-APIM\")\n    Server = new Internal_APIM(currentMessageInfo);\nelse if (source.type == \"AzureFile-API\")\n    Server = new AzureFile_API(currentMessageInfo);\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#retry-logic","title":"Retry Logic","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#source-operations","title":"Source Operations","text":"<pre><code>for (int i = 1; i &lt;= RetryFailureSource; i++)\n{\n    Thread.Sleep(RetryFailureSourceDelay * 1000);\n    Result = Server.ReadFile(action, ref reason);\n    if (Result) break;\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#destination-operations","title":"Destination Operations","text":"<pre><code>for (int i = 1; i &lt;= RetryFailureDestination; i++)\n{\n    Thread.Sleep(RetryFailureDestinationDelay * 1000);\n    Result = Server.WriteFile(action, destination, content, ref reason);\n    if (Result) break;\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#configuration","title":"Configuration","text":"<pre><code>{\n  \"Actions\": {\n    \"RetryFailureSource\": 3,\n    \"RetryFailureDestination\": 3,\n    \"RetryFailureSourceDelay\": 5,\n    \"RetryFailureDestinationDelay\": 5\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#configuration_1","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#appsettingsjson","title":"appsettings.json","text":"<pre><code>{\n  \"Queues\": {\n    \"jobs\": {\n      \"Url\": \"https://{storage}.queue.core.windows.net/jobs\",\n      \"SASToken\": \"...\"\n    },\n    \"NextCheck\": 1000,\n    \"VisibilityTimeout\": 120\n  },\n  \"AzureFiles\": {\n    \"sftpintroot\": \"/mnt/sftpintroot\",\n    \"sftpextroot\": \"/mnt/sftpextroot\",\n    \"jobsettingsfolder\": \"/mnt/jobconfig/{@Message.source}/{@Message.accountID}/{@Message.fileName.subFolder}\"\n  },\n  \"VirusScan\": {\n    \"ClamAVServiceIP\": \"10.21.129.142\",\n    \"ClamAVServicePort\": \"3310\"\n  },\n  \"KeyVaultSecrets\": {\n    \"Enable\": true,\n    \"Uri\": \"https://fts-{env}-key-vault.vault.azure.net/\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#deployment","title":"Deployment","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#kubernetes","title":"Kubernetes","text":"<pre><code>spec:\n  containers:\n    - name: file-job-handler\n      image: enterprisenonpacr.azurecr.io/enterprise/file-job-handler:tag\n      volumeMounts:\n        - name: appsettings\n          mountPath: /app/appsettings.Production.json\n        - name: sftpintroot\n          mountPath: /mnt/sftpintroot\n        - name: sftpextroot\n          mountPath: /mnt/sftpextroot\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#volumes","title":"Volumes","text":"Mount Purpose <code>/mnt/sftpintroot</code> Internal SFTP files <code>/mnt/sftpextroot</code> External SFTP files <code>/mnt/jobconfig</code> Job configuration files"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#error-handling","title":"Error Handling","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#configuration-errors","title":"Configuration Errors","text":"<ul> <li>Missing <code>jobsettings.json</code>: Job fails immediately</li> <li>Invalid JSON: Job fails with parse error</li> <li>Missing secrets: Job fails with resolution error</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#action-errors","title":"Action Errors","text":"<ul> <li>Read failure: Retry, then fail job</li> <li>Write failure: Retry, then fail job</li> <li>Virus detected: Fail job with virus details</li> <li>Encryption error: Fail job with error message</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#dependencies","title":"Dependencies","text":"<ul> <li>FileTransferCommon</li> <li>Azure.Storage.Queues</li> <li>Azure.Storage.Blobs</li> <li>Microsoft.Azure.Cosmos.Table</li> <li>SSH.NET</li> <li>FluentFTP</li> <li>BouncyCastle</li> <li>Google.Cloud.Storage.V1</li> <li>AWSSDK.S3</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#monitoring","title":"Monitoring","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#datadog-apm","title":"Datadog APM","text":"<ul> <li>Job processing duration</li> <li>Action execution times</li> <li>Success/failure rates</li> <li>Retry counts</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#nlog","title":"NLog","text":"<pre><code>Logger.Info($\"Start ActionProcess Action method ActionID={action.id}, ActionType={action.type}\");\nLogger.Error(ex, $\"Action failed. MessageId={messageId}\");\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-job-handler.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job ConfigModel</li> <li>Action Types</li> <li>Jobsettings Storage</li> <li>Multi-Cloud Storage</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html","title":"FileTransferCommon","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#filetransfercommon","title":"FileTransferCommon","text":"<p>Shared library providing common interfaces, models, and utilities used across all FTS components.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#repository","title":"Repository","text":"<p><code>FileTransferCommon/</code></p>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#purpose","title":"Purpose","text":"<p>FileTransferCommon is the foundation library that provides: - Common interfaces for server operations - Shared data models - Azure service helpers - Cryptographic utilities - Logging infrastructure</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#key-interfaces","title":"Key Interfaces","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#iserversreadwrite","title":"IServersReadWrite","text":"<p>Primary interface for all server implementations.</p> <pre><code>public interface IServersReadWrite\n{\n    bool ReadFile(Actions action, ref string invalidReason);\n    bool WriteFile(Actions action, int destinationNumber, byte[] content, ref string invalidReason);\n    bool DeleteFile(Actions action, ref string invalidReason);\n    bool RenameFile(Actions action, int destinationNumber, ref string invalidReason);\n    bool RenameFileSource(Actions action, ref string invalidReason);\n    bool GetFileList(Actions action, ref string invalidReason);\n    bool ZipFileList(Actions action, int actionNumberSource, ref string invalidReason);\n    bool ConcatenateList(Actions action, int actionNumberSource, ref string invalidReason);\n    bool DeleteFileList(Actions action, int actionNumberSource, ref string invalidReason);\n    string GetEventFileName(Actions action, int destinationNumber, byte[] content, ref string invalidReason);\n\n    int TryTimesRead { get; set; }\n    int TryTimesWrite { get; set; }\n    int TryTimesDelete { get; set; }\n    int TryTimesRename { get; set; }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#iactionprocess","title":"IActionProcess","text":"<p>Interface for action processing pipeline.</p> <pre><code>public interface IActionProcess\n{\n    bool Action(Actions action, out string invalidReason);\n    CurrentMessageInfo currentMessageInfo { get; set; }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#ivirusscan","title":"IVirusScan","text":"<p>Interface for virus scanning service.</p> <pre><code>public interface IVirusScan\n{\n    string VirusScanBytes(byte[] content);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#data-models","title":"Data Models","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#notification","title":"Notification","text":"<p>CloudEvents notification model used throughout the system.</p> <pre><code>public class Notification\n{\n    public string specversion { get; set; }\n    public string type { get; set; }\n    public string source { get; set; }\n    public string subject { get; set; }\n    public string id { get; set; }\n    public string time { get; set; }\n    public string dataschema { get; set; }\n    public DataInfo data { get; set; }\n}\n</code></pre> <p>See Notification Model for details.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#currentmessageinfo","title":"CurrentMessageInfo","text":"<p>Runtime context carrying message and configuration information.</p> <pre><code>public class CurrentMessageInfo\n{\n    public string MessageId { get; set; }\n    public ConfigModel configModel { get; set; }\n    public string AzureFile { get; set; }\n    public string AzureFileToUpload { get; set; }\n    public string AzureTargetFileToUpload { get; set; }\n    public string sftpintroot { get; set; }\n    public string sftpextroot { get; set; }\n    public string jobsettingsfolder { get; set; }\n    // ... additional context fields\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#azure-service-helpers","title":"Azure Service Helpers","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#queuehelper","title":"QueueHelper","text":"<p>Azure Queue Storage operations.</p> <pre><code>public class QueueHelper\n{\n    public async Task&lt;bool&gt; SendMessage(string message);\n    public async Task&lt;string&gt; GetMessage();\n    public async Task&lt;bool&gt; DeleteMessage(string messageId, string popReceipt);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#tablehelper","title":"TableHelper","text":"<p>Azure Table Storage operations.</p> <pre><code>public class TableHelper\n{\n    public List&lt;T&gt; GetEntities&lt;T&gt;() where T : TableEntity, new();\n    public async Task&lt;bool&gt; InsertOrMerge&lt;T&gt;(T entity) where T : TableEntity;\n    public string SearchConfigTable(string accountId, string source, string type, string subject, string offsetId);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#blobstoreserver","title":"BlobStoreServer","text":"<p>Azure Blob Storage operations implementing <code>IServersReadWrite</code>.</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#cryptographic-utilities","title":"Cryptographic Utilities","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#pgpstream","title":"PgpStream","text":"<p>PGP encryption and decryption using BouncyCastle.</p> <pre><code>public static class PgpStream\n{\n    public static byte[] Decrypt(byte[] encryptedData, Stream privateKeyStream, string passPhrase);\n    public static byte[] Encrypt(byte[] clearData, byte[] publicKey, bool armor, bool integrity,\n                                  SymmetricKeyAlgorithmTag algorithm, CompressionAlgorithmTag compression,\n                                  string fileName, bool useSubkey);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#virusscan","title":"VirusScan","text":"<p>ClamAV integration for virus scanning.</p> <pre><code>public class VirusScan : IVirusScan\n{\n    public VirusScan(string serverIp, string serverPort);\n    public string VirusScanBytes(byte[] content);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#logging","title":"Logging","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#logger","title":"Logger","text":"<p>NLog-based logging wrapper.</p> <pre><code>public static class Logger\n{\n    public static void Info(string message);\n    public static void Warning(string message);\n    public static void Error(string message);\n    public static void Error(Exception ex, string message = null);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#server-implementations","title":"Server Implementations","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#accesstoservers","title":"AccessToServers","text":"<p>Base class for all server implementations.</p> <pre><code>public class AccessToServers : IServersReadWrite\n{\n    protected CurrentMessageInfo currentMessageInfo;\n\n    public string ReplaceFileName(string path, bool removeBackSlash);\n    public string ReplaceDateTime(string value);\n    protected string GetDestinationPath(Actions action, int destinationNumber);\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#server-classes","title":"Server Classes","text":"Class Type Description <code>InternalSFTPServer</code> Internal-SFTP Azure File Share mount <code>ExternalSFTPServer</code> External-SFTP Azure File Share mount <code>VendorSFTPServer</code> Vendor-SFTP Remote SFTP via SSH.NET <code>VendorFTPServer</code> Vendor-FTP Remote FTP via FluentFTP <code>BlobStoreServer</code> BlobStore Azure Blob Storage <code>GCPServer</code> GCP Google Cloud Storage <code>AmazonS3Server</code> AmazonS3 Amazon S3 <code>Internal_APIM</code> Internal-APIM Azure API Management <code>AzureFile_API</code> AzureFile-API Azure File Share API"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#appconfiguration","title":"AppConfiguration","text":"<p>Static configuration loaded from appsettings.json.</p> <pre><code>public static class AppConfiguration\n{\n    // Queue configuration\n    public static string FixQueuesName_Jobs;\n    public static string FixQueuesName_Jobstmsroute;\n    // ... more queue names\n\n    // Action types\n    public static string Actions_Types_ReadFile;\n    public static string Actions_Types_WriteFile;\n    // ... more action types\n\n    // Source types\n    public static string Actions_SourceTypes_Internal_Type;\n    public static string Actions_SourceTypes_Vendor_SFTP;\n    // ... more source types\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#dependencies","title":"Dependencies","text":"<ul> <li>Azure.Storage.Blobs: Azure Blob Storage SDK</li> <li>Azure.Storage.Queues: Azure Queue Storage SDK</li> <li>Microsoft.Azure.Cosmos.Table: Azure Table Storage SDK</li> <li>SSH.NET: SFTP client library</li> <li>FluentFTP: FTP client library</li> <li>BouncyCastle: Cryptography library</li> <li>NLog: Logging framework</li> <li>Newtonsoft.Json: JSON serialization</li> <li>Google.Cloud.Storage.V1: GCP Storage SDK</li> <li>AWSSDK.S3: AWS S3 SDK</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#build-output","title":"Build Output","text":"<p>Assembly: <code>FileTransferCommon.dll</code></p> <p>NuGet Package: Published to internal Azure Artifacts feed</p>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#usage","title":"Usage","text":"<p>All FTS handlers reference FileTransferCommon:</p> <pre><code>&lt;PackageReference Include=\"FileTransferCommon\" Version=\"1.0.0\" /&gt;\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/components/file-transfer-common.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Multi-Cloud Storage</li> <li>Notification Model</li> <li>Source/Destination Types</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html","title":"Credentials Model","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#credentials-model","title":"Credentials Model","text":"<p>The Credentials class defines authentication configuration for source and destination servers in job configurations.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#source-file","title":"Source File","text":"<p><code>FileJobHandler/FileJobHandler.Service/Model/ConfigModel.cs</code> (nested class)</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#schema","title":"Schema","text":"<pre><code>public class Credentials\n{\n    public string type { get; set; }\n    public string username { get; set; }\n    public string password { get; set; }\n    public string sshkey { get; set; }\n    public string containerName { get; set; }\n    public string sasToken { get; set; }\n    public string usernameValue { get; set; }\n    public string passwordValue { get; set; }\n    public string sshkeyValue { get; set; }\n    public string sshkeyContent { get; set; }\n    public string connectionString { get; set; }\n    public string shareName { get; set; }\n    public string OAuthScope { get; set; }\n    public string privateKey { get; set; }\n    public string accessKey { get; set; }\n    public string secretKey { get; set; }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#property-reference","title":"Property Reference","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#authentication-type","title":"Authentication Type","text":"Property Type Description <code>type</code> string Authentication method: <code>BasicAuth</code>, <code>SSHKey</code>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#usernamepassword-authentication","title":"Username/Password Authentication","text":"Property Type Description <code>username</code> string Username (supports placeholders) <code>password</code> string Password (supports placeholders) <code>usernameValue</code> string Resolved username value <code>passwordValue</code> string Resolved password value"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#ssh-key-authentication","title":"SSH Key Authentication","text":"Property Type Description <code>sshkey</code> string Path to SSH key file <code>sshkeyValue</code> string Resolved SSH key content <code>sshkeyContent</code> string Alternative SSH key content field"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#azure-blob-storage","title":"Azure Blob Storage","text":"Property Type Description <code>containerName</code> string Blob container name <code>connectionString</code> string Storage connection string <code>sasToken</code> string SAS token for authentication"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#azure-file-share","title":"Azure File Share","text":"Property Type Description <code>shareName</code> string File share name <code>connectionString</code> string Storage connection string"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#azure-api-management","title":"Azure API Management","text":"Property Type Description <code>OAuthScope</code> string OAuth 2.0 scope for token requests"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#google-cloud-platform","title":"Google Cloud Platform","text":"Property Type Description <code>privateKey</code> string GCP service account private key"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#amazon-s3","title":"Amazon S3","text":"Property Type Description <code>accessKey</code> string AWS access key ID <code>secretKey</code> string AWS secret access key"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#credential-types-by-server-type","title":"Credential Types by Server Type","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#vendor-sftp-external-sftp","title":"Vendor-SFTP / External-SFTP","text":"<p>BasicAuth:</p> <pre><code>{\n  \"credentials\": {\n    \"type\": \"BasicAuth\",\n    \"username\": \"{@JobSecrets.sftpUser}\",\n    \"password\": \"{@JobSecrets.sftpPass}\"\n  }\n}\n</code></pre> <p>SSHKey:</p> <pre><code>{\n  \"credentials\": {\n    \"type\": \"SSHKey\",\n    \"username\": \"{@JobSecrets.sftpUser}\",\n    \"sshkey\": \"{@AppSettings.jobsettingsfolder}/id_rsa\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#vendor-ftp","title":"Vendor-FTP","text":"<pre><code>{\n  \"credentials\": {\n    \"username\": \"{@JobSecrets.ftpUser}\",\n    \"password\": \"{@JobSecrets.ftpPass}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#blobstore","title":"BlobStore","text":"<p>Connection String:</p> <pre><code>{\n  \"credentials\": {\n    \"containerName\": \"files\",\n    \"connectionString\": \"{@JobSecrets.blobConnection}\"\n  }\n}\n</code></pre> <p>SAS Token:</p> <pre><code>{\n  \"credentials\": {\n    \"containerName\": \"files\",\n    \"sasToken\": \"{@JobSecrets.blobSasToken}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#azurefile-api","title":"AzureFile-API","text":"<pre><code>{\n  \"credentials\": {\n    \"shareName\": \"fileshare\",\n    \"connectionString\": \"{@JobSecrets.fileShareConnection}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#internal-apim","title":"Internal-APIM","text":"<pre><code>{\n  \"credentials\": {\n    \"OAuthScope\": \"api://my-api/.default\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#gcp","title":"GCP","text":"<pre><code>{\n  \"credentials\": {\n    \"privateKey\": \"{@JobSecrets.gcpPrivateKey}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#amazons3","title":"AmazonS3","text":"<pre><code>{\n  \"credentials\": {\n    \"accessKey\": \"{@JobSecrets.s3AccessKey}\",\n    \"secretKey\": \"{@JobSecrets.s3SecretKey}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#security-best-practices","title":"Security Best Practices","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#use-job-secrets","title":"Use Job Secrets","text":"<p>Always reference credentials through <code>jobsecrets.json</code>:</p> <pre><code>// jobsettings.json\n{\n  \"credentials\": {\n    \"username\": \"{@JobSecrets.vendorUser}\",\n    \"password\": \"{@JobSecrets.vendorPass}\"\n  }\n}\n\n// jobsecrets.json\n{\n  \"vendorUser\": \"actual-username\",\n  \"vendorPass\": \"actual-password\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#use-key-vault","title":"Use Key Vault","text":"<p>For production, use Azure Key Vault via the <code>jobsecret</code> field in the root configuration:</p> <pre><code>{\n  \"feedName\": \"secure-feed\",\n  \"jobsecret\": \"vendor-secrets\",\n  \"source\": {\n    \"credentials\": {\n      \"password\": \"{@JobSecrets.vendorPass}\"\n    }\n  }\n}\n</code></pre> <p>The <code>jobsecret</code> field references a Key Vault secret name. The secret value must be a JSON object:</p> <pre><code>{\n  \"vendorUser\": \"actual-username\",\n  \"vendorPass\": \"actual-password\"\n}\n</code></pre> <p>Note: The <code>{@KeyVault.*}</code> placeholder syntax is NOT supported. Always use <code>{@JobSecrets.*}</code> with the <code>jobsecret</code> field for Key Vault integration.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#ssh-key-storage","title":"SSH Key Storage","text":"<p>Store SSH keys in the job configuration folder:</p> <pre><code>/mnt/jobconfig/{source}/{accountID}/{folder}/\n\u251c\u2500\u2500 jobsettings.json\n\u251c\u2500\u2500 jobsecrets.json\n\u2514\u2500\u2500 id_rsa           # SSH private key\n</code></pre> <p>Reference in configuration:</p> <pre><code>{\n  \"credentials\": {\n    \"type\": \"SSHKey\",\n    \"username\": \"sftp-user\",\n    \"sshkey\": \"{@AppSettings.jobsettingsfolder}/id_rsa\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#credential-resolution-flow","title":"Credential Resolution Flow","text":"<ol> <li>Placeholder Detection: System identifies <code>{@JobSecrets.xxx}</code> patterns</li> <li>Secrets File Load: <code>jobsecrets.json</code> loaded from same directory</li> <li>Value Substitution: Placeholders replaced with actual values</li> <li>Key Vault Fallback: If file not found, check Azure Key Vault</li> <li>Credential Usage: Resolved values used for authentication</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#validation-rules","title":"Validation Rules","text":"<p>The system validates credentials based on server type:</p> Server Type Required Credentials <code>Vendor-SFTP</code> (BasicAuth) <code>username</code>, <code>password</code> <code>Vendor-SFTP</code> (SSHKey) <code>username</code>, <code>sshkey</code> <code>Vendor-FTP</code> <code>username</code>, <code>password</code> <code>BlobStore</code> <code>containerName</code>, <code>connectionString</code> or <code>sasToken</code> <code>AzureFile-API</code> <code>shareName</code>, <code>connectionString</code> <code>Internal-APIM</code> <code>OAuthScope</code> <code>GCP</code> <code>privateKey</code> <code>AmazonS3</code> <code>accessKey</code>, <code>secretKey</code>"},{"location":"enterprise-services/file-transfer-solution/data-models/credentials-model.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job ConfigModel</li> <li>Source/Destination Types</li> <li>Security &amp; Secrets</li> <li>Placeholders Reference</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html","title":"Job ConfigModel","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#job-configmodel","title":"Job ConfigModel","text":"<p>The Job ConfigModel defines the structure of job configuration files (<code>jobsettings.json</code>) that specify file transfer operations.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#source-file","title":"Source File","text":"<p><code>FileJobHandler/FileJobHandler.Service/Model/ConfigModel.cs</code></p>"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#schema-overview","title":"Schema Overview","text":"<pre><code>ConfigModel\n\u251c\u2500\u2500 feedName: string (required)\n\u251c\u2500\u2500 version: string\n\u251c\u2500\u2500 jobsecret: string\n\u251c\u2500\u2500 source: ServersAttributes\n\u2502   \u251c\u2500\u2500 name, type, host, port, path\n\u2502   \u251c\u2500\u2500 ssl: bool? (default: false)\n\u2502   \u251c\u2500\u2500 endpoint (BlobStore)\n\u2502   \u251c\u2500\u2500 bucketName (Google, S3)\n\u2502   \u251c\u2500\u2500 GCP fields: servicetype, projectID, privateKeyID, clientEmail,\n\u2502   \u2502   clientID, authUri, tokenUri, authProvider, clientCertUrl, universeDomain\n\u2502   \u251c\u2500\u2500 S3 fields: region\n\u2502   \u251c\u2500\u2500 APIM fields: TargetUrl, TimeoutMs, RepeatAPI\n\u2502   \u2514\u2500\u2500 credentials: Credentials\n\u251c\u2500\u2500 destinations[]: Destinations (extends ServersAttributes)\n\u2502   \u251c\u2500\u2500 id: int\n\u2502   \u2514\u2500\u2500 removeFirstBackSlash: int? (Readnet specific)\n\u2514\u2500\u2500 actions[]: Actions\n    \u251c\u2500\u2500 id, type, sourceFile, outputStream, outputFile\n    \u251c\u2500\u2500 keyFile, keypassword, sourceStream, source, target\n    \u251c\u2500\u2500 destination: int\n    \u251c\u2500\u2500 FireEvent fields: eventType, eventSource, eventSubject, eventAccountId,\n    \u2502   eventId, eventCorrelationId, eventFileName\n    \u251c\u2500\u2500 Encryption fields: encryptArmor, encryptIntegirity, encryptSymmetricKey,\n    \u2502   encryptCompressed, encryptFilename, encryptSubkey\n    \u251c\u2500\u2500 FileList fields: listFileNames, pathlistFile, startWith, endWith,\n    \u2502   concateWith, numberOfFiles, listConcateFileNames\n    \u251c\u2500\u2500 sort: string\n    \u2514\u2500\u2500 ActualOutPutStream: byte[] (runtime only)\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#root-properties","title":"Root Properties","text":"Property Type Required Description <code>feedName</code> string Yes Job/feed identifier <code>version</code> string No Configuration version <code>jobsecret</code> string No Reference to secrets file <code>source</code> ServersAttributes Yes Source server configuration <code>destinations</code> Destinations[] Yes Array of destination configurations <code>actions</code> Actions[] Yes Array of actions to execute"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#serversattributes","title":"ServersAttributes","text":"<p>Base class for source and destination configuration.</p> Property Type Default Description <code>name</code> string Server display name <code>type</code> string Server type (see Source/Destination Types) <code>host</code> string Server hostname <code>port</code> string Server port <code>path</code> string Base path on server <code>ssl</code> bool? false Enable SSL/TLS <code>endpoint</code> string BlobStore endpoint URL <code>bucketName</code> string GCP/S3 bucket name <code>credentials</code> Credentials Authentication credentials"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#gcp-specific-fields","title":"GCP-Specific Fields","text":"Property Type Description <code>servicetype</code> string Service type (e.g., \"service_account\") <code>projectID</code> string GCP project identifier <code>privateKeyID</code> string Private key identifier <code>clientEmail</code> string Service account email <code>clientID</code> string Client identifier <code>authUri</code> string OAuth authorization URI <code>tokenUri</code> string OAuth token URI <code>authProvider</code> string Auth provider certificate URL <code>clientCertUrl</code> string Client certificate URL <code>universeDomain</code> string Universe domain (default: googleapis.com)"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#s3-specific-fields","title":"S3-Specific Fields","text":"Property Type Description <code>region</code> string AWS region (e.g., \"us-east-1\")"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#apim-specific-fields","title":"APIM-Specific Fields","text":"Property Type Description <code>TargetUrl</code> string API endpoint URL <code>TimeoutMs</code> string Request timeout in milliseconds <code>RepeatAPI</code> string Number of retry attempts"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#destinations","title":"Destinations","text":"<p>Extends ServersAttributes with additional properties.</p> Property Type Description <code>id</code> int Destination identifier (referenced by actions) <code>removeFirstBackSlash</code> int? Readnet-specific: remove leading backslash"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#credentials","title":"Credentials","text":"<p>Authentication configuration.</p> Property Type Description <code>type</code> string Auth type: <code>BasicAuth</code>, <code>SSHKey</code> <code>username</code> string Username <code>password</code> string Password <code>sshkey</code> string SSH key file path <code>sshkeyValue</code> string SSH key content (inline) <code>sshkeyContent</code> string SSH key content (alternative) <code>usernameValue</code> string Username from secrets <code>passwordValue</code> string Password from secrets <code>containerName</code> string BlobStore container name <code>sasToken</code> string SAS token <code>connectionString</code> string Connection string <code>shareName</code> string Azure File Share name <code>OAuthScope</code> string OAuth scope for APIM <code>privateKey</code> string GCP private key <code>accessKey</code> string S3 access key <code>secretKey</code> string S3 secret key"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#actions","title":"Actions","text":"<p>Action configuration for job execution.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#common-properties","title":"Common Properties","text":"Property Type Description <code>id</code> int Action identifier (execution order) <code>type</code> string Action type (see Action Types) <code>sourceFile</code> string Source file path <code>sourceStream</code> string Reference to previous action output <code>outputStream</code> string Output identifier for chaining <code>outputFile</code> string Output file path <code>destination</code> int Destination ID for write operations"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#fireevent-properties","title":"FireEvent Properties","text":"Property Type Description <code>eventType</code> string Event type to emit <code>eventSource</code> string Event source identifier <code>eventSubject</code> string Event subject <code>eventAccountId</code> string Target account ID <code>eventId</code> string Event ID (or auto-generated) <code>eventCorrelationId</code> string Correlation ID <code>eventFileName</code> string Filename for event"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#encryption-properties","title":"Encryption Properties","text":"Property Type Default Description <code>keyFile</code> string Path to encryption key file <code>keypassword</code> string Key password (from secrets) <code>encryptArmor</code> bool true ASCII armor output <code>encryptIntegirity</code> bool true Include integrity check <code>encryptSymmetricKey</code> string \"Cast5\" Symmetric algorithm <code>encryptCompressed</code> string \"Uncompressed\" Compression algorithm <code>encryptFilename</code> string \"\" Encrypted filename <code>encryptSubkey</code> bool false Use subkey for encryption"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#file-list-properties","title":"File List Properties","text":"Property Type Default Description <code>listFileNames</code> List\\&lt;string&gt; List of files to process <code>pathlistFile</code> string Path to file list <code>startWith</code> string Filter: filename starts with <code>endWith</code> string Filter: filename ends with <code>concateWith</code> string Concatenation delimiter <code>numberOfFiles</code> int 1 Max files to process <code>listConcateFileNames</code> List\\&lt;string&gt; Concatenated file list <code>sort</code> string Sort order for file list"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#runtime-properties","title":"Runtime Properties","text":"Property Type Description <code>ActualOutPutStream</code> byte[] Runtime: processed file content (do not serialize)"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#example-configuration","title":"Example Configuration","text":"<pre><code>{\n  \"feedName\": \"vendor-data-import\",\n  \"version\": \"1.0\",\n  \"source\": {\n    \"name\": \"Vendor SFTP\",\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.vendor.com\",\n    \"port\": \"22\",\n    \"path\": \"/outbound\",\n    \"credentials\": {\n      \"type\": \"BasicAuth\",\n      \"username\": \"{@JobSecrets.vendorUser}\",\n      \"password\": \"{@JobSecrets.vendorPass}\"\n    }\n  },\n  \"destinations\": [\n    {\n      \"id\": 1,\n      \"name\": \"Internal Storage\",\n      \"type\": \"BlobStore\",\n      \"endpoint\": \"https://storage.blob.core.windows.net\",\n      \"credentials\": {\n        \"containerName\": \"imports\",\n        \"connectionString\": \"{@JobSecrets.blobConnection}\"\n      }\n    }\n  ],\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"PGP-Decrypt\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"keyFile\": \"{@AppSettings.jobsettingsfolder}/private.key\",\n      \"keypassword\": \"{@JobSecrets.pgpPassword}\"\n    },\n    {\n      \"id\": 2,\n      \"type\": \"Scan\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\"\n    },\n    {\n      \"id\": 3,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.2.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/processed/{@Message.fileName.name}.csv\"\n    },\n    {\n      \"id\": 4,\n      \"type\": \"DeleteFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/job-config-model.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job Configuration Specification</li> <li>Source/Destination Types</li> <li>Action Types</li> <li>Placeholders Reference</li> <li>Credentials Model</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html","title":"JobStatus Model","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#jobstatus-model","title":"JobStatus Model","text":"<p>The JobStatus model represents Azure Table entities that track the processing status of all jobs in the FTS platform.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#source-file","title":"Source File","text":"<p><code>FileEventHandler/FileEventHandler.Service/Models/JobStatusModel.cs</code></p>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#schema","title":"Schema","text":"<pre><code>public class JobStatusModel : TableEntity\n{\n    public string Message { get; set; }\n    public string Status { get; set; }\n    public string OffsetID { get; set; }\n    public string Queue { get; set; }\n    public string EventType { get; set; }\n    public string EventSource { get; set; }\n    public string EventSubject { get; set; }\n    public string EventTime { get; set; }\n    public string AccountID { get; set; }\n    public string CorrelationID { get; set; }\n    public string FlowType { get; set; }\n    public string FileName { get; set; }\n    public string InvalidReason { get; set; }\n    public string Action { get; set; }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#azure-table-entity-properties","title":"Azure Table Entity Properties","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#inherited-properties-from-tableentity","title":"Inherited Properties (from TableEntity)","text":"Property Type Description <code>PartitionKey</code> string Composite key: <code>{source}-{accountId}-{fileName}</code> <code>RowKey</code> string Unique job identifier <code>Timestamp</code> DateTimeOffset Last modified time (auto-managed) <code>ETag</code> string Entity tag for optimistic concurrency"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#custom-properties","title":"Custom Properties","text":"Property Type Description <code>Message</code> string Original CloudEvent message (JSON) or error details <code>Status</code> string Current job status <code>OffsetID</code> string Event Hub offset ID: <code>{partitionId}.{offset}</code> <code>Queue</code> string Assigned queue name <code>EventType</code> string Event type from notification <code>EventSource</code> string Event source from notification <code>EventSubject</code> string Event subject from notification <code>EventTime</code> string Event timestamp <code>AccountID</code> string Account identifier <code>CorrelationID</code> string Correlation ID for tracing <code>FlowType</code> string Flow type identifier <code>FileName</code> string File being processed <code>InvalidReason</code> string Reason for failure/invalid status <code>Action</code> string Current or last action executed"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#status-values","title":"Status Values","text":"Status Description Set By Action Field <code>Failed</code> Message validation failed at routing FileEventHandler <code>JobMessageValidation</code> <code>Succeeded</code> Successfully routed to queue FileEventHandler <code>AssignMessage</code> <code>Invalid</code> Job configuration invalid FileJobHandler varies <code>ReadMessage</code> Job being processed FileJobHandler current action <code>Succeeded</code> Job completed successfully FileJobHandler last action <code>Failed</code> Job execution failed FileJobHandler failed action <p>Note: The status value is reused across components. The <code>Action</code> field distinguishes the context: - <code>JobMessageValidation</code> + <code>Failed</code> = Message validation failed at FileEventHandler - <code>AssignMessage</code> + <code>Succeeded</code> = Successfully routed to queue - Other actions = FileJobHandler processing status</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#status-flow-diagram","title":"Status Flow Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        FileEventHandler                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u25bc                       \u25bc\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502  Failed  \u2502           \u2502 Succeeded \u2502\n              \u2502(Validation\u2502           \u2502 (Routed   \u2502\n              \u2502  failed) \u2502           \u2502  to queue)\u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                                           \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        FileJobHandler                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                           \u2502\n                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                               \u25bc           \u2502           \u25bc\n                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                         \u2502 Invalid \u2502       \u2502     \u2502  Failed  \u2502\n                         \u2502 (Config)\u2502       \u2502     \u2502 (Error)  \u2502\n                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                           \u2502\n                                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                    \u25bc             \u2502\n                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\n                              \u2502ReadMessage\u2502       \u2502\n                              \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\n                                    \u2502             \u2502\n                                    \u25bc             \u2502\n                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\n                              \u2502 Succeeded \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#table-structure","title":"Table Structure","text":"<p>Table Name: <code>jobstatus</code></p> <p>Storage Account: Environment-specific</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#example-records","title":"Example Records","text":"PartitionKey RowKey Status Queue AccountID FileName FTP.File.ExternalService-ACC001-file1.csv evt-123 Succeeded jobs ACC001 file1.csv FTP.File.ExternalService-ACC002-data.txt evt-456 Failed jobs ACC002 data.txt TMS.Route-TMS001-route.xml evt-789 Assigned jobstmsroute TMS001 route.xml"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#query-patterns","title":"Query Patterns","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#find-jobs-by-account","title":"Find Jobs by Account","text":"<pre><code>PartitionKey ge 'source-ACCOUNTID' and PartitionKey lt 'source-ACCOUNTIE'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#find-failed-jobs","title":"Find Failed Jobs","text":"<pre><code>Status eq 'Failed'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#find-jobs-by-time-range","title":"Find Jobs by Time Range","text":"<pre><code>EventTime ge '2024-01-15T00:00:00' and EventTime lt '2024-01-16T00:00:00'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#find-jobs-by-queue","title":"Find Jobs by Queue","text":"<pre><code>Queue eq 'jobstmsroute' and Status eq 'Succeeded'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#status-transitions","title":"Status Transitions","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#fileeventhandler","title":"FileEventHandler","text":"<ol> <li>Message Received:</li> <li>If validation fails \u2192 <code>Failed</code> (Action: <code>JobMessageValidation</code>)</li> <li>If route found \u2192 <code>Succeeded</code> (Action: <code>AssignMessage</code>)</li> <li> <p>Note: <code>NoAssigned</code> status is defined but not currently used in code</p> </li> <li> <p>Validation Failed Record (sets Status=<code>Failed</code>):    <code>csharp    await _jobStatusManipulate.InsertInvalid(Data, PartitionKey, PartitionID, OffsetID, InvalidReason);    // table.Status = AppConfiguration.FixData_Status_Failed; // \"Failed\"    // table.Action = AppConfiguration.FixData_Action_Validation; // \"JobMessageValidation\"</code></p> </li> <li> <p>Successfully Routed Record (sets Status=<code>Succeeded</code>):    <code>csharp    await _jobStatusManipulate.InsertAssigned(Data, Notify, PartitionID, OffsetID, PartitionKey);    // table.Status = AppConfiguration.FixData_Status_Succeeded; // \"Succeeded\"    // table.Action = AppConfiguration.FixData_Action_Assign; // \"AssignMessage\"</code></p> </li> </ol>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#filejobhandler","title":"FileJobHandler","text":"<ol> <li>Processing Start:</li> <li> <p>Update to <code>ReadMessage</code></p> </li> <li> <p>Processing Complete:</p> </li> <li>On success \u2192 <code>Succeeded</code></li> <li>On failure \u2192 <code>Failed</code> with <code>InvalidReason</code></li> </ol>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#invalidreason-values","title":"InvalidReason Values","text":"<p>Common reasons stored in the <code>InvalidReason</code> field:</p> Reason Pattern Description <code>Message is not json format</code> Invalid JSON in event <code>Type,Subject,Source,AccountID not provided</code> Missing required fields <code>Couldn't find Record in Config Table</code> No routing rule matched <code>Try X: {error}. Sleep for Y Second.</code> Retry attempts <code>File Successfully read</code> Read operation succeeded <code>File Successfully write to destination</code> Write operation succeeded <code>Virus Scan Failed ErrorMessage={msg}</code> Virus detected <code>PGP_Decryption method failed</code> Decryption error <code>Couldn't recognise source.type</code> Unknown server type"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#appsettingsjson","title":"appsettings.json","text":"<pre><code>{\n  \"Tables\": {\n    \"jobstatus\": {\n      \"Url\": \"https://enterprisedevsftpapps.table.core.windows.net/\",\n      \"SASToken\": \"sv=2017-04-17&amp;si=full-acl&amp;tn=jobstatus&amp;sig=...\",\n      \"TableName\": \"jobstatus\"\n    }\n  },\n  \"FixData\": {\n    \"InvalidStatus\": \"Invalid\",\n    \"ReadMessageStatus\": \"ReadMessage\",\n    \"StatusSuccess\": \"Succeeded\",\n    \"StatusFailed\": \"Failed\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#monitoring-and-alerting","title":"Monitoring and Alerting","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#key-metrics","title":"Key Metrics","text":"<ol> <li>Failed Job Rate: Count of <code>Status eq 'Failed'</code> per time period</li> <li>NoAssigned Rate: Events without routing rules</li> <li>Processing Latency: Time between <code>Assigned</code> and <code>Succeeded</code></li> <li>Retry Rate: Records with multiple \"Try X\" in <code>InvalidReason</code></li> </ol>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#datadog-queries","title":"Datadog Queries","text":"<pre><code># Failed jobs in last hour\nsum:fts.jobstatus.count{status:failed}.as_count()\n\n# Average processing time\navg:fts.job.processing_time{*}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#troubleshooting","title":"Troubleshooting","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#finding-stuck-jobs","title":"Finding Stuck Jobs","text":"<p>Jobs stuck in <code>ReadMessage</code> for extended periods:</p> <pre><code>Status eq 'ReadMessage' and Timestamp lt datetime'2024-01-15T10:00:00'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#investigating-failures","title":"Investigating Failures","text":"<ol> <li>Query for specific job by RowKey</li> <li>Examine <code>InvalidReason</code> for error details</li> <li>Check <code>Message</code> field for original event</li> <li>Review <code>Action</code> for last executed action</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#common-issues","title":"Common Issues","text":"Symptom Possible Cause Resolution Many <code>NoAssigned</code> Missing routing rules Add entry to jobconfig table Many <code>Invalid</code> Malformed events Check event publisher Stuck <code>ReadMessage</code> Handler crashed Check pod logs, restart Repeated <code>Failed</code> Configuration error Review jobsettings.json"},{"location":"enterprise-services/file-transfer-solution/data-models/jobstatus-model.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Queue Architecture</li> <li>Routing ConfigModel</li> <li>Troubleshooting Runbook</li> <li>Monitoring &amp; Logging</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html","title":"Notification Model","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#notification-model","title":"Notification Model","text":"<p>The Notification model represents CloudEvents messages used throughout the FTS platform for event communication.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#source-file","title":"Source File","text":"<p><code>FileTransferCommon/FileTransferCommon/Model/Notification.cs</code></p>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#schema","title":"Schema","text":"<pre><code>public class Notification\n{\n    public string specversion { get; set; }\n    public string type { get; set; }\n    public string source { get; set; }\n    public string subject { get; set; }\n    public string id { get; set; }\n    public string time { get; set; }\n    public string dataschema { get; set; }\n    public DataInfo data { get; set; }\n}\n\npublic class DataInfo\n{\n    public string correlationId { get; set; }\n    public string instanceId { get; set; }\n    public string clientIpAddress { get; set; }\n    public string accountId { get; set; }\n    public string errorCode { get; set; }\n    public string errorTitle { get; set; }\n    public string errorMsg { get; set; }\n    public string fileName { get; set; }\n    public string targetFileName { get; set; }\n    public long fileSize { get; set; }\n    public string sourceFileName { get; set; }\n    public List&lt;string&gt; parameters { get; set; }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#field-descriptions","title":"Field Descriptions","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#notification-root","title":"Notification (Root)","text":"Field Type Required Description <code>specversion</code> string Yes CloudEvents specification version (always <code>\"1.0\"</code>) <code>type</code> string Yes Event type (e.g., <code>\"Succeeded\"</code>, <code>\"Error\"</code>) <code>source</code> string Yes Event source identifier (e.g., <code>\"FTP.File.ExternalService\"</code>) <code>subject</code> string Yes Event subject/category (e.g., <code>\"File Upload\"</code>) <code>id</code> string Yes Unique event identifier (UUID) <code>time</code> string Yes ISO 8601 timestamp (<code>\"2024-01-15T10:30:00+0000\"</code>) <code>dataschema</code> string No Data schema version (typically <code>\"1.0\"</code>) <code>data</code> DataInfo Yes Event payload"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#datainfo-payload","title":"DataInfo (Payload)","text":"Field Type Required Description <code>correlationId</code> string No Correlation ID for request tracing <code>instanceId</code> string No Processing instance identifier <code>clientIpAddress</code> string No Client IP address <code>accountId</code> string Yes Account identifier for routing <code>errorCode</code> string No Error code (for error events) <code>errorTitle</code> string No Error title <code>errorMsg</code> string No Detailed error message <code>fileName</code> string No Source file path <code>targetFileName</code> string No Target/destination file path <code>fileSize</code> long No File size in bytes <code>sourceFileName</code> string No Original source filename <code>parameters</code> List\\&lt;string&gt; No Additional parameters"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#json-serialization","title":"JSON Serialization","text":"<p>Fields with null values are omitted from JSON output:</p> <pre><code>[JsonProperty(NullValueHandling = NullValueHandling.Ignore)]\npublic string correlationId { get; set; }\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#example-messages","title":"Example Messages","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#success-event-file-upload","title":"Success Event (File Upload)","text":"<pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"FTP.File.ExternalService\",\n  \"subject\": \"File Upload\",\n  \"id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"time\": \"2024-01-15T10:30:00+0000\",\n  \"dataschema\": \"1.0\",\n  \"data\": {\n    \"correlationId\": \"corr-123456\",\n    \"accountId\": \"ACCOUNT001\",\n    \"fileName\": \"incoming/data.csv\",\n    \"targetFileName\": \"processed/data.csv\",\n    \"fileSize\": 1048576\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#error-event","title":"Error Event","text":"<pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Error\",\n  \"source\": \"FTS.JobHandler\",\n  \"subject\": \"JobSettingRead\",\n  \"id\": \"b2c3d4e5-f6a7-8901-bcde-f23456789012\",\n  \"time\": \"2024-01-15T10:35:00+0000\",\n  \"dataschema\": \"1.0\",\n  \"data\": {\n    \"correlationId\": \"corr-123456\",\n    \"accountId\": \"ACCOUNT001\",\n    \"errorCode\": \"CONFIG_NOT_FOUND\",\n    \"errorTitle\": \"Exception\",\n    \"errorMsg\": \"Could not find jobsettings.json for path: /mnt/jobconfig/...\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#fireevent-output","title":"FireEvent Output","text":"<p>Generated by the <code>FireEvent</code> action:</p> <pre><code>{\n  \"specversion\": \"1.0\",\n  \"type\": \"Succeeded\",\n  \"source\": \"FTS.JobHandler\",\n  \"subject\": \"File Ready\",\n  \"id\": \"c3d4e5f6-a7b8-9012-cdef-345678901234\",\n  \"time\": \"2024-01-15T10:40:00+0000\",\n  \"data\": {\n    \"correlationId\": \"corr-123456\",\n    \"accountId\": \"ACCOUNT001\",\n    \"fileName\": \"output/processed_file.csv\",\n    \"fileSize\": 524288\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#validation-rules","title":"Validation Rules","text":"<p>The FileEventHandler validates incoming notifications:</p> <ol> <li>Required Fields: <code>type</code>, <code>source</code>, <code>subject</code>, <code>data.accountId</code> must be non-empty</li> <li>JSON Format: Must be valid JSON</li> <li>Field Presence: All required fields must exist</li> </ol> <pre><code>// From MessageHandler.cs\nif (string.IsNullOrEmpty(Notify.type) ||\n    string.IsNullOrEmpty(Notify.subject) ||\n    string.IsNullOrEmpty(Notify.source) ||\n    string.IsNullOrEmpty(Notify.data.accountId))\n{\n    Logger.Warning($\"Garbage message: Type,Subject,Source,AccountID not provided\");\n    return null;\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#default-values-from-appsettings","title":"Default Values (from appsettings)","text":"<pre><code>{\n  \"Notification\": {\n    \"Specversion\": \"1.0\",\n    \"Type_Error\": \"Error\",\n    \"Type_Success\": \"Succeeded\",\n    \"Source\": \"FTP.File.ExternalService\",\n    \"Dataschema\": \"1.0\",\n    \"Subject\": {\n      \"JobSettingRead\": \"JobSettingRead\",\n      \"JobSecretRead\": \"JobSecretRead\"\n    },\n    \"ErrorTitle\": {\n      \"Exception\": \"Exception\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#usage-patterns","title":"Usage Patterns","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#creating-notifications","title":"Creating Notifications","text":"<pre><code>var notification = new Notification\n{\n    specversion = \"1.0\",\n    type = \"Succeeded\",\n    source = \"FTS.JobHandler\",\n    subject = \"File Processed\",\n    id = Guid.NewGuid().ToString(),\n    time = DateTime.UtcNow.ToString(\"yyyy-MM-ddThh:mm:ss+0000\"),\n    data = new Notification.DataInfo\n    {\n        correlationId = existingCorrelationId,\n        accountId = accountId,\n        fileName = outputFileName,\n        fileSize = fileContent.Length\n    }\n};\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#deserializing-events","title":"Deserializing Events","text":"<pre><code>Notification notify = JsonConvert.DeserializeObject&lt;Notification&gt;(messageData);\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#field-name-mapping","title":"Field Name Mapping","text":"<p>Different contexts use different casing conventions for the same fields:</p> CloudEvent Field Placeholder Azure Table Field Notes <code>data.accountId</code> <code>{@Message.accountID}</code> <code>AccountID</code> Account identifier <code>data.correlationId</code> <code>{@Message.correlationId}</code> <code>CorrelationID</code> Correlation tracking <code>data.fileName</code> <code>{@Message.fileName}</code> <code>FileName</code> File path <code>source</code> <code>{@Message.source}</code> <code>EventSource</code> Event source <code>subject</code> <code>{@Message.subject}</code> <code>EventSubject</code> Event subject <code>type</code> <code>{@Message.type}</code> <code>EventType</code> Event type <p>Important: When using placeholders in job configurations, use the exact casing shown in the \"Placeholder\" column (e.g., <code>{@Message.accountID}</code> not <code>{@Message.accountId}</code>).</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/notification-model.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Event-Driven Architecture</li> <li>Job ConfigModel</li> <li>Action Types - FireEvent</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html","title":"Routing ConfigModel","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#routing-configmodel","title":"Routing ConfigModel","text":"<p>The Routing ConfigModel (distinct from Job ConfigModel) defines Azure Table entities that map incoming events to processing queues.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#source-file","title":"Source File","text":"<p><code>FileEventHandler/FileEventHandler.Service/Models/ConfigModel.cs</code></p>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#schema","title":"Schema","text":"<pre><code>public class ConfigModel : TableEntity\n{\n    public string EventType { get; set; }\n    public string EventSource { get; set; }\n    public string EventSubject { get; set; }\n    public string EventAccountID { get; set; }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#azure-table-entity-properties","title":"Azure Table Entity Properties","text":"<p>The ConfigModel extends <code>TableEntity</code>, inheriting standard Azure Table properties.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#inherited-properties","title":"Inherited Properties","text":"Property Type Description <code>PartitionKey</code> string Queue assignment key (e.g., \"jobs\", \"jobstmsroute\") <code>RowKey</code> string Unique identifier for the routing rule <code>Timestamp</code> DateTimeOffset Last modified time (auto-managed) <code>ETag</code> string Entity tag for optimistic concurrency"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#custom-properties","title":"Custom Properties","text":"Property Type Required Description <code>EventType</code> string Yes Event type to match (e.g., \"Succeeded\") <code>EventSource</code> string Yes Event source to match (e.g., \"FTP.File.ExternalService\") <code>EventSubject</code> string Yes Event subject to match (e.g., \"File Upload\") <code>EventAccountID</code> string Yes Account ID to match (e.g., \"ACCOUNT001\")"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#table-structure","title":"Table Structure","text":"<p>Table Name: <code>jobconfig</code></p> <p>Storage Account: Environment-specific (dev/stg/prod)</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#example-table-data","title":"Example Table Data","text":"PartitionKey RowKey EventType EventSource EventSubject EventAccountID jobs rule-001 Succeeded FTP.File.ExternalService File Upload ACCOUNT001 jobs rule-002 Succeeded FTP.File.ExternalService File Upload ACCOUNT002 jobstmsroute rule-003 Succeeded TMS.Route File Upload TMS001 jobstmsstatus rule-004 Succeeded TMS.Status Status Update TMS001 jobsbylcppricing rule-005 Succeeded Pricing.LCP Price Update PRICING001"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#routing-logic","title":"Routing Logic","text":"<p>The FileEventHandler queries the <code>jobconfig</code> table to determine where to route each event.</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#lookup-process","title":"Lookup Process","text":"<pre><code>// From MessageHandler.cs\nPartitionKey = _tableHelper.SearchConfigTable(\n    Notify.data.accountId,  // EventAccountID\n    Notify.source,          // EventSource\n    Notify.type,            // EventType\n    Notify.subject,         // EventSubject\n    OriginalOffsetId\n);\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#matching-rules","title":"Matching Rules","text":"<ol> <li>All four attributes must match exactly</li> <li>Matching is case-sensitive</li> <li>First matching rule is used</li> <li>If no match found, event is marked as <code>NoAssigned</code></li> </ol>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#partitionkey-values-queue-names","title":"PartitionKey Values (Queue Names)","text":"<p>The <code>PartitionKey</code> maps directly to queue names:</p> PartitionKey Queue Handler <code>jobs</code> jobs FileJobHandler <code>jobstmsroute</code> jobstmsroute FileJobHandler-TMSRoute <code>jobstmsstatus</code> jobstmsstatus FileJobHandler-TMSStatus <code>jobtmscarrierpod</code> jobtmscarrierpod FileJobHandler-TMSCarrierPOD <code>jobsbylcppricing</code> jobsbylcppricing FileJobHandler-PriceProposal <code>jobsbellusermanagement</code> jobsbellusermanagement FileJobHandler <code>jobsbellsrs</code> jobsbellsrs FileJobHandler <code>jobsbellpricegrid</code> jobsbellpricegrid FileJobHandler <code>jobscalgary</code> jobscalgary FileJobHandler <code>jobsdigitalml</code> jobsdigitalml FileJobHandler <code>jobspunchcard</code> jobspunchcard FileJobHandler <code>jobtmsrateshop</code> jobtmsrateshop FileJobHandler <code>jobspostalmate</code> jobspostalmate FileJobHandler <code>jobhrvariancereport</code> jobhrvariancereport FileJobHandler <code>jobmonerisupdater</code> jobmonerisupdater FileJobHandler <code>jobstatfloklaviyo</code> jobstatfloklaviyo FileJobHandler <code>jobamazontax</code> jobamazontax FileJobHandler <code>jobamzskulist</code> jobamzskulist FileJobHandler"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#configuration-management","title":"Configuration Management","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#adding-a-new-route","title":"Adding a New Route","text":"<ol> <li>Determine the target queue (<code>PartitionKey</code>)</li> <li>Create unique <code>RowKey</code></li> <li>Define matching criteria (EventType, EventSource, EventSubject, EventAccountID)</li> <li>Insert entity into <code>jobconfig</code> table</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#azure-portal-storage-explorer","title":"Azure Portal / Storage Explorer","text":"<p>Navigate to: - Storage Account: <code>enterprise{env}sftpapps</code> - Tables: <code>jobconfig</code> - Insert/Edit entities</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#using-azure-cli","title":"Using Azure CLI","text":"<pre><code># Insert routing rule\naz storage entity insert \\\n  --account-name enterprisedevsftpapps \\\n  --table-name jobconfig \\\n  --entity PartitionKey=jobs RowKey=rule-new \\\n    EventType=Succeeded \\\n    EventSource=FTP.File.ExternalService \\\n    EventSubject=\"File Upload\" \\\n    EventAccountID=NEWACCOUNT\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#disambiguation-note","title":"Disambiguation Note","text":"<p>Important: There are two different <code>ConfigModel</code> classes in the codebase:</p> Context File Purpose Job ConfigModel <code>FileJobHandler.Service/Model/ConfigModel.cs</code> Job definition (jobsettings.json) Routing ConfigModel <code>FileEventHandler.Service/Models/ConfigModel.cs</code> Event routing (jobconfig table) <p>Throughout FTS documentation: - \"Job ConfigModel\" refers to job definitions - \"Routing ConfigModel\" refers to this routing table entity</p>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#example-scenarios","title":"Example Scenarios","text":""},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#scenario-1-new-account-setup","title":"Scenario 1: New Account Setup","text":"<p>To route events from a new account <code>ACME001</code> to the generic <code>jobs</code> queue:</p> <pre><code>{\n  \"PartitionKey\": \"jobs\",\n  \"RowKey\": \"acme-file-upload\",\n  \"EventType\": \"Succeeded\",\n  \"EventSource\": \"FTP.File.ExternalService\",\n  \"EventSubject\": \"File Upload\",\n  \"EventAccountID\": \"ACME001\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#scenario-2-specialized-handler","title":"Scenario 2: Specialized Handler","text":"<p>To route TMS route files from account <code>TRANSPORT001</code> to the TMS Route handler:</p> <pre><code>{\n  \"PartitionKey\": \"jobstmsroute\",\n  \"RowKey\": \"transport-tms-route\",\n  \"EventType\": \"Succeeded\",\n  \"EventSource\": \"TMS.Route\",\n  \"EventSubject\": \"File Upload\",\n  \"EventAccountID\": \"TRANSPORT001\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#scenario-3-multiple-event-types","title":"Scenario 3: Multiple Event Types","text":"<p>An account may need different handlers for different event types:</p> <pre><code>// Standard file uploads -&gt; generic handler\n{\n  \"PartitionKey\": \"jobs\",\n  \"RowKey\": \"multi-standard\",\n  \"EventType\": \"Succeeded\",\n  \"EventSource\": \"FTP.File.ExternalService\",\n  \"EventSubject\": \"File Upload\",\n  \"EventAccountID\": \"MULTI001\"\n}\n\n// Pricing updates -&gt; pricing handler\n{\n  \"PartitionKey\": \"jobsbylcppricing\",\n  \"RowKey\": \"multi-pricing\",\n  \"EventType\": \"Succeeded\",\n  \"EventSource\": \"Pricing.LCP\",\n  \"EventSubject\": \"Price Update\",\n  \"EventAccountID\": \"MULTI001\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/data-models/routing-config-model.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Queue Architecture</li> <li>Event-Driven Architecture</li> <li>Job ConfigModel</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html","title":"Action Types","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#action-types","title":"Action Types","text":"<p>This document describes all 16 action types available in FTS job configurations.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#action-type-values","title":"Action Type Values","text":"<p>Important: Use the exact values shown in the \"Value\" column in your configurations.</p> Category Value Description File I/O <code>ReadFile</code> Read file from source <code>WriteFile</code> Write file to destination <code>DeleteFile</code> Delete file from source <code>RenameFile</code> Rename file on source/destination File Lists <code>GetFileList</code> Get list of files matching pattern <code>ZipFileList</code> Create ZIP from file list <code>ConcatenateList</code> Concatenate files in list <code>DeleteFileList</code> Delete files in list Encryption <code>PGP-Decrypt</code> PGP decryption <code>PGP-Encrypt</code> PGP encryption <code>RSA-Encrypt</code> RSA encryption Processing <code>Scan</code> ClamAV virus scanning <code>Encode</code> Character encoding conversion Events <code>FireEvent</code> Fire single CloudEvent <code>FireEventList</code> Fire events for file list <code>Notification</code> Send notification to APIM"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#readfile","title":"ReadFile","text":"<p>Reads a file from the configured source.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration","title":"Configuration","text":"<pre><code>{\n  \"id\": 1,\n  \"type\": \"ReadFile\",\n  \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"ReadFile\"</code> <code>sourceFile</code> Yes Path to file (supports placeholders)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#output","title":"Output","text":"<p>File content available as <code>{@JobSettings.actions.{id}.outputStream}</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#writefile","title":"WriteFile","text":"<p>Writes file content to a destination.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_1","title":"Configuration","text":"<pre><code>{\n  \"id\": 3,\n  \"type\": \"WriteFile\",\n  \"sourceStream\": \"{@JobSettings.actions.2.outputStream}\",\n  \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_1","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"WriteFile\"</code> <code>sourceStream</code> Yes Reference to previous action output <code>outputFile</code> Yes Destination path (must reference destination)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#deletefile","title":"DeleteFile","text":"<p>Deletes a file from the source.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_2","title":"Configuration","text":"<pre><code>{\n  \"id\": 4,\n  \"type\": \"DeleteFile\",\n  \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_2","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"DeleteFile\"</code> <code>sourceFile</code> Yes Path to file to delete"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#renamefile","title":"RenameFile","text":"<p>Renames a file on source or destination.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration-source","title":"Configuration (Source)","text":"<pre><code>{\n  \"id\": 5,\n  \"type\": \"RenameFile\",\n  \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\",\n  \"outputFile\": \"{@JobSettings.source.path}/{@Message.fileName}.processed\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration-destination","title":"Configuration (Destination)","text":"<pre><code>{\n  \"id\": 5,\n  \"type\": \"RenameFile\",\n  \"sourceFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\",\n  \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}.done\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_3","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"RenameFile\"</code> <code>sourceFile</code> Yes Current file path <code>outputFile</code> Yes New file path"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#getfilelist","title":"GetFileList","text":"<p>Gets a list of files matching a pattern.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_3","title":"Configuration","text":"<pre><code>{\n  \"id\": 1,\n  \"type\": \"GetFileList\",\n  \"sourceFile\": \"{@JobSettings.source.path}/*.csv\",\n  \"startWith\": \"report_\",\n  \"endWith\": \".csv\",\n  \"numberOfFiles\": 100,\n  \"sort\": \"name\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_4","title":"Fields","text":"Field Required Default Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"GetFileList\"</code> <code>sourceFile</code> Yes Path pattern with wildcards <code>startWith</code> No Filter: filename prefix <code>endWith</code> No Filter: filename suffix <code>numberOfFiles</code> No 1 Maximum files to return <code>sort</code> No Sort order"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#output_1","title":"Output","text":"<p><code>listFileNames</code> populated with matching files.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#zipfilelist","title":"ZipFileList","text":"<p>Creates a ZIP archive from files in list.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_4","title":"Configuration","text":"<pre><code>{\n  \"id\": 3,\n  \"type\": \"ZipFileList\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n  \"outputFile\": \"{@JobSettings.source.path}/archive.zip\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_5","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"ZipFileList\"</code> <code>sourceStream</code> Yes Reference to GetFileList action (provides <code>listFileNames</code>) <code>outputFile</code> Yes Output ZIP file path (writes directly to disk)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#behavior","title":"Behavior","text":"<p>Important: ZipFileList writes the ZIP archive directly to disk at the specified <code>outputFile</code> path. It does NOT populate <code>outputStream</code>. To transfer the created ZIP to a remote destination, you must: 1. Use ZipFileList to create the archive locally (on the source system) 2. Use ReadFile to read the created ZIP file 3. Use WriteFile to upload to the remote destination</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#example-create-zip-and-upload-to-blob","title":"Example: Create ZIP and Upload to Blob","text":"<pre><code>{\n  \"actions\": [\n    { \"id\": 1, \"type\": \"GetFileList\", \"sourceFile\": \"{@JobSettings.source.path}/*.csv\" },\n    { \"id\": 2, \"type\": \"ZipFileList\", \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\", \"outputFile\": \"{@JobSettings.source.path}/temp.zip\" },\n    { \"id\": 3, \"type\": \"ReadFile\", \"sourceFile\": \"{@JobSettings.source.path}/temp.zip\" },\n    { \"id\": 4, \"type\": \"WriteFile\", \"sourceStream\": \"{@JobSettings.actions.3.outputStream}\", \"outputFile\": \"{@JobSettings.destinations.1.path}/archive.zip\" },\n    { \"id\": 5, \"type\": \"DeleteFile\", \"sourceFile\": \"{@JobSettings.source.path}/temp.zip\" }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#concatenatelist","title":"ConcatenateList","text":"<p>Concatenates files in list into single file(s).</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_5","title":"Configuration","text":"<pre><code>{\n  \"id\": 2,\n  \"type\": \"ConcatenateList\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n  \"outputFile\": \"{@JobSettings.source.path}/consolidated.csv\",\n  \"concateWith\": \"\\n\",\n  \"numberOfFiles\": 1000,\n  \"startWith\": \"\",\n  \"endWith\": \"\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_6","title":"Fields","text":"Field Required Default Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"ConcatenateList\"</code> <code>sourceStream</code> Yes Reference to GetFileList action <code>outputFile</code> Yes Output file path (writes directly to disk) <code>concateWith</code> No <code>\"\"</code> Separator between file contents <code>numberOfFiles</code> No 1 Max files per output (splits if exceeded) <code>startWith</code> No <code>\"\"</code> Content to prepend <code>endWith</code> No <code>\"\"</code> Content to append"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#output_2","title":"Output","text":"<ul> <li>Creates concatenated file(s) on disk at <code>outputFile</code></li> <li>Populates <code>listConcateFileNames</code> with output file paths</li> <li>If <code>numberOfFiles</code> causes splits, files are named: <code>{name}_0.ext</code>, <code>{name}_1.ext</code>, etc.</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#behavior_1","title":"Behavior","text":"<p>Note: ConcatenateList writes directly to disk. The <code>listConcateFileNames</code> can be used by FireEventList to fire events for each concatenated file.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#deletefilelist","title":"DeleteFileList","text":"<p>Deletes all files in list.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_6","title":"Configuration","text":"<pre><code>{\n  \"id\": 4,\n  \"type\": \"DeleteFileList\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_7","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"DeleteFileList\"</code> <code>sourceStream</code> Yes Reference to GetFileList action"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#pgp-decrypt","title":"PGP-Decrypt","text":"<p>Decrypts PGP-encrypted content.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_7","title":"Configuration","text":"<pre><code>{\n  \"id\": 1,\n  \"type\": \"PGP-Decrypt\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n  \"keyFile\": \"{@AppSettings.jobsettingsfolder}/private.key\",\n  \"keypassword\": \"{@JobSecrets.pgpPassword}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_8","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"PGP-Decrypt\"</code> <code>sourceStream</code> Yes Reference to encrypted content <code>keyFile</code> Yes Path to PGP private key <code>keypassword</code> No Key passphrase (from secrets)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#pgp-encrypt","title":"PGP-Encrypt","text":"<p>Encrypts content using PGP.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_8","title":"Configuration","text":"<pre><code>{\n  \"id\": 1,\n  \"type\": \"PGP-Encrypt\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n  \"keyFile\": \"{@AppSettings.jobsettingsfolder}/public.key\",\n  \"encryptArmor\": true,\n  \"encryptIntegirity\": true,\n  \"encryptSymmetricKey\": \"Cast5\",\n  \"encryptCompressed\": \"Uncompressed\",\n  \"encryptFilename\": \"{@Message.fileName.name}.pgp\",\n  \"encryptSubkey\": false\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_9","title":"Fields","text":"Field Required Default Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"PGP-Encrypt\"</code> <code>sourceStream</code> Yes Reference to content to encrypt <code>keyFile</code> Yes Path to PGP public key <code>encryptArmor</code> No <code>true</code> ASCII armor output <code>encryptIntegirity</code> No <code>true</code> Include integrity check <code>encryptSymmetricKey</code> No <code>\"Cast5\"</code> Symmetric algorithm <code>encryptCompressed</code> No <code>\"Uncompressed\"</code> Compression algorithm <code>encryptFilename</code> No <code>\"\"</code> Filename in encrypted packet <code>encryptSubkey</code> No <code>false</code> Use encryption subkey"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#symmetric-key-algorithms","title":"Symmetric Key Algorithms","text":"<p><code>Cast5</code>, <code>Aes128</code>, <code>Aes192</code>, <code>Aes256</code>, <code>Twofish</code>, <code>Blowfish</code>, <code>TripleDes</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#compression-algorithms","title":"Compression Algorithms","text":"<p><code>Uncompressed</code>, <code>Zip</code>, <code>ZLib</code>, <code>BZip2</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#rsa-encrypt","title":"RSA-Encrypt","text":"<p>Encrypts content using RSA.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_9","title":"Configuration","text":"<pre><code>{\n  \"id\": 1,\n  \"type\": \"RSA-Encrypt\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n  \"keyFile\": \"{@AppSettings.jobsettingsfolder}/rsa_public.pem\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_10","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"RSA-Encrypt\"</code> <code>sourceStream</code> Yes Reference to content to encrypt <code>keyFile</code> Yes Path to RSA public key"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#scan","title":"Scan","text":"<p>Performs ClamAV virus scanning.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_10","title":"Configuration","text":"<pre><code>{\n  \"id\": 2,\n  \"type\": \"Scan\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_11","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"Scan\"</code> <code>sourceStream</code> Yes Reference to content to scan"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#behavior_2","title":"Behavior","text":"<ul> <li>If clean: Passes content through unchanged</li> <li>If infected: Action fails with virus details in error message</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#encode","title":"Encode","text":"<p>Converts character encoding.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_11","title":"Configuration","text":"<pre><code>{\n  \"id\": 2,\n  \"type\": \"Encode\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n  \"source\": \"UTF-8\",\n  \"target\": \"ASCII\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_12","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"Encode\"</code> <code>sourceStream</code> Yes Reference to content to encode <code>source</code> Yes Source encoding <code>target</code> Yes Target encoding"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#supported-encodings","title":"Supported Encodings","text":"<p><code>TEXT</code>, <code>UNICODE</code>, <code>ASCII</code>, <code>UTF-8</code>, <code>UTF-7</code>, <code>UTF-32</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fireevent","title":"FireEvent","text":"<p>Fires a CloudEvent notification.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_12","title":"Configuration","text":"<pre><code>{\n  \"id\": 5,\n  \"type\": \"FireEvent\",\n  \"sourceStream\": \"{@JobSettings.actions.3.outputStream}\",\n  \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\",\n  \"eventType\": \"Succeeded\",\n  \"eventSource\": \"FTS.JobHandler\",\n  \"eventSubject\": \"File Ready\",\n  \"eventAccountId\": \"{@Message.accountID}\",\n  \"eventId\": \"\",\n  \"eventCorrelationId\": \"{@Message.correlationId}\",\n  \"eventFileName\": \"{@Message.fileName}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_13","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"FireEvent\"</code> <code>sourceStream</code> Yes Reference to file content <code>outputFile</code> Yes File path for event <code>eventType</code> Yes Event type to emit <code>eventSource</code> Yes Event source identifier <code>eventSubject</code> Yes Event subject <code>eventAccountId</code> Yes Target account ID <code>eventId</code> No Event ID (auto-generated if empty) <code>eventCorrelationId</code> No Correlation ID <code>eventFileName</code> No Filename for event"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fireeventlist","title":"FireEventList","text":"<p>Fires events for each file in a list.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_13","title":"Configuration","text":"<pre><code>{\n  \"id\": 4,\n  \"type\": \"FireEventList\",\n  \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n  \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileList}\",\n  \"eventType\": \"Succeeded\",\n  \"eventSource\": \"FTS.BatchProcessor\",\n  \"eventSubject\": \"Batch File Ready\",\n  \"eventAccountId\": \"{@Message.accountID}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_14","title":"Fields","text":"<p>Same as FireEvent, but fires one event per file in the list.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#notification","title":"Notification","text":"<p>Sends notification to APIM endpoint.</p> <p>Important: The <code>outputFile</code> must reference an <code>Internal-APIM</code> destination. The Notification action only executes for destinations with type <code>Internal-APIM</code>.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#configuration_14","title":"Configuration","text":"<pre><code>{\n  \"id\": 4,\n  \"type\": \"Notification\",\n  \"sourceFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\",\n  \"outputFile\": \"{@JobSettings.destinations.2.path}\",\n  \"eventType\": \"Succeeded\",\n  \"eventAccountId\": \"{@Message.accountID}\",\n  \"eventCorrelationId\": \"{@Message.correlationId}\"\n}\n</code></pre> <p>Where destination 2 is configured as:</p> <pre><code>{\n  \"id\": 2,\n  \"type\": \"Internal-APIM\",\n  \"TargetUrl\": \"https://api.example.com/notify\",\n  \"TimeoutMs\": \"30000\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#fields_15","title":"Fields","text":"Field Required Description <code>id</code> Yes Action identifier <code>type</code> Yes <code>\"Notification\"</code> <code>sourceFile</code> Yes Source file reference <code>outputFile</code> Yes Must reference an <code>Internal-APIM</code> destination <code>eventType</code> No Event type for notification <code>eventAccountId</code> Yes Account identifier <code>eventCorrelationId</code> No Correlation ID"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#behavior_3","title":"Behavior","text":"<p>Sends CloudEvent-formatted notification to configured APIM endpoint.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#action-chaining-reference","title":"Action Chaining Reference","text":"<pre><code>Action 1 (ReadFile)\n    \u2514\u2500\u2500 outputStream \u2500\u2500&gt; Action 2 (PGP-Decrypt)\n                              \u2514\u2500\u2500 outputStream \u2500\u2500&gt; Action 3 (Scan)\n                                                        \u2514\u2500\u2500 outputStream \u2500\u2500&gt; Action 4 (WriteFile)\n</code></pre> <p>Reference pattern: <code>{@JobSettings.actions.{n}.outputStream}</code> (1-based indexing)</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#action-support-matrix-by-source-type","title":"Action Support Matrix by Source Type","text":"<p>Not all actions are supported by all source types. Below is the compatibility matrix:</p> Action Internal-SFTP External-SFTP Vendor-SFTP Vendor-FTP BlobStore GCP AmazonS3 Internal-APIM AzureFile-API ReadFile \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 WriteFile \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 - \u2713 \u2713 DeleteFile \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 - - \u2713 RenameFile \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 - - - GetFileList \u2713 \u2713 - - - - - - - DeleteFileList \u2713 \u2713 - - - - - - - <p>Notes: - <code>\u2713</code> = Supported - <code>-</code> = Not supported - Actions not listed (PGP-Decrypt, PGP-Encrypt, RSA-Encrypt, Scan, Encode, FireEvent, FireEventList, Notification) operate on in-memory streams and are source-type independent</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/action-types.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job Configuration Specification</li> <li>Placeholders Reference</li> <li>Job Examples</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html","title":"Jobsettings Storage","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#jobsettings-storage","title":"Jobsettings Storage","text":"<p>This document describes how job configuration files are stored, located, and resolved at runtime.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#storage-location","title":"Storage Location","text":"<p>Job configurations are stored on an Azure File Share mounted at:</p> <pre><code>/mnt/jobconfig/{source}/{accountID}/{fileName.subFolder}/\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#directory-components","title":"Directory Components","text":"Component Source Example <code>/mnt/jobconfig</code> Fixed mount point <code>{source}</code> <code>{@Message.source}</code> from event <code>FTP.File.ExternalService</code> <code>{accountID}</code> <code>{@Message.accountID}</code> from event <code>ACCOUNT001</code> <code>{fileName.subFolder}</code> Derived from <code>{@Message.fileName}</code> <code>incoming</code>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#example-paths","title":"Example Paths","text":"<p>For event:</p> <pre><code>{\n  \"source\": \"FTP.File.ExternalService\",\n  \"data\": {\n    \"accountId\": \"VENDOR001\",\n    \"fileName\": \"incoming/reports/daily.csv\"\n  }\n}\n</code></pre> <p>Configuration path:</p> <pre><code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/incoming/reports/\n\u251c\u2500\u2500 jobsettings.json\n\u2514\u2500\u2500 jobsecrets.json\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#file-structure","title":"File Structure","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#jobsettingsjson","title":"jobsettings.json","text":"<p>Main job configuration file containing: - Source server configuration - Destination server configurations - Action sequence</p> <p>See Job ConfigModel for schema.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#jobsecretsjson","title":"jobsecrets.json","text":"<p>Sensitive credentials stored separately:</p> <pre><code>{\n  \"vendorUser\": \"actual-username\",\n  \"vendorPass\": \"actual-password\",\n  \"pgpPassword\": \"key-passphrase\",\n  \"blobConnection\": \"DefaultEndpointsProtocol=https;...\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#key-files","title":"Key Files","text":"<p>Encryption keys stored in same directory:</p> <pre><code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/incoming/\n\u251c\u2500\u2500 jobsettings.json\n\u251c\u2500\u2500 jobsecrets.json\n\u251c\u2500\u2500 private.key          # PGP private key\n\u251c\u2500\u2500 public.key           # PGP public key\n\u2514\u2500\u2500 id_rsa               # SSH private key\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#configuration-resolution-flow","title":"Configuration Resolution Flow","text":"<pre><code>flowchart TD\n    A[Incoming Event] --&gt; B[Extract Message Fields]\n    B --&gt; C[Build jobsettingsfolder Path]\n    C --&gt; D{jobsettings.json exists?}\n\n    D --&gt;|Yes| E[Load jobsettings.json]\n    D --&gt;|No| F[Search Parent Folders]\n\n    F --&gt; G{Found in parent?}\n    G --&gt;|Yes| E\n    G --&gt;|No| H[Job Failed: Config Not Found]\n\n    E --&gt; I{Has JobSecrets placeholders?}\n    I --&gt;|Yes| J[Load jobsecrets.json]\n    I --&gt;|No| K[Continue]\n\n    J --&gt; L{jobsecrets.json exists?}\n    L --&gt;|Yes| M[Resolve Placeholders]\n    L --&gt;|No| N{KeyVault enabled?}\n\n    N --&gt;|Yes| O[Fetch from KeyVault]\n    N --&gt;|No| P[Job Failed: Secrets Not Found]\n\n    O --&gt; M\n    M --&gt; K\n\n    K --&gt; Q[Execute Job]\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#folder-search-behavior","title":"Folder Search Behavior","text":"<p>If <code>jobsettings.json</code> is not found in the expected path, the system searches parent folders upward.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#search-example","title":"Search Example","text":"<p>For path <code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/data/reports/</code>:</p> <ol> <li>Check: <code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/data/reports/jobsettings.json</code></li> <li>Check: <code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/data/jobsettings.json</code></li> <li>Check: <code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/jobsettings.json</code></li> <li>Stop at account root</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#use-case","title":"Use Case","text":"<p>A single configuration can handle multiple subfolders:</p> <pre><code>/mnt/jobconfig/source/ACCOUNT001/\n\u251c\u2500\u2500 jobsettings.json       # Handles all subfolders\n\u251c\u2500\u2500 jobsecrets.json\n\u251c\u2500\u2500 incoming/\n\u2502   \u251c\u2500\u2500 data/              # Uses parent jobsettings.json\n\u2502   \u2514\u2500\u2500 reports/           # Uses parent jobsettings.json\n\u2514\u2500\u2500 archive/               # Uses parent jobsettings.json\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#jobsecrets-resolution","title":"JobSecrets Resolution","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#placeholder-pattern","title":"Placeholder Pattern","text":"<pre><code>{@JobSecrets.([a-zA-Z0-9]*)}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#resolution-process","title":"Resolution Process","text":"<ol> <li>File-based (Primary):</li> <li>Load <code>jobsecrets.json</code> from same folder as <code>jobsettings.json</code></li> <li> <p>Match placeholder key to JSON property</p> </li> <li> <p>KeyVault-based (Fallback):</p> </li> <li>If file not found and KeyVault enabled</li> <li>Fetch secret from Azure Key Vault</li> <li>Secret name derived from placeholder key</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#configuration-appsettingsjson","title":"Configuration (appsettings.json)","text":"<pre><code>{\n  \"KeyVaultSecrets\": {\n    \"Enable\": true,\n    \"Uri\": \"https://fts-{env}-key-vault.vault.azure.net/\",\n    \"TanentID\": \"tenant-guid\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#path-placeholder-resolution","title":"Path Placeholder Resolution","text":"<p>The <code>jobsettingsfolder</code> path is built from message fields:</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#appsettingsjson","title":"appsettings.json","text":"<pre><code>{\n  \"AzureFiles\": {\n    \"jobsettingsfolder\": \"/mnt/jobconfig/{@Message.source}/{@Message.accountID}/{@Message.fileName.subFolder}\",\n    \"jobsettingsfile\": \"{@AppSettings.jobsettingsfolder}/jobsettings.json\",\n    \"jobsecretsfile\": \"{@AppSettings.jobsettingsfolder}/jobsecrets.json\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#resolution-example","title":"Resolution Example","text":"<p>Event:</p> <pre><code>{\n  \"source\": \"TMS.Route\",\n  \"data\": {\n    \"accountId\": \"TRANSPORT001\",\n    \"fileName\": \"routes/daily/route_file.xml\"\n  }\n}\n</code></pre> <p>Resolution: 1. <code>{@Message.source}</code> \u2192 <code>TMS.Route</code> 2. <code>{@Message.accountID}</code> \u2192 <code>TRANSPORT001</code> 3. <code>{@Message.fileName.subFolder}</code> \u2192 <code>routes/daily</code> 4. Result: <code>/mnt/jobconfig/TMS.Route/TRANSPORT001/routes/daily/</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#directory-organization-patterns","title":"Directory Organization Patterns","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#per-feed-pattern","title":"Per-Feed Pattern","text":"<p>Each data feed has its own configuration:</p> <pre><code>/mnt/jobconfig/\n\u251c\u2500\u2500 FTP.File.ExternalService/\n\u2502   \u251c\u2500\u2500 VENDOR001/\n\u2502   \u2502   \u251c\u2500\u2500 invoices/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 jobsettings.json\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 jobsecrets.json\n\u2502   \u2502   \u2514\u2500\u2500 orders/\n\u2502   \u2502       \u251c\u2500\u2500 jobsettings.json\n\u2502   \u2502       \u2514\u2500\u2500 jobsecrets.json\n\u2502   \u2514\u2500\u2500 VENDOR002/\n\u2502       \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 TMS.Route/\n    \u2514\u2500\u2500 TRANSPORT001/\n        \u2514\u2500\u2500 ...\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#shared-configuration-pattern","title":"Shared Configuration Pattern","text":"<p>Account shares configuration across subfolders:</p> <pre><code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/\n\u251c\u2500\u2500 jobsettings.json         # Shared by all subfolders\n\u251c\u2500\u2500 jobsecrets.json\n\u251c\u2500\u2500 private.key\n\u251c\u2500\u2500 invoices/                # Uses parent config\n\u251c\u2500\u2500 orders/                  # Uses parent config\n\u2514\u2500\u2500 reports/                 # Uses parent config\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#environment-specific-keys","title":"Environment-Specific Keys","text":"<p>Different keys per subfolder:</p> <pre><code>/mnt/jobconfig/FTP.File.ExternalService/VENDOR001/\n\u251c\u2500\u2500 jobsettings.json         # Shared config\n\u251c\u2500\u2500 jobsecrets.json          # Shared secrets\n\u251c\u2500\u2500 incoming/\n\u2502   \u251c\u2500\u2500 decrypt_private.key  # Decrypt key for incoming\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 outgoing/\n    \u251c\u2500\u2500 encrypt_public.key   # Encrypt key for outgoing\n    \u2514\u2500\u2500 ...\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#troubleshooting","title":"Troubleshooting","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#config-not-found","title":"Config Not Found","text":"<p>Error: <code>Could not find jobsettings.json</code></p> <p>Causes: 1. Event source doesn't match folder structure 2. Account ID mismatch 3. Subfolder path extraction issue</p> <p>Resolution: 1. Verify event fields: <code>source</code>, <code>accountId</code>, <code>fileName</code> 2. Check folder exists at expected path 3. Ensure file permissions allow read access</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#secrets-not-resolved","title":"Secrets Not Resolved","text":"<p>Error: Placeholder appears in credentials</p> <p>Causes: 1. <code>jobsecrets.json</code> missing 2. Key not in secrets file 3. KeyVault not configured/accessible</p> <p>Resolution: 1. Verify <code>jobsecrets.json</code> exists alongside <code>jobsettings.json</code> 2. Check key name matches placeholder exactly 3. Verify KeyVault configuration and access</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#key-file-not-found","title":"Key File Not Found","text":"<p>Error: <code>Key/Vault Private key not found</code></p> <p>Causes: 1. Key file path incorrect 2. File doesn't exist at path 3. File permissions issue</p> <p>Resolution: 1. Use <code>{@AppSettings.jobsettingsfolder}</code> for relative paths 2. Verify file exists in configuration folder 3. Check file permissions</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#best-practices","title":"Best Practices","text":"<ol> <li>Organize by Account: Keep all account configurations together</li> <li>Use Shared Configs: Share common configurations via parent folders</li> <li>Separate Secrets: Always use <code>jobsecrets.json</code> for credentials</li> <li>Version Control: Track configuration changes outside of Azure Files</li> <li>Naming Convention: Use descriptive folder names matching event sources</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/jobsettings-storage.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job ConfigModel</li> <li>Placeholders Reference</li> <li>Security &amp; Secrets</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html","title":"Placeholders Reference","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#placeholders-reference","title":"Placeholders Reference","text":"<p>FTS job configurations support dynamic placeholders that are resolved at runtime. This document describes all available placeholder patterns.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#placeholder-syntax","title":"Placeholder Syntax","text":"<p>Placeholders follow the pattern: <code>{@Category.property}</code> or <code>{@Category.property.subProperty}</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#message-placeholders","title":"Message Placeholders","text":"<p>Values from the incoming CloudEvent notification.</p> Placeholder Description Example Value <code>{@Message.fileName}</code> Full file path from event <code>incoming/data/file.csv</code> <code>{@Message.targetFileName}</code> Target file path <code>processed/file.csv</code> <code>{@Message.source}</code> Event source <code>FTP.File.ExternalService</code> <code>{@Message.accountID}</code> Account identifier <code>ACCOUNT001</code> <code>{@Message.correlationId}</code> Correlation ID <code>corr-123456</code> <code>{@Message.fileList}</code> File list (for batch operations) (array)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#filename-components","title":"Filename Components","text":"Placeholder Description Example <code>{@Message.fileName.name}</code> Filename without extension <code>report</code> <code>{@Message.fileName.extension}</code> File extension <code>csv</code> <code>{@Message.fileName.path}</code> Directory path <code>incoming/data</code> <code>{@Message.fileName.subFolder}</code> Subfolder path <code>data</code> <code>{@Message.fileName.firstSubFolder}</code> First subfolder <code>incoming</code>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#example","title":"Example","text":"<p>For <code>{@Message.fileName}</code> = <code>incoming/reports/daily_report.csv</code>:</p> Placeholder Resolved Value <code>{@Message.fileName}</code> <code>incoming/reports/daily_report.csv</code> <code>{@Message.fileName.name}</code> <code>daily_report</code> <code>{@Message.fileName.extension}</code> <code>csv</code> <code>{@Message.fileName.path}</code> <code>incoming/reports</code> <code>{@Message.fileName.subFolder}</code> <code>reports</code>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#appsettings-placeholders","title":"AppSettings Placeholders","text":"<p>Values from application configuration (<code>appsettings.json</code>).</p> Placeholder Description Example Value <code>{@AppSettings.sftpintroot}</code> Internal SFTP mount <code>/mnt/sftpintroot</code> <code>{@AppSettings.sftpextroot}</code> External SFTP mount <code>/mnt/sftpextroot</code> <code>{@AppSettings.sftpintfolder}</code> Internal folder (with account) <code>/mnt/sftpintroot/ACCOUNT001</code> <code>{@AppSettings.sftpextfolder}</code> External folder (with account) <code>/mnt/sftpextroot/ACCOUNT001</code> <code>{@AppSettings.sftpintfile}</code> Internal file path <code>/mnt/sftpintroot/ACCOUNT001/file.csv</code> <code>{@AppSettings.sftpextfile}</code> External file path <code>/mnt/sftpextroot/ACCOUNT001/file.csv</code> <code>{@AppSettings.jobsettingsfolder}</code> Job config folder <code>/mnt/jobconfig/FTP.File.ExternalService/ACCOUNT001/data</code>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#appsettings-resolution","title":"AppSettings Resolution","text":"<p>AppSettings placeholders can be nested:</p> <pre><code>{\n  \"AzureFiles\": {\n    \"sftpintroot\": \"/mnt/sftpintroot\",\n    \"sftpintfolder\": \"{@AppSettings.sftpintroot}/{@Message.accountID}\",\n    \"jobsettingsfolder\": \"/mnt/jobconfig/{@Message.source}/{@Message.accountID}/{@Message.fileName.subFolder}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#jobsettings-placeholders","title":"JobSettings Placeholders","text":"<p>References to values within the job configuration itself.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#source-references","title":"Source References","text":"Placeholder Description <code>{@JobSettings.source.path}</code> Source server path <code>{@JobSettings.source.host}</code> Source server hostname <code>{@JobSettings.source.type}</code> Source server type"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#destination-references","title":"Destination References","text":"Placeholder Description <code>{@JobSettings.destinations.{n}.path}</code> Destination path by position (1-based) <code>{@JobSettings.destinations.{n}.host}</code> Destination hostname by position (1-based) <code>{@JobSettings.destinations.{n}.type}</code> Destination type by position (1-based) <p>Important: Destination indices are 1-based. The first destination is referenced as <code>destinations.1</code>, not <code>destinations.0</code>.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#action-references","title":"Action References","text":"Placeholder Description <code>{@JobSettings.actions.{n}.outputStream}</code> Action output stream (1-based) <code>{@JobSettings.action.{n}.filename}</code> Action output filename (1-based) <p>Important: Action indices are 1-based. The first action is referenced as <code>actions.1</code>, not <code>actions.0</code>.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#example_1","title":"Example","text":"<pre><code>{\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 2,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#jobsecrets-placeholders","title":"JobSecrets Placeholders","text":"<p>References to values in <code>jobsecrets.json</code>.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#syntax","title":"Syntax","text":"<p><code>{@JobSecrets.keyName}</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#pattern","title":"Pattern","text":"<p>Regex: <code>{@JobSecrets.([a-zA-Z0-9]*)}</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#example_2","title":"Example","text":"<p>jobsettings.json:</p> <pre><code>{\n  \"source\": {\n    \"credentials\": {\n      \"username\": \"{@JobSecrets.vendorUser}\",\n      \"password\": \"{@JobSecrets.vendorPass}\"\n    }\n  }\n}\n</code></pre> <p>jobsecrets.json:</p> <pre><code>{\n  \"vendorUser\": \"actual_username\",\n  \"vendorPass\": \"actual_password\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#datetime-placeholders","title":"DateTime Placeholders","text":"<p>Dynamic date/time values.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#current-datetime","title":"Current DateTime","text":"Placeholder Description Example <code>{@DateTimeNow:yyyy}</code> Current year <code>2024</code> <code>{@DateTimeNow:MM}</code> Current month <code>01</code> <code>{@DateTimeNow:dd}</code> Current day <code>15</code> <code>{@DateTimeNow:HH}</code> Current hour (24h) <code>14</code> <code>{@DateTimeNow:mm}</code> Current minute <code>30</code> <code>{@DateTimeNow:ss}</code> Current second <code>45</code> <code>{@DateTimeNow:yyyyMMdd}</code> Date stamp <code>20240115</code> <code>{@DateTimeNow:yyyyMMddHHmmss}</code> Full timestamp <code>20240115143045</code>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#file-datetime","title":"File DateTime","text":"<p>Based on file modification time:</p> Placeholder Description <code>{@FileDateTime:yyyy}</code> File year <code>{@FileDateTime:MM}</code> File month <code>{@FileDateTime:dd}</code> File day <code>{@FileDateTime:yyyyMMdd}</code> File date stamp"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#example_3","title":"Example","text":"<pre><code>{\n  \"outputFile\": \"{@JobSettings.destinations.1.path}/archive_{@DateTimeNow:yyyyMMdd}_{@Message.fileName}\"\n}\n</code></pre> <p>Result: <code>archive_20240115_report.csv</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#placeholder-resolution-order","title":"Placeholder Resolution Order","text":"<ol> <li>JobSecrets: <code>{@JobSecrets.xxx}</code> resolved from jobsecrets.json</li> <li>AppSettings: <code>{@AppSettings.xxx}</code> resolved from appsettings.json</li> <li>Message: <code>{@Message.xxx}</code> resolved from CloudEvent</li> <li>JobSettings: <code>{@JobSettings.xxx}</code> resolved from jobsettings.json</li> <li>DateTime: <code>{@DateTimeNow:xxx}</code> and <code>{@FileDateTime:xxx}</code> resolved</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#nested-resolution","title":"Nested Resolution","text":"<p>Placeholders can be nested:</p> <pre><code>{\n  \"sftpintfolder\": \"{@AppSettings.sftpintroot}/{@Message.accountID}\"\n}\n</code></pre> <p>Resolution: 1. <code>{@AppSettings.sftpintroot}</code> \u2192 <code>/mnt/sftpintroot</code> 2. <code>{@Message.accountID}</code> \u2192 <code>ACCOUNT001</code> 3. Result: <code>/mnt/sftpintroot/ACCOUNT001</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#common-patterns","title":"Common Patterns","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#standard-file-paths","title":"Standard File Paths","text":"<pre><code>// Read from source\n\"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n\n// Write to destination (1-based index)\n\"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n\n// Write with new name\n\"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName.name}_processed.{@Message.fileName.extension}\"\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#dated-archive","title":"Dated Archive","text":"<pre><code>\"outputFile\": \"{@JobSettings.destinations.1.path}/archive/{@DateTimeNow:yyyy}/{@DateTimeNow:MM}/{@Message.fileName}\"\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#secrets-in-credentials","title":"Secrets in Credentials","text":"<pre><code>\"credentials\": {\n  \"username\": \"{@JobSecrets.user}\",\n  \"password\": \"{@JobSecrets.pass}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#key-file-paths","title":"Key File Paths","text":"<pre><code>\"keyFile\": \"{@AppSettings.jobsettingsfolder}/keys/private.key\",\n\"keypassword\": \"{@JobSecrets.keyPassword}\"\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#troubleshooting","title":"Troubleshooting","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#placeholder-not-resolved","title":"Placeholder Not Resolved","text":"<p>Symptom: Literal <code>{@xxx}</code> appears in output</p> <p>Causes: 1. Typo in placeholder name 2. Missing value in source (jobsecrets, appsettings) 3. Incorrect placeholder category</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#resolution-order-issues","title":"Resolution Order Issues","text":"<p>Symptom: Unexpected value substitution</p> <p>Solution: Ensure proper nesting order - outer placeholders resolve first</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#file-not-found","title":"File Not Found","text":"<p>Symptom: <code>{@AppSettings.jobsettingsfolder}</code> resolves to wrong path</p> <p>Cause: Message fields don't match expected folder structure</p> <p>Solution: Verify <code>{@Message.source}</code>, <code>{@Message.accountID}</code>, <code>{@Message.fileName.subFolder}</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/placeholders-reference.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job Configuration Specification</li> <li>Jobsettings Storage</li> <li>Security &amp; Secrets</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html","title":"Source/Destination Types","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#sourcedestination-types","title":"Source/Destination Types","text":"<p>This document describes all supported server types for sources and destinations in FTS job configurations.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#type-values","title":"Type Values","text":"Type Value Description Supported As <code>Internal-SFTP</code> Internal SFTP (Azure File Share mounted) Source, Destination <code>External-SFTP</code> External SFTP (Azure File Share mounted) Source, Destination <code>Vendor-SFTP</code> Third-party vendor SFTP servers Source, Destination <code>Vendor-FTP</code> Third-party vendor FTP/FTPS servers Source, Destination <code>BlobStore</code> Azure Blob Storage Source, Destination <code>GCP</code> Google Cloud Storage Source, Destination <code>AmazonS3</code> Amazon S3 Source, Destination <code>Internal-APIM</code> Azure API Management Source, Destination <code>AzureFile-API</code> Azure File Share via API Source, Destination"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#internal-sftp","title":"Internal-SFTP","text":"<p>Azure File Share mounted internally for SFTP access.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration","title":"Configuration","text":"<pre><code>{\n  \"type\": \"Internal-SFTP\",\n  \"name\": \"Internal SFTP Server\",\n  \"path\": \"{@AppSettings.sftpintroot}/{@Message.accountID}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields","title":"Fields","text":"Field Required Description <code>type</code> Yes <code>\"Internal-SFTP\"</code> <code>name</code> No Display name <code>path</code> Yes File path (supports placeholders)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#mount-path","title":"Mount Path","text":"<p><code>/mnt/sftpintroot</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#external-sftp","title":"External-SFTP","text":"<p>Azure File Share mounted for external-facing SFTP access.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration_1","title":"Configuration","text":"<pre><code>{\n  \"type\": \"External-SFTP\",\n  \"name\": \"External SFTP Server\",\n  \"path\": \"{@AppSettings.sftpextroot}/{@Message.accountID}\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_1","title":"Fields","text":"Field Required Description <code>type</code> Yes <code>\"External-SFTP\"</code> <code>name</code> No Display name <code>path</code> Yes File path (supports placeholders)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#mount-path_1","title":"Mount Path","text":"<p><code>/mnt/sftpextroot</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#vendor-sftp","title":"Vendor-SFTP","text":"<p>Third-party vendor SFTP servers accessed via SSH.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration-basic-auth","title":"Configuration (Basic Auth)","text":"<pre><code>{\n  \"type\": \"Vendor-SFTP\",\n  \"name\": \"Vendor SFTP\",\n  \"host\": \"sftp.vendor.com\",\n  \"port\": \"22\",\n  \"path\": \"/outbound\",\n  \"credentials\": {\n    \"type\": \"BasicAuth\",\n    \"username\": \"{@JobSecrets.sftpUser}\",\n    \"password\": \"{@JobSecrets.sftpPass}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration-ssh-key","title":"Configuration (SSH Key)","text":"<pre><code>{\n  \"type\": \"Vendor-SFTP\",\n  \"name\": \"Vendor SFTP\",\n  \"host\": \"sftp.vendor.com\",\n  \"port\": \"22\",\n  \"path\": \"/outbound\",\n  \"credentials\": {\n    \"type\": \"SSHKey\",\n    \"username\": \"{@JobSecrets.sftpUser}\",\n    \"sshkey\": \"{@AppSettings.jobsettingsfolder}/id_rsa\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_2","title":"Fields","text":"Field Required Description <code>type</code> Yes <code>\"Vendor-SFTP\"</code> <code>host</code> Yes SFTP server hostname <code>port</code> Yes Port number (typically \"22\") <code>path</code> Yes Base directory path <code>credentials.type</code> Yes <code>\"BasicAuth\"</code> or <code>\"SSHKey\"</code> <code>credentials.username</code> Yes SSH username <code>credentials.password</code> Conditional Password (for BasicAuth) <code>credentials.sshkey</code> Conditional Path to SSH private key (for SSHKey)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#vendor-ftp","title":"Vendor-FTP","text":"<p>Third-party vendor FTP/FTPS servers.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration_2","title":"Configuration","text":"<pre><code>{\n  \"type\": \"Vendor-FTP\",\n  \"name\": \"Vendor FTP\",\n  \"host\": \"ftp.vendor.com\",\n  \"port\": \"21\",\n  \"path\": \"/uploads\",\n  \"ssl\": true,\n  \"credentials\": {\n    \"username\": \"{@JobSecrets.ftpUser}\",\n    \"password\": \"{@JobSecrets.ftpPass}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_3","title":"Fields","text":"Field Required Default Description <code>type</code> Yes <code>\"Vendor-FTP\"</code> <code>host</code> Yes FTP server hostname <code>port</code> Yes Port number (typically \"21\") <code>path</code> Yes Base directory path <code>ssl</code> No <code>false</code> Enable FTPS (explicit TLS) <code>credentials.username</code> Yes FTP username <code>credentials.password</code> Yes FTP password"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#blobstore","title":"BlobStore","text":"<p>Azure Blob Storage.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration_3","title":"Configuration","text":"<pre><code>{\n  \"type\": \"BlobStore\",\n  \"name\": \"Azure Blob Storage\",\n  \"endpoint\": \"https://storageaccount.blob.core.windows.net\",\n  \"path\": \"incoming/files\",\n  \"credentials\": {\n    \"containerName\": \"data\",\n    \"connectionString\": \"{@JobSecrets.blobConnection}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#alternative-sas-token","title":"Alternative (SAS Token)","text":"<pre><code>{\n  \"type\": \"BlobStore\",\n  \"endpoint\": \"https://storageaccount.blob.core.windows.net\",\n  \"credentials\": {\n    \"containerName\": \"data\",\n    \"sasToken\": \"{@JobSecrets.blobSasToken}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_4","title":"Fields","text":"Field Required Description <code>type</code> Yes <code>\"BlobStore\"</code> <code>endpoint</code> Yes Blob storage endpoint URL <code>path</code> No Virtual directory path within container <code>credentials.containerName</code> Yes Blob container name <code>credentials.connectionString</code> Conditional Full connection string <code>credentials.sasToken</code> Conditional SAS token (if not using connection string)"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#gcp-google-cloud-storage","title":"GCP (Google Cloud Storage)","text":"<p>Google Cloud Storage buckets.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration_4","title":"Configuration","text":"<pre><code>{\n  \"type\": \"GCP\",\n  \"name\": \"Google Cloud Storage\",\n  \"bucketName\": \"my-bucket\",\n  \"path\": \"data/incoming\",\n  \"servicetype\": \"service_account\",\n  \"projectID\": \"my-gcp-project\",\n  \"privateKeyID\": \"{@JobSecrets.gcpKeyId}\",\n  \"clientEmail\": \"service@project.iam.gserviceaccount.com\",\n  \"clientID\": \"123456789012345678901\",\n  \"authUri\": \"https://accounts.google.com/o/oauth2/auth\",\n  \"tokenUri\": \"https://oauth2.googleapis.com/token\",\n  \"authProvider\": \"https://www.googleapis.com/oauth2/v1/certs\",\n  \"clientCertUrl\": \"https://www.googleapis.com/robot/v1/metadata/x509/...\",\n  \"universeDomain\": \"googleapis.com\",\n  \"credentials\": {\n    \"privateKey\": \"{@JobSecrets.gcpPrivateKey}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_5","title":"Fields","text":"Field Required Description <code>type</code> Yes <code>\"GCP\"</code> <code>bucketName</code> Yes GCS bucket name <code>path</code> No Object prefix path <code>servicetype</code> Yes Authentication type <code>projectID</code> Yes GCP project identifier <code>clientEmail</code> Yes Service account email <code>credentials.privateKey</code> Yes Service account private key"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#amazons3","title":"AmazonS3","text":"<p>Amazon S3 buckets.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration_5","title":"Configuration","text":"<pre><code>{\n  \"type\": \"AmazonS3\",\n  \"name\": \"Amazon S3\",\n  \"bucketName\": \"my-bucket\",\n  \"region\": \"us-east-1\",\n  \"path\": \"data/incoming\",\n  \"credentials\": {\n    \"accessKey\": \"{@JobSecrets.s3AccessKey}\",\n    \"secretKey\": \"{@JobSecrets.s3SecretKey}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_6","title":"Fields","text":"Field Required Description <code>type</code> Yes <code>\"AmazonS3\"</code> <code>bucketName</code> Yes S3 bucket name <code>region</code> Yes AWS region (e.g., \"us-east-1\") <code>path</code> No Object prefix path <code>credentials.accessKey</code> Yes AWS access key ID <code>credentials.secretKey</code> Yes AWS secret access key"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#internal-apim","title":"Internal-APIM","text":"<p>Azure API Management for HTTP-based integrations.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration_6","title":"Configuration","text":"<pre><code>{\n  \"type\": \"Internal-APIM\",\n  \"name\": \"Internal API\",\n  \"TargetUrl\": \"https://api.example.com/v1/files\",\n  \"TimeoutMs\": \"30000\",\n  \"RepeatAPI\": \"3\",\n  \"credentials\": {\n    \"OAuthScope\": \"api://my-api/.default\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_7","title":"Fields","text":"Field Required Default Description <code>type</code> Yes <code>\"Internal-APIM\"</code> <code>TargetUrl</code> Yes API endpoint URL <code>TimeoutMs</code> No \"30000\" Request timeout in milliseconds <code>RepeatAPI</code> No \"1\" Number of retry attempts <code>credentials.OAuthScope</code> Yes OAuth 2.0 scope for token"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#oauth-flow","title":"OAuth Flow","text":"<p>Uses Azure AD client credentials flow with APIM configuration from <code>appsettings.json</code>.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#azurefile-api","title":"AzureFile-API","text":"<p>Azure File Share accessed via Azure SDK.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#configuration_7","title":"Configuration","text":"<pre><code>{\n  \"type\": \"AzureFile-API\",\n  \"name\": \"Azure File Share\",\n  \"path\": \"/share/folder\",\n  \"credentials\": {\n    \"shareName\": \"myfileshare\",\n    \"connectionString\": \"{@JobSecrets.fileShareConnection}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#fields_8","title":"Fields","text":"Field Required Description <code>type</code> Yes <code>\"AzureFile-API\"</code> <code>path</code> Yes Directory path within share <code>credentials.shareName</code> Yes Azure File Share name <code>credentials.connectionString</code> Yes Storage connection string"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#operation-support-matrix","title":"Operation Support Matrix","text":"Type ReadFile WriteFile DeleteFile RenameFile GetFileList Internal-SFTP Yes Yes Yes Yes Yes External-SFTP Yes Yes Yes Yes Yes Vendor-SFTP Yes Yes Yes Yes Yes Vendor-FTP Yes Yes Yes Yes Yes BlobStore Yes Yes Yes Yes Yes GCP Yes Yes Yes Yes Yes AmazonS3 Yes Yes Yes No No Internal-APIM Yes Yes No No No AzureFile-API Yes Yes Yes Yes Yes"},{"location":"enterprise-services/file-transfer-solution/job-configuration/source-destination-types.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job Configuration Specification</li> <li>Credentials Model</li> <li>Multi-Cloud Storage</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html","title":"Job Configuration Specification","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#job-configuration-specification","title":"Job Configuration Specification","text":"<p>This document provides the complete specification for FTS job configuration files (<code>jobsettings.json</code>).</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#file-structure","title":"File Structure","text":"<p>Job configurations are stored in the Azure File Share at:</p> <pre><code>/mnt/jobconfig/{source}/{accountID}/{fileName.subFolder}/jobsettings.json\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#json-schema","title":"JSON Schema","text":"<pre><code>{\n  \"$schema\": \"https://json-schema.org/draft-07/schema#\",\n  \"type\": \"object\",\n  \"required\": [\"feedName\", \"source\", \"destinations\", \"actions\"],\n  \"properties\": {\n    \"feedName\": {\n      \"type\": \"string\",\n      \"description\": \"Unique identifier for this job configuration\"\n    },\n    \"version\": {\n      \"type\": \"string\",\n      \"description\": \"Configuration version (optional)\"\n    },\n    \"jobsecret\": {\n      \"type\": \"string\",\n      \"description\": \"Path to secrets file (optional)\"\n    },\n    \"source\": {\n      \"$ref\": \"#/definitions/serversAttributes\"\n    },\n    \"destinations\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"$ref\": \"#/definitions/destination\"\n      },\n      \"minItems\": 1\n    },\n    \"actions\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"$ref\": \"#/definitions/action\"\n      },\n      \"minItems\": 1\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#configuration-sections","title":"Configuration Sections","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#root-level","title":"Root Level","text":"<pre><code>{\n  \"feedName\": \"my-data-feed\",\n  \"version\": \"2.0\",\n  \"source\": { ... },\n  \"destinations\": [ ... ],\n  \"actions\": [ ... ]\n}\n</code></pre> Field Required Description <code>feedName</code> Yes Unique job identifier for logging and troubleshooting <code>version</code> No Configuration version for change tracking <code>jobsecret</code> No Reference to external secrets file <code>source</code> Yes Source server configuration <code>destinations</code> Yes Array of destination configurations <code>actions</code> Yes Array of actions to execute in order"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#source-configuration","title":"Source Configuration","text":"<p>The <code>source</code> object defines where files are read from.</p> <pre><code>{\n  \"source\": {\n    \"name\": \"Vendor SFTP Server\",\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.vendor.com\",\n    \"port\": \"22\",\n    \"path\": \"/outbound\",\n    \"ssl\": false,\n    \"credentials\": {\n      \"type\": \"BasicAuth\",\n      \"username\": \"{@JobSecrets.vendorUser}\",\n      \"password\": \"{@JobSecrets.vendorPass}\"\n    }\n  }\n}\n</code></pre> <p>See Source/Destination Types for complete field reference.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#destinations-configuration","title":"Destinations Configuration","text":"<p>The <code>destinations</code> array defines where files can be written.</p> <pre><code>{\n  \"destinations\": [\n    {\n      \"id\": 1,\n      \"name\": \"Azure Blob Storage\",\n      \"type\": \"BlobStore\",\n      \"endpoint\": \"https://storage.blob.core.windows.net\",\n      \"credentials\": {\n        \"containerName\": \"incoming\",\n        \"connectionString\": \"{@JobSecrets.blobConnection}\"\n      }\n    },\n    {\n      \"id\": 1,\n      \"name\": \"Internal SFTP\",\n      \"type\": \"Internal-SFTP\",\n      \"path\": \"{@AppSettings.sftpintroot}/{@Message.accountID}/processed\"\n    }\n  ]\n}\n</code></pre> <p>Important: The <code>id</code> field must be unique and is used by actions to reference destinations.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#actions-configuration","title":"Actions Configuration","text":"<p>The <code>actions</code> array defines operations to perform in sequence.</p> <pre><code>{\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"Scan\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\"\n    },\n    {\n      \"id\": 2,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName}\"\n    }\n  ]\n}\n</code></pre> <p>See Action Types for complete action reference.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#action-chaining","title":"Action Chaining","text":"<p>Actions are linked through stream references:</p> <ol> <li>ReadFile outputs to <code>actions.{id}.outputStream</code></li> <li>Subsequent actions reference via <code>sourceStream: \"{@JobSettings.actions.1.outputStream}\"</code></li> <li>Data flows through the action pipeline</li> </ol> <pre><code>ReadFile (id=0) \u2500\u2500&gt; Scan (id=1) \u2500\u2500&gt; WriteFile (id=2)\n     \u2502                   \u2502\n     \u2514\u2500\u2500 outputStream \u2500\u2500\u2500\u2518\u2500\u2500 sourceStream\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#validation-rules","title":"Validation Rules","text":""},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#required-fields","title":"Required Fields","text":"Section Required Fields Root <code>feedName</code>, <code>source</code>, <code>destinations</code>, <code>actions</code> Source <code>type</code> Destination <code>id</code>, <code>type</code> Action <code>id</code>, <code>type</code>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#action-specific-requirements","title":"Action-Specific Requirements","text":"Action Type Required Fields ReadFile <code>sourceFile</code> WriteFile <code>sourceStream</code>, <code>outputFile</code> DeleteFile <code>sourceFile</code> PGP-Decrypt <code>sourceStream</code>, <code>keyFile</code> PGP-Encrypt <code>sourceStream</code>, <code>keyFile</code> Scan <code>sourceStream</code> FireEvent <code>sourceStream</code>, <code>outputFile</code>, event fields"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#destination-reference","title":"Destination Reference","text":"<p>WriteFile <code>outputFile</code> must reference a valid destination:</p> <pre><code>{@JobSettings.destinations.{id}.path}/...\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#complete-example","title":"Complete Example","text":"<pre><code>{\n  \"feedName\": \"vendor-invoice-import\",\n  \"version\": \"1.0\",\n  \"source\": {\n    \"name\": \"Vendor SFTP\",\n    \"type\": \"Vendor-SFTP\",\n    \"host\": \"sftp.vendor.com\",\n    \"port\": \"22\",\n    \"path\": \"/outbound/invoices\",\n    \"credentials\": {\n      \"type\": \"BasicAuth\",\n      \"username\": \"{@JobSecrets.vendorUser}\",\n      \"password\": \"{@JobSecrets.vendorPass}\"\n    }\n  },\n  \"destinations\": [\n    {\n      \"id\": 1,\n      \"name\": \"Azure Blob - Raw\",\n      \"type\": \"BlobStore\",\n      \"endpoint\": \"https://storage.blob.core.windows.net\",\n      \"path\": \"raw/invoices\",\n      \"credentials\": {\n        \"containerName\": \"invoices\",\n        \"connectionString\": \"{@JobSecrets.blobConnection}\"\n      }\n    },\n    {\n      \"id\": 1,\n      \"name\": \"Azure Blob - Processed\",\n      \"type\": \"BlobStore\",\n      \"endpoint\": \"https://storage.blob.core.windows.net\",\n      \"path\": \"processed/invoices\",\n      \"credentials\": {\n        \"containerName\": \"invoices\",\n        \"connectionString\": \"{@JobSecrets.blobConnection}\"\n      }\n    }\n  ],\n  \"actions\": [\n    {\n      \"id\": 1,\n      \"type\": \"ReadFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 1,\n      \"type\": \"PGP-Decrypt\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\",\n      \"keyFile\": \"{@AppSettings.jobsettingsfolder}/private.key\",\n      \"keypassword\": \"{@JobSecrets.pgpPassword}\"\n    },\n    {\n      \"id\": 2,\n      \"type\": \"Scan\",\n      \"sourceStream\": \"{@JobSettings.actions.1.outputStream}\"\n    },\n    {\n      \"id\": 3,\n      \"type\": \"WriteFile\",\n      \"sourceStream\": \"{@JobSettings.actions.2.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName.name}.csv\"\n    },\n    {\n      \"id\": 4,\n      \"type\": \"DeleteFile\",\n      \"sourceFile\": \"{@JobSettings.source.path}/{@Message.fileName}\"\n    },\n    {\n      \"id\": 5,\n      \"type\": \"FireEvent\",\n      \"sourceStream\": \"{@JobSettings.actions.2.outputStream}\",\n      \"outputFile\": \"{@JobSettings.destinations.1.path}/{@Message.fileName.name}.csv\",\n      \"eventType\": \"Succeeded\",\n      \"eventSource\": \"FTS.InvoiceProcessor\",\n      \"eventSubject\": \"Invoice Ready\",\n      \"eventAccountId\": \"{@Message.accountID}\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#secrets-file-jobsecretsjson","title":"Secrets File (jobsecrets.json)","text":"<p>Store sensitive credentials separately:</p> <pre><code>{\n  \"vendorUser\": \"actual-username\",\n  \"vendorPass\": \"actual-password\",\n  \"pgpPassword\": \"key-passphrase\",\n  \"blobConnection\": \"DefaultEndpointsProtocol=https;AccountName=...\"\n}\n</code></pre> <p>Referenced via <code>{@JobSecrets.keyName}</code> placeholders.</p>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#best-practices","title":"Best Practices","text":"<ol> <li>Use Meaningful Names: Set descriptive <code>feedName</code> for easy identification</li> <li>Secure Credentials: Always use <code>{@JobSecrets.xxx}</code> for sensitive data</li> <li>Sequential IDs: Use sequential action IDs (0, 1, 2, ...) for clarity</li> <li>Delete After Success: Include DeleteFile as final action when appropriate</li> <li>Fire Events: Use FireEvent to notify downstream systems</li> <li>Version Control: Track configuration changes with <code>version</code> field</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/job-configuration/specification.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Source/Destination Types</li> <li>Action Types</li> <li>Placeholders Reference</li> <li>Jobsettings Storage</li> <li>Job Examples</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html","title":"Job Examples","text":""},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#job-examples","title":"Job Examples","text":"<p>This directory contains example job configurations demonstrating common FTS use cases.</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#important-1-based-indexing","title":"Important: 1-Based Indexing","text":"<p>All action and destination indices use 1-based indexing. When referencing: - Actions: Use <code>{@JobSettings.actions.1.outputStream}</code> for the first action - Destinations: Use <code>{@JobSettings.destinations.1.path}</code> for the first destination</p> <p>This applies to both the <code>id</code> field in configurations and placeholder references.</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#coverage-matrix","title":"Coverage Matrix","text":""},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#source-type-coverage","title":"Source Type Coverage","text":"Example Source Type 1. sftp-to-sftp-basic Internal-SFTP 2. sftp-to-blob-pgp-decrypt Vendor-SFTP 3. blob-to-vendor-ftp BlobStore 4. gcp-to-azure-encrypted GCP 5. s3-to-sftp-virus-scan AmazonS3 6. multi-file-processing Internal-SFTP 7. fire-event-chain Internal-SFTP 8. apim-notification BlobStore 9. internal-sftp-azurefile-api Internal-SFTP 10. rsa-encrypt-multi-dest Vendor-SFTP"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#destination-type-coverage","title":"Destination Type Coverage","text":"Example Destination Type(s) 1. sftp-to-sftp-basic External-SFTP 2. sftp-to-blob-pgp-decrypt BlobStore 3. blob-to-vendor-ftp Vendor-FTP 4. gcp-to-azure-encrypted BlobStore 5. s3-to-sftp-virus-scan Internal-SFTP 6. multi-file-processing BlobStore 7. fire-event-chain BlobStore 8. apim-notification Internal-APIM 9. internal-sftp-azurefile-api AzureFile-API 10. rsa-encrypt-multi-dest BlobStore, GCP"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#action-type-coverage","title":"Action Type Coverage","text":"Action Type Examples ReadFile 1, 2, 3, 4, 5, 6, 8, 9, 10 WriteFile 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 DeleteFile 1 RenameFile 9 GetFileList 6, 7 ZipFileList 6 ConcatenateList 6, 7 DeleteFileList 6, 7 PGP-Decrypt 2 PGP-Encrypt 4 RSA-Encrypt 10 Scan 2, 5 Encode 3 FireEvent 2, 7 FireEventList 7 Notification 8"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#examples","title":"Examples","text":""},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#1-sftp-to-sftp-basicjson","title":"1. sftp-to-sftp-basic.json","text":"<p>Basic file transfer from Internal SFTP to External SFTP.</p> <p>Flow: ReadFile \u2192 WriteFile \u2192 DeleteFile</p> <p>Use Case: Simple internal-to-external file delivery</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#2-sftp-to-blob-pgp-decryptjson","title":"2. sftp-to-blob-pgp-decrypt.json","text":"<p>Receive encrypted file from vendor, decrypt, scan, and store.</p> <p>Flow: ReadFile \u2192 PGP-Decrypt \u2192 Scan \u2192 WriteFile \u2192 FireEvent</p> <p>Use Case: Secure vendor file intake with virus scanning</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#3-blob-to-vendor-ftpjson","title":"3. blob-to-vendor-ftp.json","text":"<p>Send file from Azure Blob to vendor FTP with encoding conversion.</p> <p>Flow: ReadFile \u2192 Encode \u2192 WriteFile</p> <p>Use Case: Outbound file delivery with character encoding</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#4-gcp-to-azure-encryptedjson","title":"4. gcp-to-azure-encrypted.json","text":"<p>Transfer from Google Cloud Storage to Azure with PGP encryption.</p> <p>Flow: ReadFile \u2192 PGP-Encrypt \u2192 WriteFile</p> <p>Use Case: Cross-cloud transfer with encryption at rest</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#5-s3-to-sftp-virus-scanjson","title":"5. s3-to-sftp-virus-scan.json","text":"<p>Pull from S3, virus scan, deliver to internal SFTP.</p> <p>Flow: ReadFile \u2192 Scan \u2192 WriteFile \u2192 DeleteFile</p> <p>Use Case: Inbound file intake from AWS with security scanning</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#6-multi-file-processingjson","title":"6. multi-file-processing.json","text":"<p>Process multiple files into a ZIP archive.</p> <p>Flow: GetFileList \u2192 ConcatenateList \u2192 ZipFileList \u2192 ReadFile \u2192 WriteFile \u2192 DeleteFileList \u2192 DeleteFile</p> <p>Use Case: Batch file aggregation and archiving</p> <p>Note: ZipFileList writes directly to disk, so a ReadFile action is needed before WriteFile to transfer the zip to a remote destination.</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#7-fire-event-chainjson","title":"7. fire-event-chain.json","text":"<p>Batch process files, consolidate, and trigger downstream events.</p> <p>Flow: GetFileList \u2192 ConcatenateList \u2192 WriteFile \u2192 FireEvent \u2192 FireEventList \u2192 DeleteFileList</p> <p>Use Case: Event-driven workflow orchestration with batch processing</p> <p>Note: FireEventList requires a GetFileList or ConcatenateList source to provide the list of files.</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#8-apim-notificationjson","title":"8. apim-notification.json","text":"<p>Transfer file and notify downstream API.</p> <p>Flow: ReadFile \u2192 WriteFile \u2192 Notification</p> <p>Use Case: File delivery with API callback notification</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#9-internal-sftp-azurefile-apijson","title":"9. internal-sftp-azurefile-api.json","text":"<p>Transfer from SFTP to Azure File Share with rename.</p> <p>Flow: ReadFile \u2192 WriteFile \u2192 RenameFile</p> <p>Use Case: Internal file staging with status indicators</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#10-rsa-encrypt-multi-destjson","title":"10. rsa-encrypt-multi-dest.json","text":"<p>Encrypt file and write to multiple destinations.</p> <p>Flow: ReadFile \u2192 RSA-Encrypt \u2192 WriteFile(Blob) \u2192 WriteFile(GCP)</p> <p>Use Case: Multi-cloud delivery with encryption</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#usage-guide","title":"Usage Guide","text":""},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#1-choose-an-example","title":"1. Choose an Example","text":"<p>Select the example that most closely matches your use case.</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#2-copy-and-modify","title":"2. Copy and Modify","text":"<ol> <li>Copy the JSON file to your job configuration folder</li> <li>Rename to <code>jobsettings.json</code></li> <li>Modify values for your environment:</li> <li>Update server hostnames and paths</li> <li>Change credential placeholders to your secrets</li> <li>Adjust file patterns and filters</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#3-create-secrets-file","title":"3. Create Secrets File","text":"<p>Create <code>jobsecrets.json</code> with actual credential values:</p> <pre><code>{\n  \"yourSecretKey\": \"actual-value\"\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#4-deploy-keys-if-needed","title":"4. Deploy Keys (if needed)","text":"<p>Copy encryption keys to the configuration folder: - PGP keys: <code>private.key</code>, <code>public.key</code> - SSH keys: <code>id_rsa</code> - RSA keys: <code>rsa_public.pem</code></p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#5-configure-routing","title":"5. Configure Routing","text":"<p>Add entry to <code>jobconfig</code> Azure Table to route events to your handler.</p>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#validation","title":"Validation","text":"<p>Before deploying, validate your configuration:</p> <ol> <li>JSON Syntax: Use a JSON validator</li> <li>Placeholder References: Verify all <code>{@...}</code> placeholders exist</li> <li>Destination IDs: Ensure action <code>outputFile</code> references valid destination IDs</li> <li>Action Chain: Verify <code>sourceStream</code> references point to previous action outputs</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/job-examples/index.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Job Configuration Specification</li> <li>Source/Destination Types</li> <li>Action Types</li> <li>Placeholders Reference</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html","title":"Configuration Management","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#configuration-management","title":"Configuration Management","text":"<p>This guide covers managing FTS configuration across environments.</p>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#configuration-layers","title":"Configuration Layers","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Application Settings (appsettings.json)     \u2502 \u25c4\u2500\u2500 K8s Secret\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Job Configuration (jobsettings.json)        \u2502 \u25c4\u2500\u2500 Azure File Share\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Job Secrets (jobsecrets.json)               \u2502 \u25c4\u2500\u2500 Azure File Share / Key Vault\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Routing Configuration (jobconfig table)     \u2502 \u25c4\u2500\u2500 Azure Table Storage\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#application-settings","title":"Application Settings","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#file-location","title":"File Location","text":"<p>Application settings are deployed as Kubernetes secrets mounted at:</p> <pre><code>/app/appsettings.Production.json\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#configuration-sections","title":"Configuration Sections","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#event-hub","title":"Event Hub","text":"<pre><code>{\n  \"EventHub\": {\n    \"EnterpriseFTP\": {\n      \"ConnectionString\": \"Endpoint=sb://...\",\n      \"EventHubName\": \"enterprise-{env}-ftp-ehb\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#queues","title":"Queues","text":"<pre><code>{\n  \"Queues\": {\n    \"jobs\": {\n      \"Url\": \"https://{storage}.queue.core.windows.net/jobs\",\n      \"SASToken\": \"sv=2018-03-28&amp;si=...\"\n    },\n    \"NextCheck\": 1000,\n    \"NextWriteForLogs\": 60,\n    \"VisibilityTimeout\": 120\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#tables","title":"Tables","text":"<pre><code>{\n  \"Tables\": {\n    \"jobstatus\": {\n      \"Url\": \"https://{storage}.table.core.windows.net/\",\n      \"SASToken\": \"sv=2017-04-17&amp;si=...\",\n      \"TableName\": \"jobstatus\"\n    },\n    \"jobconfig\": {\n      \"Url\": \"https://{storage}.table.core.windows.net/\",\n      \"SASToken\": \"sv=2017-04-17&amp;si=...\",\n      \"TableName\": \"jobconfig\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#key-vault","title":"Key Vault","text":"<pre><code>{\n  \"KeyVaultSecrets\": {\n    \"Enable\": true,\n    \"Uri\": \"https://fts-{env}-key-vault.vault.azure.net/\",\n    \"TanentID\": \"tenant-guid\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#azure-files","title":"Azure Files","text":"<pre><code>{\n  \"AzureFiles\": {\n    \"sftpintroot\": \"/mnt/sftpintroot\",\n    \"sftpextroot\": \"/mnt/sftpextroot\",\n    \"jobsettingsfolder\": \"/mnt/jobconfig/{@Message.source}/{@Message.accountID}/{@Message.fileName.subFolder}\",\n    \"ReplaceText\": {\n      \"Message_fileName\": \"{@Message.fileName}\",\n      \"Message_accountID\": \"{@Message.accountID}\"\n    }\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#actions","title":"Actions","text":"<pre><code>{\n  \"Actions\": {\n    \"SourceTypes\": {\n      \"Internal_Type\": \"Internal-SFTP\",\n      \"External-SFTP\": \"External-SFTP\",\n      \"Vendor-SFTP\": \"Vendor-SFTP\",\n      \"BlobStore\": \"BlobStore\"\n    },\n    \"Types\": {\n      \"ReadFile\": \"ReadFile\",\n      \"WriteFile\": \"WriteFile\",\n      \"PGP-Decryption\": \"PGP-Decrypt\"\n    },\n    \"RetryFailureSource\": 3,\n    \"RetryFailureDestination\": 3,\n    \"RetryFailureSourceDelay\": 5,\n    \"RetryFailureDestinationDelay\": 5\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#virus-scan","title":"Virus Scan","text":"<pre><code>{\n  \"VirusScan\": {\n    \"ClamAVServiceIP\": \"10.21.129.142\",\n    \"ClamAVServicePort\": \"3310\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#environment-differences","title":"Environment Differences","text":"Setting Dev Stg Prod Event Hub enterprise-dev-ftp-ehb enterprise-stg-ftp-ehb enterprise-prod-ftp-ehb Storage enterprisedevsftpapps enterprisestgsftpapps enterpriseprodsftpapps Key Vault fts-dev-key-vault fts-stg-key-vault fts-prod-key-vault ACR enterprisenonpacr enterprisenonpacr enterpriseprodacr"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#job-configuration","title":"Job Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#file-structure","title":"File Structure","text":"<pre><code>/mnt/jobconfig/\n\u2514\u2500\u2500 {EventSource}/\n    \u2514\u2500\u2500 {AccountID}/\n        \u2514\u2500\u2500 {SubFolder}/\n            \u251c\u2500\u2500 jobsettings.json\n            \u251c\u2500\u2500 jobsecrets.json\n            \u2514\u2500\u2500 [key files]\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#creating-new-job-configuration","title":"Creating New Job Configuration","text":"<ol> <li> <p>Determine Path:    <code>/mnt/jobconfig/FTP.File.ExternalService/NEWACCOUNT/incoming/</code></p> </li> <li> <p>Create jobsettings.json:    <code>json    {      \"feedName\": \"new-account-feed\",      \"version\": \"1.0\",      \"source\": { ... },      \"destinations\": [ ... ],      \"actions\": [ ... ]    }</code></p> </li> <li> <p>Create jobsecrets.json:    <code>json    {      \"username\": \"actual-username\",      \"password\": \"actual-password\"    }</code></p> </li> <li> <p>Deploy Key Files (if needed):</p> </li> <li>PGP keys: <code>private.key</code>, <code>public.key</code></li> <li>SSH keys: <code>id_rsa</code></li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#updating-job-configuration","title":"Updating Job Configuration","text":"<ol> <li>Access Azure File Share:</li> <li>Via Azure Portal</li> <li>Via Azure Storage Explorer</li> <li> <p>Via mounted share on pods</p> </li> <li> <p>Edit Configuration:</p> </li> <li>Modify JSON file</li> <li> <p>Save changes</p> </li> <li> <p>Changes Take Effect:</p> </li> <li>Immediately on next job execution</li> <li>No service restart required</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#routing-configuration","title":"Routing Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#jobconfig-table-schema","title":"jobconfig Table Schema","text":"Column Type Description PartitionKey string Queue name (e.g., \"jobs\") RowKey string Unique rule identifier EventType string Event type to match EventSource string Event source to match EventSubject string Event subject to match EventAccountID string Account ID to match"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#adding-routing-rule","title":"Adding Routing Rule","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#azure-portal","title":"Azure Portal","text":"<ol> <li>Navigate to Storage Account \u2192 Tables \u2192 jobconfig</li> <li>Add entity with required fields</li> <li>Set PartitionKey to target queue</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#azure-cli","title":"Azure CLI","text":"<pre><code>az storage entity insert \\\n  --account-name enterprisedevsftpapps \\\n  --table-name jobconfig \\\n  --entity \\\n    PartitionKey=jobs \\\n    RowKey=new-account-rule \\\n    EventType=Succeeded \\\n    EventSource=FTP.File.ExternalService \\\n    EventSubject=\"File Upload\" \\\n    EventAccountID=NEWACCOUNT\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#azure-storage-explorer","title":"Azure Storage Explorer","text":"<ol> <li>Connect to storage account</li> <li>Navigate to Tables \u2192 jobconfig</li> <li>Click \"Add Entity\"</li> <li>Fill in required fields</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#queue-name-reference","title":"Queue Name Reference","text":"PartitionKey Handler jobs FileJobHandler jobstmsroute FileJobHandler-TMSRoute jobstmsstatus FileJobHandler-TMSStatus jobtmscarrierpod FileJobHandler-TMSCarrierPOD jobsbylcppricing FileJobHandler-PriceProposal"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#secrets-management","title":"Secrets Management","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#option-1-jobsecretsjson","title":"Option 1: jobsecrets.json","text":"<p>Store secrets in file alongside jobsettings.json:</p> <pre><code>{\n  \"vendorUser\": \"username\",\n  \"vendorPass\": \"password\",\n  \"pgpPassword\": \"key-passphrase\"\n}\n</code></pre> <p>Reference in jobsettings.json:</p> <pre><code>{\n  \"credentials\": {\n    \"username\": \"{@JobSecrets.vendorUser}\",\n    \"password\": \"{@JobSecrets.vendorPass}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#option-2-azure-key-vault","title":"Option 2: Azure Key Vault","text":"<p>Enable Key Vault in appsettings:</p> <pre><code>{\n  \"KeyVaultSecrets\": {\n    \"Enable\": true,\n    \"Uri\": \"https://fts-dev-key-vault.vault.azure.net/\"\n  }\n}\n</code></pre> <p>Store secrets in Key Vault:</p> <pre><code>az keyvault secret set \\\n  --vault-name fts-dev-key-vault \\\n  --name vendorPass \\\n  --value \"actual-password\"\n</code></pre> <p>Reference in jobsettings.json:</p> <pre><code>{\n  \"credentials\": {\n    \"password\": \"{@JobSecrets.vendorPass}\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#configuration-validation","title":"Configuration Validation","text":""},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#json-syntax","title":"JSON Syntax","text":"<pre><code># Validate JSON syntax\ncat jobsettings.json | jq .\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#required-fields","title":"Required Fields","text":"<p>Verify presence of: - <code>feedName</code> - <code>source.type</code> - <code>destinations[].id</code> - <code>destinations[].type</code> - <code>actions[].id</code> - <code>actions[].type</code></p>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#placeholder-references","title":"Placeholder References","text":"<p>Ensure all placeholders resolve: - <code>{@JobSettings.xxx}</code> - References within config - <code>{@JobSecrets.xxx}</code> - References to secrets file - <code>{@Message.xxx}</code> - References to event fields - <code>{@AppSettings.xxx}</code> - References to app settings</p>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#best-practices","title":"Best Practices","text":"<ol> <li>Version Control: Track configurations in git (excluding secrets)</li> <li>Environment Parity: Maintain similar structures across environments</li> <li>Secret Rotation: Plan for credential rotation</li> <li>Documentation: Comment complex configurations</li> <li>Testing: Test in dev before promoting to stg/prod</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/configuration-management.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Deployment Guide</li> <li>Security &amp; Secrets</li> <li>Jobsettings Storage</li> <li>Routing ConfigModel</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html","title":"Deployment Guide","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#deployment-guide","title":"Deployment Guide","text":"<p>This guide covers deploying FTS components to Azure Kubernetes Service (AKS).</p>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#prerequisites","title":"Prerequisites","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#azure-resources","title":"Azure Resources","text":"<ul> <li>Azure Kubernetes Service (AKS) cluster</li> <li>Azure Container Registry (ACR)</li> <li>Azure Storage Account (Queues, Tables, Blobs, Files)</li> <li>Azure Event Hub namespace</li> <li>Azure Key Vault</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#tools","title":"Tools","text":"<ul> <li>kubectl configured for target cluster</li> <li>Azure CLI authenticated</li> <li>Docker for local builds</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#credentials","title":"Credentials","text":"<ul> <li>ACR push/pull credentials</li> <li>Storage SAS tokens</li> <li>Event Hub connection strings</li> <li>Key Vault access</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#deployment-architecture","title":"Deployment Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     AKS Cluster                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u2502\n\u2502  \u2502 sftp-dev        \u2502  \u2502 sftp-stg        \u2502  \u2502 sftp-prod     \u2502 \u2502\n\u2502  \u2502 namespace       \u2502  \u2502 namespace       \u2502  \u2502 namespace     \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                    \u2502\n\u2502  \u2502 Deployments:    \u2502  \u2502 Deployments:    \u2502                    \u2502\n\u2502  \u2502 - FileEvent...  \u2502  \u2502 - FileEvent...  \u2502                    \u2502\n\u2502  \u2502 - FileJob...    \u2502  \u2502 - FileJob...    \u2502                    \u2502\n\u2502  \u2502 - TMS handlers  \u2502  \u2502 - TMS handlers  \u2502                    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502\n\u2502                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 Persistent Volumes (Azure File Shares)                   \u2502 \u2502\n\u2502  \u2502 - sftp-internal-fs-{env}                                 \u2502 \u2502\n\u2502  \u2502 - sftp-external-fs-{env}                                 \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#environment-setup","title":"Environment Setup","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#create-namespace","title":"Create Namespace","text":"<pre><code>kubectl create namespace sftp-dev\nkubectl create namespace sftp-stg\nkubectl create namespace sftp-prod\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#create-persistent-volume-claims","title":"Create Persistent Volume Claims","text":"<pre><code># sftp-internal-pvc.yaml\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: sftp-internal-fs-dev\n  namespace: sftp-dev\nspec:\n  accessModes:\n    - ReadWriteMany\n  storageClassName: azurefile\n  resources:\n    requests:\n      storage: 100Gi\n</code></pre> <pre><code>kubectl apply -f sftp-internal-pvc.yaml\nkubectl apply -f sftp-external-pvc.yaml\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#configuration","title":"Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#application-settings","title":"Application Settings","text":"<p>Create <code>appsettings.Production.json</code>:</p> <pre><code>{\n  \"EventHub\": {\n    \"EnterpriseFTP\": {\n      \"ConnectionString\": \"${EVENTHUB_CONNECTION_STRING}\",\n      \"EventHubName\": \"${EVENTHUB_NAME}\"\n    }\n  },\n  \"Queues\": {\n    \"jobs\": {\n      \"Url\": \"${QUEUES_JOBS_URL}\",\n      \"SASToken\": \"${QUEUES_JOBS_SAS_TOKEN}\"\n    },\n    \"NextCheck\": 1000,\n    \"VisibilityTimeout\": 120\n  },\n  \"Tables\": {\n    \"jobstatus\": {\n      \"Url\": \"${TABLES_JOBS_STATUS_URL}\",\n      \"SASToken\": \"${TABLES_JOBS_STATUS_SAS_TOKEN}\",\n      \"TableName\": \"jobstatus\"\n    }\n  },\n  \"KeyVaultSecrets\": {\n    \"Enable\": true,\n    \"Uri\": \"${KEY_VAULT_URI}\",\n    \"TanentID\": \"${KEY_VAULT_TENANT_ID}\"\n  },\n  \"VirusScan\": {\n    \"ClamAVServiceIP\": \"${VIRUS_SCAN_IP}\",\n    \"ClamAVServicePort\": \"${VIRUS_SCAN_PORT}\"\n  },\n  \"AzureFiles\": {\n    \"sftpintroot\": \"/mnt/sftpintroot\",\n    \"sftpextroot\": \"/mnt/sftpextroot\"\n  }\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#create-kubernetes-secret","title":"Create Kubernetes Secret","text":"<pre><code>kubectl create secret -n sftp-dev generic \\\n  sftp-dev-file-job-handler-app-settings-secret \\\n  --from-file=appsettings.Production.json\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#deployment","title":"Deployment","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#deployment-template","title":"Deployment Template","text":"<pre><code># file-job-handler-template.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: file-job-handler\n  namespace: ${K8S_NAMESPACE}\n  labels:\n    app: file-job-handler\n    project: sftp\n    env: ${K8S_ENV}\nspec:\n  replicas: ${K8S_REPLICAS}\n  selector:\n    matchLabels:\n      app: file-job-handler\n  template:\n    metadata:\n      labels:\n        app: file-job-handler\n        version: ${K8S_VERSION}\n    spec:\n      containers:\n        - name: file-job-handler\n          image: ${K8S_IMAGE_URI}:${K8S_IMAGE_TAG}\n          ports:\n            - containerPort: 80\n          resources:\n            requests:\n              memory: \"256Mi\"\n              cpu: \"250m\"\n            limits:\n              memory: \"1Gi\"\n              cpu: \"1000m\"\n          volumeMounts:\n            - name: appsettings\n              mountPath: /app/appsettings.Production.json\n              subPath: appsettings.Production.json\n            - name: sftpintroot\n              mountPath: /mnt/sftpintroot\n            - name: sftpextroot\n              mountPath: /mnt/sftpextroot\n      volumes:\n        - name: appsettings\n          secret:\n            secretName: ${K8S_SECRET_NAME}\n        - name: sftpintroot\n          persistentVolumeClaim:\n            claimName: ${K8S_INT_PVC}\n        - name: sftpextroot\n          persistentVolumeClaim:\n            claimName: ${K8S_EXT_PVC}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#apply-deployment","title":"Apply Deployment","text":"<pre><code># Substitute variables\nenvsubst &lt; file-job-handler-template.yaml &gt; file-job-handler.yaml\n\n# Apply to cluster\nkubectl apply -n sftp-dev -f file-job-handler.yaml\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#verify-deployment","title":"Verify Deployment","text":"<pre><code># Check deployment status\nkubectl get deployments -n sftp-dev\n\n# Check pod status\nkubectl get pods -n sftp-dev\n\n# View logs\nkubectl logs -n sftp-dev -l app=file-job-handler\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#scaling","title":"Scaling","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#manual-scaling","title":"Manual Scaling","text":"<pre><code>kubectl scale deployment file-job-handler -n sftp-dev --replicas=3\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#horizontal-pod-autoscaler","title":"Horizontal Pod Autoscaler","text":"<pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: file-job-handler-hpa\n  namespace: sftp-dev\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: file-job-handler\n  minReplicas: 1\n  maxReplicas: 5\n  metrics:\n    - type: Resource\n      resource:\n        name: cpu\n        target:\n          type: Utilization\n          averageUtilization: 70\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#updating","title":"Updating","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#rolling-update","title":"Rolling Update","text":"<pre><code># Update image tag\nkubectl set image deployment/file-job-handler \\\n  file-job-handler=enterprisenonpacr.azurecr.io/enterprise/file-job-handler:new-tag \\\n  -n sftp-dev\n\n# Watch rollout\nkubectl rollout status deployment/file-job-handler -n sftp-dev\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#rollback","title":"Rollback","text":"<pre><code># Rollback to previous version\nkubectl rollout undo deployment/file-job-handler -n sftp-dev\n\n# Rollback to specific revision\nkubectl rollout undo deployment/file-job-handler -n sftp-dev --to-revision=2\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#cicd-integration","title":"CI/CD Integration","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#azure-devops-pipeline","title":"Azure DevOps Pipeline","text":"<p>The <code>azure-pipelines.yml</code> automates deployment:</p> <ol> <li>Build Stage: Build and push Docker image</li> <li>Dev Deploy: Deploy to development</li> <li>Stg Deploy: Deploy to staging</li> <li>Prod Deploy: Deploy to production</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#pipeline-variables","title":"Pipeline Variables","text":"Variable Description <code>SECRET_EVENTHUB_CONNECTION_STRING</code> Event Hub connection <code>SECRET_QUEUES_SAS_TOKEN</code> Queue SAS token <code>SECRET_TABLES_SAS_TOKEN</code> Table SAS token <code>SECRET_KEY_VAULT_TENANT_ID</code> Key Vault tenant"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#troubleshooting","title":"Troubleshooting","text":""},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#pod-not-starting","title":"Pod Not Starting","text":"<pre><code># Describe pod for events\nkubectl describe pod &lt;pod-name&gt; -n sftp-dev\n\n# Common issues:\n# - Image pull errors: Check ACR credentials\n# - Volume mount errors: Verify PVC exists\n# - Secret errors: Verify secret exists\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#container-crashes","title":"Container Crashes","text":"<pre><code># View logs from crashed container\nkubectl logs &lt;pod-name&gt; -n sftp-dev --previous\n\n# Check container exit code\nkubectl get pod &lt;pod-name&gt; -n sftp-dev -o jsonpath='{.status.containerStatuses[0].lastState}'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#storage-issues","title":"Storage Issues","text":"<pre><code># Verify PVC is bound\nkubectl get pvc -n sftp-dev\n\n# Check Azure File Share mount\nkubectl exec -it &lt;pod-name&gt; -n sftp-dev -- ls -la /mnt/sftpintroot\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/deployment-guide.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Configuration Management</li> <li>Monitoring &amp; Logging</li> <li>Deployment Architecture</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html","title":"Monitoring &amp; Logging","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#monitoring-logging","title":"Monitoring &amp; Logging","text":"<p>This guide covers monitoring FTS components using Datadog APM and NLog.</p>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#monitoring-architecture","title":"Monitoring Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     FTS Components                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 FileEventHandler \u2502 FileJobHandler \u2502 Specialized Handlers    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                  \u2502                    \u2502\n         \u25bc                  \u25bc                    \u25bc\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502                   Datadog Agent                      \u2502\n    \u2502                 (APM + Logs)                         \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502                   Datadog Cloud                      \u2502\n    \u2502    Dashboards \u2502 Alerts \u2502 Traces \u2502 Log Explorer      \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#datadog-apm","title":"Datadog APM","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#integration","title":"Integration","text":"<p>FTS components include Datadog APM via build arguments:</p> <pre><code>ARG ARG_APM_VENDOR=datadog\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#trace-context","title":"Trace Context","text":"<p>Traces propagate through: - Event Hub messages - Queue messages - HTTP calls to APIs</p>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#key-traces","title":"Key Traces","text":"Service Operation Description FileEventHandler EventHub.Receive Event ingestion FileEventHandler Table.Query Routing lookup FileEventHandler Queue.Send Message routing FileJobHandler Queue.Receive Job pickup FileJobHandler Action.Execute Action processing FileJobHandler Server.ReadFile File read FileJobHandler Server.WriteFile File write"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#nlog-configuration","title":"NLog Configuration","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#log-levels","title":"Log Levels","text":"Level Usage Debug Detailed debugging (disabled in prod) Info Normal operation flow Warning Recoverable issues Error Operation failures"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#log-format","title":"Log Format","text":"<pre><code>Logger.Info($\"Start ActionProcess Action method ActionID={action.id}, ActionType={action.type}. MessageId={currentMessageInfo.MessageId}\");\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#example-logs","title":"Example Logs","text":"<p>Job Start:</p> <pre><code>INFO: Start Process MessageId=abc-123, Source=FTP.File.ExternalService, AccountID=ACCOUNT001\n</code></pre> <p>Action Execution:</p> <pre><code>INFO: Start Action ReadFile by ActionID=0, ActionType=ReadFile. MessageId=abc-123\nINFO: ReadFile method ended. File Successfully read\n</code></pre> <p>Action Failure:</p> <pre><code>ERROR: Action_Read method failed. ActionID=0, ActionType=ReadFile. MessageId=abc-123\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#key-metrics","title":"Key Metrics","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#fileeventhandler","title":"FileEventHandler","text":"Metric Description Alert Threshold Events received/sec Event ingestion rate &lt; 10% of normal Invalid message rate Validation failures &gt; 5% Routing success rate Messages routed &lt; 95% Queue send latency Message publish time &gt; 1000ms"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#filejobhandler","title":"FileJobHandler","text":"Metric Description Alert Threshold Jobs processed/min Processing throughput &lt; 50% of normal Job success rate Completed successfully &lt; 95% Action failure rate Individual actions &gt; 10% Processing latency End-to-end time &gt; 60s Retry rate Operations retried &gt; 20%"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#infrastructure","title":"Infrastructure","text":"Metric Description Alert Threshold Pod CPU usage Container CPU &gt; 80% Pod memory usage Container memory &gt; 80% Queue depth Messages pending &gt; 1000 Storage latency Azure File ops &gt; 500ms"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#dashboards","title":"Dashboards","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#operations-dashboard","title":"Operations Dashboard","text":"<p>Key widgets: - Job success/failure rate (time series) - Events processed (counter) - Queue depth (gauge) - Error rate by action type (pie chart) - Top failing accounts (table)</p>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#health-dashboard","title":"Health Dashboard","text":"<p>Key widgets: - Service uptime (SLO) - Pod status (status map) - Resource utilization (heatmap) - Azure service health (status)</p>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#alerts","title":"Alerts","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#critical-alerts","title":"Critical Alerts","text":"Alert Condition Action Service Down No events in 5 min Page on-call High Error Rate &gt; 10% failures Notify team Queue Backup &gt; 10000 messages Scale handlers Pod CrashLoop &gt; 3 restarts/5min Page on-call"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#warning-alerts","title":"Warning Alerts","text":"Alert Condition Action Elevated Latency p95 &gt; 30s Monitor Retry Rate High &gt; 20% Investigate Memory Pressure &gt; 70% Plan scaling"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#alert-configuration-datadog","title":"Alert Configuration (Datadog)","text":"<pre><code># Example monitor\nname: FTS Job Failure Rate\ntype: metric alert\nquery: |\n  sum(last_5m):sum:fts.jobs.failed{*}.as_count() /\n  sum:fts.jobs.total{*}.as_count() * 100 &gt; 10\nmessage: |\n  Job failure rate exceeded 10% in the last 5 minutes.\n\n  Check Datadog logs for error details.\n  Review jobstatus table for failed jobs.\n\n  @slack-fts-alerts\noptions:\n  thresholds:\n    critical: 10\n    warning: 5\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#log-queries","title":"Log Queries","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#find-failed-jobs","title":"Find Failed Jobs","text":"<pre><code>service:file-job-handler status:error @level:ERROR\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#find-jobs-by-account","title":"Find Jobs by Account","text":"<pre><code>service:file-job-handler @accountId:ACCOUNT001\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#find-slow-operations","title":"Find Slow Operations","text":"<pre><code>service:file-job-handler @duration:&gt;30000\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#find-retry-events","title":"Find Retry Events","text":"<pre><code>service:file-job-handler \"Sleep for * Second\"\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#troubleshooting-with-logs","title":"Troubleshooting with Logs","text":""},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#job-not-processing","title":"Job Not Processing","text":"<ol> <li> <p>Check FileEventHandler for routing:    <code>service:file-event-handler @accountId:ACCOUNT001</code></p> </li> <li> <p>Check if message reached queue:    <code>service:file-event-handler \"Message Sent to Queue\"</code></p> </li> <li> <p>Check handler pickup:    <code>service:file-job-handler \"Start Process\"</code></p> </li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#action-failures","title":"Action Failures","text":"<ol> <li> <p>Find the failed action:    <code>service:file-job-handler @messageId:abc-123 status:error</code></p> </li> <li> <p>Check retry attempts:    <code>service:file-job-handler @messageId:abc-123 \"Try *\"</code></p> </li> <li> <p>View full trace:</p> </li> <li>Click on error log</li> <li>Navigate to associated trace</li> <li>Review span details</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#performance-issues","title":"Performance Issues","text":"<ol> <li> <p>Identify slow jobs:    <code>service:file-job-handler @duration:&gt;60000</code></p> </li> <li> <p>Break down by action:    <code>service:file-job-handler \"method ended\" @duration:*</code></p> </li> <li> <p>Check external dependencies:    <code>service:file-job-handler (\"Vendor-SFTP\" OR \"Vendor-FTP\") @duration:*</code></p> </li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#log-retention","title":"Log Retention","text":"Environment Retention Archive Development 7 days None Staging 14 days None Production 30 days S3 (1 year)"},{"location":"enterprise-services/file-transfer-solution/operations/monitoring-logging.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Troubleshooting Runbook</li> <li>JobStatus Model</li> <li>Deployment Guide</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html","title":"Security &amp; Secrets Management","text":""},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#security-secrets-management","title":"Security &amp; Secrets Management","text":"<p>This guide covers security practices and secrets management for FTS.</p>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#security-architecture","title":"Security Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Security Layers                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502 Transport       \u2502  \u2502 Authentication  \u2502  \u2502 Encryption      \u2502  \u2502\n\u2502  \u2502 Security        \u2502  \u2502                 \u2502  \u2502                 \u2502  \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u2502\n\u2502  \u2502 - TLS 1.2+      \u2502  \u2502 - SAS Tokens    \u2502  \u2502 - PGP           \u2502  \u2502\n\u2502  \u2502 - SFTP/SSH      \u2502  \u2502 - SSH Keys      \u2502  \u2502 - RSA           \u2502  \u2502\n\u2502  \u2502 - FTPS          \u2502  \u2502 - OAuth 2.0     \u2502  \u2502 - AES           \u2502  \u2502\n\u2502  \u2502 - HTTPS         \u2502  \u2502 - Managed ID    \u2502  \u2502                 \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502\n\u2502  \u2502                    Secrets Storage                           \u2502\u2502\n\u2502  \u2502  Azure Key Vault \u2502 jobsecrets.json \u2502 K8s Secrets            \u2502\u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#secrets-storage-options","title":"Secrets Storage Options","text":""},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#option-1-jobsecretsjson-file-based","title":"Option 1: jobsecrets.json (File-based)","text":"<p>Location: Same directory as jobsettings.json</p> <pre><code>/mnt/jobconfig/{source}/{accountID}/{folder}/\n\u251c\u2500\u2500 jobsettings.json\n\u251c\u2500\u2500 jobsecrets.json    \u25c4\u2500\u2500 Secrets here\n\u2514\u2500\u2500 private.key\n</code></pre> <p>Format:</p> <pre><code>{\n  \"vendorUser\": \"actual-username\",\n  \"vendorPass\": \"actual-password\",\n  \"pgpPassword\": \"key-passphrase\",\n  \"blobConnection\": \"DefaultEndpointsProtocol=https;...\"\n}\n</code></pre> <p>Usage in jobsettings.json:</p> <pre><code>{\n  \"credentials\": {\n    \"username\": \"{@JobSecrets.vendorUser}\",\n    \"password\": \"{@JobSecrets.vendorPass}\"\n  }\n}\n</code></pre> <p>Pros: - Simple deployment - No external dependencies - Job-specific isolation</p> <p>Cons: - Secrets in file system - Manual rotation - No audit trail</p>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#option-2-azure-key-vault","title":"Option 2: Azure Key Vault","text":"<p>Configuration (appsettings.json):</p> <pre><code>{\n  \"KeyVaultSecrets\": {\n    \"Enable\": true,\n    \"Uri\": \"https://fts-{env}-key-vault.vault.azure.net/\",\n    \"TanentID\": \"tenant-guid\"\n  }\n}\n</code></pre> <p>How It Works:</p> <p>Key Vault secrets must contain a JSON object (not individual values):</p> <ol> <li> <p>Create a Key Vault secret with a JSON blob as the value:    <code>json    {      \"vendorUser\": \"actual-username\",      \"vendorPass\": \"actual-password\",      \"pgpPassword\": \"key-passphrase\"    }</code></p> </li> <li> <p>Reference the secret name in jobsettings.json via the <code>jobsecret</code> field:    <code>json    {      \"feedName\": \"vendor-intake\",      \"jobsecret\": \"VENDOR001-secrets\",      \"source\": {        \"credentials\": {          \"username\": \"{@JobSecrets.vendorUser}\",          \"password\": \"{@JobSecrets.vendorPass}\"        }      }    }</code></p> </li> </ol> <p>Resolution Flow: 1. If <code>KeyVaultSecrets.Enable</code> is true AND <code>jobsecret</code> field is set:    - Retrieve the Key Vault secret by the name in <code>jobsecret</code>    - Deserialize the secret value as JSON dictionary 2. If Key Vault lookup fails or is disabled:    - Fall back to <code>jobsecrets.json</code> file 3. <code>{@JobSecrets.*}</code> placeholders look up keys from the loaded dictionary</p> <p>Important: The <code>{@KeyVault.*}</code> placeholder syntax is NOT supported. Always use <code>{@JobSecrets.*}</code> with the <code>jobsecret</code> field.</p> <p>Pros: - Centralized management - Audit logging - Automatic rotation support - Access policies</p> <p>Cons: - Additional dependency - Network latency - Cost per operation</p>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#option-3-kubernetes-secrets","title":"Option 3: Kubernetes Secrets","text":"<p>Used for application settings:</p> <pre><code>kubectl create secret -n sftp-dev generic \\\n  sftp-dev-app-settings-secret \\\n  --from-file=appsettings.Production.json\n</code></pre> <p>Mounted in pod:</p> <pre><code>volumeMounts:\n  - name: appsettings\n    mountPath: /app/appsettings.Production.json\n    subPath: appsettings.Production.json\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#encryption-keys","title":"Encryption Keys","text":""},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#pgp-keys","title":"PGP Keys","text":"<p>Storage Location:</p> <pre><code>/mnt/jobconfig/{source}/{accountID}/{folder}/\n\u251c\u2500\u2500 private.key     # PGP private key for decryption\n\u2514\u2500\u2500 public.key      # PGP public key for encryption\n</code></pre> <p>Key Generation (outside FTS):</p> <pre><code># Generate key pair\ngpg --gen-key\n\n# Export private key\ngpg --export-secret-keys -a \"key-id\" &gt; private.key\n\n# Export public key\ngpg --export -a \"key-id\" &gt; public.key\n</code></pre> <p>Configuration Reference:</p> <pre><code>{\n  \"actions\": [\n    {\n      \"type\": \"PGP-Decrypt\",\n      \"keyFile\": \"{@AppSettings.jobsettingsfolder}/private.key\",\n      \"keypassword\": \"{@JobSecrets.pgpPassword}\"\n    }\n  ]\n}\n</code></pre> <p>Best Practices: - Use strong passphrases - Rotate keys annually - Separate encryption and signing keys - Store backup copies securely</p>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#ssh-keys","title":"SSH Keys","text":"<p>Storage Location:</p> <pre><code>/mnt/jobconfig/{source}/{accountID}/{folder}/\n\u2514\u2500\u2500 id_rsa          # SSH private key\n</code></pre> <p>Key Generation:</p> <pre><code>ssh-keygen -t rsa -b 4096 -f id_rsa -N \"\"\n</code></pre> <p>Configuration Reference:</p> <pre><code>{\n  \"credentials\": {\n    \"type\": \"SSHKey\",\n    \"username\": \"sftp-user\",\n    \"sshkey\": \"{@AppSettings.jobsettingsfolder}/id_rsa\"\n  }\n}\n</code></pre> <p>Best Practices: - Use RSA 4096-bit or Ed25519 - Rotate keys annually - Register public key with vendor - Restrict file permissions (600)</p>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#rsa-keys","title":"RSA Keys","text":"<p>Storage Location:</p> <pre><code>/mnt/jobconfig/{source}/{accountID}/{folder}/\n\u2514\u2500\u2500 rsa_public.pem  # RSA public key for encryption\n</code></pre> <p>Configuration Reference:</p> <pre><code>{\n  \"actions\": [\n    {\n      \"type\": \"RSA-Encrypt\",\n      \"keyFile\": \"{@AppSettings.jobsettingsfolder}/rsa_public.pem\"\n    }\n  ]\n}\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#credential-rotation","title":"Credential Rotation","text":""},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#password-rotation","title":"Password Rotation","text":"<ol> <li>Update target system with new password</li> <li>Update FTS credentials:</li> <li>If using jobsecrets.json: Update file</li> <li>If using Key Vault: Update secret</li> <li>No service restart required - next job uses new credentials</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#ssh-key-rotation","title":"SSH Key Rotation","text":"<ol> <li>Generate new key pair</li> <li>Register new public key with vendor</li> <li>Deploy new private key to FTS</li> <li>Test connectivity</li> <li>Remove old public key from vendor</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#pgp-key-rotation","title":"PGP Key Rotation","text":"<ol> <li>Generate new key pair</li> <li>Exchange public keys with partner</li> <li>Deploy new private key to FTS</li> <li>Coordinate cutover date</li> <li>Archive old keys</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#sas-token-rotation","title":"SAS Token Rotation","text":"<ol> <li>Generate new SAS token in Azure Portal</li> <li>Update appsettings.json with new token</li> <li>Redeploy Kubernetes secret</li> <li>Rolling restart of pods</li> </ol> <pre><code># Update secret\nkubectl delete secret -n sftp-dev sftp-dev-app-settings-secret\nkubectl create secret -n sftp-dev generic \\\n  sftp-dev-app-settings-secret \\\n  --from-file=appsettings.Production.json\n\n# Rolling restart\nkubectl rollout restart deployment/file-job-handler -n sftp-dev\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#access-control","title":"Access Control","text":""},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#azure-role-assignments","title":"Azure Role Assignments","text":"Resource Role Principal Key Vault Key Vault Secrets User FTS Managed Identity Storage Account Storage Blob Data Contributor FTS Managed Identity Event Hub Azure Event Hubs Data Receiver FileEventHandler Queue Storage Queue Data Contributor FileJobHandler"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#kubernetes-rbac","title":"Kubernetes RBAC","text":"<pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: fts-role\n  namespace: sftp-dev\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"secrets\"]\n    verbs: [\"get\"]\n  - apiGroups: [\"\"]\n    resources: [\"persistentvolumeclaims\"]\n    verbs: [\"get\", \"list\"]\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#file-share-permissions","title":"File Share Permissions","text":"<pre><code>/mnt/jobconfig/\n\u251c\u2500\u2500 {source}/              # 755 (read for all)\n\u2502   \u2514\u2500\u2500 {accountId}/       # 750 (no others)\n\u2502       \u251c\u2500\u2500 jobsettings.json   # 640\n\u2502       \u251c\u2500\u2500 jobsecrets.json    # 600 (owner only)\n\u2502       \u2514\u2500\u2500 private.key        # 600 (owner only)\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#security-checklist","title":"Security Checklist","text":""},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#job-configuration","title":"Job Configuration","text":"<ul> <li>[ ] Credentials use <code>{@JobSecrets.xxx}</code> placeholders</li> <li>[ ] No plaintext secrets in jobsettings.json</li> <li>[ ] Key files have restricted permissions</li> <li>[ ] PGP keys have strong passphrases</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#infrastructure","title":"Infrastructure","text":"<ul> <li>[ ] TLS enabled for all Azure connections</li> <li>[ ] SFTP/FTPS for vendor connections</li> <li>[ ] Managed identities where possible</li> <li>[ ] SAS tokens with minimal scope</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#operations","title":"Operations","text":"<ul> <li>[ ] Credential rotation documented</li> <li>[ ] Key backup procedures in place</li> <li>[ ] Access audit logging enabled</li> <li>[ ] Security alerts configured</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#compliance-considerations","title":"Compliance Considerations","text":""},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#data-classification","title":"Data Classification","text":"Data Type Classification Handling Credentials Confidential Key Vault / encrypted File content Varies Encrypt in transit Job configs Internal Access controlled Logs Internal No PII"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#audit-requirements","title":"Audit Requirements","text":"<ul> <li>Key Vault access logs</li> <li>Azure Activity logs</li> <li>Datadog trace data</li> <li>jobstatus table (retain per policy)</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#encryption-standards","title":"Encryption Standards","text":"<ul> <li>PGP: AES-256 symmetric key</li> <li>RSA: 2048-bit minimum (4096 recommended)</li> <li>TLS: 1.2 minimum</li> <li>SSH: RSA 4096 or Ed25519</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/security-secrets.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Credentials Model</li> <li>Jobsettings Storage</li> <li>Configuration Management</li> </ul>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html","title":"Troubleshooting Runbook","text":""},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#troubleshooting-runbook","title":"Troubleshooting Runbook","text":"<p>This runbook provides systematic approaches for diagnosing and resolving FTS issues.</p>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#triage-flow","title":"Triage Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Issue Reported                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502    Check jobstatus Table      \u2502\n              \u2502    Query by PartitionKey      \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u25bc                   \u25bc                   \u25bc\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502  Invalid  \u2502       \u2502 NoAssigned\u2502       \u2502  Failed   \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502                   \u2502                   \u2502\n          \u25bc                   \u25bc                   \u25bc\n    Check Message       Check Routing       Check Action\n    Validation          Configuration       Execution\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#common-issues","title":"Common Issues","text":""},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#1-jobs-not-processing","title":"1. Jobs Not Processing","text":"<p>Symptoms: - Files not transferred - No status updates - Queue backing up</p> <p>Diagnostic Steps:</p> <ol> <li> <p>Check Event Hub ingestion:    <code># Datadog query    service:file-event-handler \"Event received\"</code></p> </li> <li> <p>Check jobstatus for recent entries:    <code># Azure Table query    Timestamp ge datetime'2024-01-15T00:00:00Z'</code></p> </li> <li> <p>Check handler pods:    <code>bash    kubectl get pods -n sftp-{env} -l app=file-job-handler    kubectl logs -n sftp-{env} -l app=file-job-handler --tail=100</code></p> </li> <li> <p>Check queue depth:    <code>bash    az storage queue peek \\      --account-name enterprise{env}sftpapps \\      --queue-name jobs \\      --num-messages 10</code></p> </li> </ol> <p>Resolution: - Restart handler pods if crashed - Scale handlers if queue backed up - Check Azure service health</p>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#2-invalid-status","title":"2. Invalid Status","text":"<p>Symptoms: - jobstatus shows <code>Invalid</code> - <code>InvalidReason</code> contains validation error</p> <p>Common Causes:</p> InvalidReason Cause Fix \"Message is not json format\" Malformed event Fix event publisher \"Type,Subject,Source,AccountID not provided\" Missing fields Add required fields \"Garbage message\" Unrecognized format Check event source <p>Diagnostic Steps:</p> <ol> <li> <p>Find Invalid records:    <code>Status eq 'Invalid'</code></p> </li> <li> <p>Examine Message field (contains original event)</p> </li> <li> <p>Verify event format against CloudEvents spec</p> </li> </ol> <p>Resolution: - Fix event publisher to send valid CloudEvents - Ensure all required fields present</p>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#3-noassigned-status","title":"3. NoAssigned Status","text":"<p>Symptoms: - jobstatus shows <code>NoAssigned</code> - Event received but not routed</p> <p>Cause: No matching rule in <code>jobconfig</code> table</p> <p>Diagnostic Steps:</p> <ol> <li> <p>Find NoAssigned records:    <code>Status eq 'NoAssigned'</code></p> </li> <li> <p>Extract event attributes from record:</p> </li> <li>EventType</li> <li>EventSource</li> <li>EventSubject</li> <li> <p>AccountID</p> </li> <li> <p>Check jobconfig table for matching rule</p> </li> </ol> <p>Resolution:</p> <p>Add routing rule to jobconfig table:</p> <pre><code>az storage entity insert \\\n  --account-name enterprise{env}sftpapps \\\n  --table-name jobconfig \\\n  --entity \\\n    PartitionKey=jobs \\\n    RowKey=new-rule \\\n    EventType=Succeeded \\\n    EventSource=FTP.File.ExternalService \\\n    EventSubject=\"File Upload\" \\\n    EventAccountID=ACCOUNTID\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#4-failed-status","title":"4. Failed Status","text":"<p>Symptoms: - jobstatus shows <code>Failed</code> - <code>InvalidReason</code> contains error details</p> <p>Common Failure Patterns:</p> InvalidReason Pattern Cause Fix \"Try X: ... File not found\" Source file missing Verify file exists \"Try X: ... Connection refused\" Server unreachable Check network/credentials \"Virus Scan Failed\" Virus detected Quarantine file \"PGP_Decryption method failed\" Wrong key/password Update credentials \"Couldn't recognise source.type\" Invalid type value Fix jobsettings.json \"Couldn't find jobsettings.json\" Missing config Create configuration <p>Diagnostic Steps:</p> <ol> <li> <p>Find Failed record:    <code>Status eq 'Failed' and AccountID eq 'ACCOUNTID'</code></p> </li> <li> <p>Examine InvalidReason for error details</p> </li> <li> <p>Check Datadog logs for full stack trace:    <code>service:file-job-handler @messageId:MESSAGE_ID status:error</code></p> </li> <li> <p>Review action that failed (in <code>Action</code> field)</p> </li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#5-connection-failures","title":"5. Connection Failures","text":"<p>Symptoms: - \"Connection refused\" - \"Authentication failed\" - \"Timeout\"</p> <p>Diagnostic Steps:</p> <ol> <li> <p>Identify target server from jobsettings.json</p> </li> <li> <p>Test connectivity from pod:    <code>bash    kubectl exec -it &lt;pod&gt; -n sftp-{env} -- nc -zv hostname port</code></p> </li> <li> <p>Verify credentials:</p> </li> <li>Check jobsecrets.json values</li> <li> <p>Verify Key Vault secrets</p> </li> <li> <p>Check firewall rules for target server</p> </li> </ol> <p>Resolution: - Update credentials - Whitelist pod IP addresses - Check VPN/ExpressRoute connectivity</p>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#6-pgpencryption-failures","title":"6. PGP/Encryption Failures","text":"<p>Symptoms: - \"PGP_Decryption method failed\" - \"Key/Vault Private key not found\"</p> <p>Diagnostic Steps:</p> <ol> <li> <p>Verify key file exists:    <code>bash    kubectl exec -it &lt;pod&gt; -n sftp-{env} -- ls -la /mnt/jobconfig/.../</code></p> </li> <li> <p>Check key file path in jobsettings.json matches actual location</p> </li> <li> <p>Verify passphrase in jobsecrets.json or Key Vault</p> </li> <li> <p>Test key manually (if appropriate):    <code>bash    gpg --decrypt --batch --passphrase \"password\" file.gpg</code></p> </li> </ol> <p>Resolution: - Deploy correct key files - Update passphrase secrets - Ensure key type matches (encryption vs signing)</p>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#7-virus-scan-failures","title":"7. Virus Scan Failures","text":"<p>Symptoms: - \"Virus Scan Failed ErrorMessage=...\"</p> <p>Diagnostic Steps:</p> <ol> <li> <p>Check ClamAV service:    <code>bash    nc -zv CLAMAV_IP CLAMAV_PORT</code></p> </li> <li> <p>Review virus details in InvalidReason</p> </li> <li> <p>Quarantine file if legitimate virus</p> </li> </ol> <p>Resolution: - If false positive: Update ClamAV signatures - If true positive: Notify source, quarantine file</p>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#8-queue-backup","title":"8. Queue Backup","text":"<p>Symptoms: - Queue depth increasing - Processing latency high</p> <p>Diagnostic Steps:</p> <ol> <li> <p>Check queue depth:    <code>bash    az storage queue show \\      --account-name enterprise{env}sftpapps \\      --queue-name jobs \\      --query \"approximateMessageCount\"</code></p> </li> <li> <p>Check handler pod count:    <code>bash    kubectl get deployment file-job-handler -n sftp-{env}</code></p> </li> <li> <p>Check for stuck jobs (ReadMessage status for extended period)</p> </li> </ol> <p>Resolution:</p> <ol> <li> <p>Scale handlers:    <code>bash    kubectl scale deployment file-job-handler -n sftp-{env} --replicas=5</code></p> </li> <li> <p>Clear poison messages if necessary:    <code>bash    az storage message clear \\      --account-name enterprise{env}sftpapps \\      --queue-name jobs-poison</code></p> </li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#azure-table-query-patterns","title":"Azure Table Query Patterns","text":""},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-by-account","title":"Find by Account","text":"<pre><code>AccountID eq 'ACCOUNT001'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-by-status","title":"Find by Status","text":"<pre><code>Status eq 'Failed' and Timestamp ge datetime'2024-01-15T00:00:00Z'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-by-time-range","title":"Find by Time Range","text":"<pre><code>Timestamp ge datetime'2024-01-15T10:00:00Z' and Timestamp lt datetime'2024-01-15T11:00:00Z'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-by-event-source","title":"Find by Event Source","text":"<pre><code>EventSource eq 'TMS.Route'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-recent-failures","title":"Find Recent Failures","text":"<pre><code>Status eq 'Failed' and Timestamp ge datetime'2024-01-15T00:00:00Z'\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#datadog-log-queries","title":"Datadog Log Queries","text":""},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-errors-for-account","title":"Find Errors for Account","text":"<pre><code>service:file-job-handler @accountId:ACCOUNT001 status:error\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-retry-patterns","title":"Find Retry Patterns","text":"<pre><code>service:file-job-handler \"Sleep for * Second\" @accountId:ACCOUNT001\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#find-slow-operations","title":"Find Slow Operations","text":"<pre><code>service:file-job-handler @duration:&gt;60000\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#trace-single-job","title":"Trace Single Job","text":"<pre><code>service:file-* @correlationId:CORRELATION_ID\n</code></pre>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#escalation-path","title":"Escalation Path","text":"<ol> <li>L1 - Operations:</li> <li>Check jobstatus table</li> <li>Review Datadog dashboards</li> <li> <p>Basic troubleshooting</p> </li> <li> <p>L2 - Engineering:</p> </li> <li>Code-level debugging</li> <li>Configuration review</li> <li> <p>Infrastructure issues</p> </li> <li> <p>L3 - Architecture:</p> </li> <li>System design issues</li> <li>Performance optimization</li> <li>Cross-team coordination</li> </ol>"},{"location":"enterprise-services/file-transfer-solution/operations/troubleshooting-runbook.html#related-documentation","title":"Related Documentation","text":"<ul> <li>Monitoring &amp; Logging</li> <li>JobStatus Model</li> <li>Queue Architecture</li> </ul>"},{"location":"enterprise-services/payment-gateway/index.html","title":"overview","text":""},{"location":"enterprise-services/payment-gateway/index.html#overview","title":"overview","text":""},{"location":"enterprise-services/pre/index.html","title":"overview","text":""},{"location":"enterprise-services/pre/index.html#overview","title":"overview","text":""},{"location":"governance/nomenclature.html","title":"Nomenclature","text":""},{"location":"governance/principles.html","title":"Principles","text":""},{"location":"governance/raci.html","title":"RACI","text":""},{"location":"governance/raci.html#raci","title":"RACI","text":""},{"location":"infrastructure/index.html","title":"Physical Architecture","text":""},{"location":"infrastructure/index.html#physical-architecture","title":"Physical Architecture","text":""},{"location":"standards/data-privacy.html","title":"Data privacy","text":""},{"location":"standards/integrations.html","title":"Integrations","text":""},{"location":"standards/integrations.html#integrations","title":"Integrations","text":""},{"location":"standards/observability.html","title":"Observability","text":""},{"location":"standards/operability.html","title":"Operability","text":""},{"location":"standards/security.html","title":"Security","text":""}]}